MASTER_NODE=fs-mbz-gpu-658:29500

# WLBLLM CP8
# D2_DEBUG_NOTIFY_METHODS=1 NUM_TOKENS=262144 BATCH_SIZE=2 CP_DEGREE=8 D2_DEBUG_PRINT=1 MAX_SAMPLE_ID=20 SHOULD_PROFILE_MEMORY=0 NUM_LAYERS=4 ELONGATE_FACTOR=4 EXPERIMENT_REPEAT_TIMES=3 EXPERIMENT_WARMUP_TIMES=1 EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB="20" D2_SHOULD_REPLAN=1 SHOULD_ADD_DEBUG_CASES=1 D2_FA2A_DISABLE_SEND_RECV=0  D2_SYNC_TIME_TRANSFORMER_LAYER=0 WLBLLM_SYNC_TIME_PERDOC_ATTN=0 WLBLLM_SYNC_TIME_FLASH_ATTN=0 SHOULD_ADD_DEBUG_CASES=1 ENABLE_NSYS=0  bash test_e2e_combined.multi.sh $MASTER_NODE 8 8 8 wlbllm wlb-8

# WLBLLM CP4
# D2_DEBUG_NOTIFY_METHODS=1 NUM_TOKENS=262144 BATCH_SIZE=2 CP_DEGREE=4 D2_DEBUG_PRINT=1 MAX_SAMPLE_ID=20 SHOULD_PROFILE_MEMORY=0 NUM_LAYERS=4 ELONGATE_FACTOR=4 EXPERIMENT_REPEAT_TIMES=3 EXPERIMENT_WARMUP_TIMES=1 EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB="20" D2_SHOULD_REPLAN=1 SHOULD_ADD_DEBUG_CASES=1 D2_FA2A_DISABLE_SEND_RECV=0  D2_SYNC_TIME_TRANSFORMER_LAYER=0 WLBLLM_SYNC_TIME_PERDOC_ATTN=0 WLBLLM_SYNC_TIME_FLASH_ATTN=0 SHOULD_ADD_DEBUG_CASES=1 ENABLE_NSYS=0  bash test_e2e_combined.multi.sh $MASTER_NODE 8 8 8 wlbllm wlb-4

# WLBLLM CP2
# D2_DEBUG_NOTIFY_METHODS=1 NUM_TOKENS=262144 BATCH_SIZE=2 CP_DEGREE=2 D2_DEBUG_PRINT=1 MAX_SAMPLE_ID=20 SHOULD_PROFILE_MEMORY=0 NUM_LAYERS=4 ELONGATE_FACTOR=4 EXPERIMENT_REPEAT_TIMES=3 EXPERIMENT_WARMUP_TIMES=1 EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB="20" D2_SHOULD_REPLAN=1 SHOULD_ADD_DEBUG_CASES=1 D2_FA2A_DISABLE_SEND_RECV=0  D2_SYNC_TIME_TRANSFORMER_LAYER=0 WLBLLM_SYNC_TIME_PERDOC_ATTN=0 WLBLLM_SYNC_TIME_FLASH_ATTN=0 SHOULD_ADD_DEBUG_CASES=1 ENABLE_NSYS=0  bash test_e2e_combined.multi.sh $MASTER_NODE 8 8 8 wlbllm wlb-2


# D2
D2_DEBUG_NOTIFY_METHODS=1 NUM_TOKENS=262144 BATCH_SIZE=2 CP_DEGREE=2 D2_DEBUG_PRINT=1 MAX_SAMPLE_ID=20 SHOULD_PROFILE_MEMORY=0 NUM_LAYERS=4 ELONGATE_FACTOR=4 EXPERIMENT_REPEAT_TIMES=3 EXPERIMENT_WARMUP_TIMES=1 EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB="20" D2_SHOULD_REPLAN=1 SHOULD_ADD_DEBUG_CASES=1 D2_FA2A_DISABLE_SEND_RECV=0  D2_SYNC_TIME_TRANSFORMER_LAYER=0 WLBLLM_SYNC_TIME_PERDOC_ATTN=0 WLBLLM_SYNC_TIME_FLASH_ATTN=0 SHOULD_ADD_DEBUG_CASES=1 ENABLE_NSYS=0  bash test_e2e_combined.multi.sh $MASTER_NODE 8 8 8 d2 d2-256k-1


# WLBLLM CP1
D2_DEBUG_NOTIFY_METHODS=1 NUM_TOKENS=262144 BATCH_SIZE=2 CP_DEGREE=1 D2_DEBUG_PRINT=1 MAX_SAMPLE_ID=20 SHOULD_PROFILE_MEMORY=0 NUM_LAYERS=4 ELONGATE_FACTOR=4 EXPERIMENT_REPEAT_TIMES=3 EXPERIMENT_WARMUP_TIMES=1 EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB="20" D2_SHOULD_REPLAN=1 SHOULD_ADD_DEBUG_CASES=1 D2_FA2A_DISABLE_SEND_RECV=0  D2_SYNC_TIME_TRANSFORMER_LAYER=0 WLBLLM_SYNC_TIME_PERDOC_ATTN=0 WLBLLM_SYNC_TIME_FLASH_ATTN=0 SHOULD_ADD_DEBUG_CASES=1 ENABLE_NSYS=0  bash test_e2e_combined.multi.sh $MASTER_NODE 8 8 8 wlbllm wlb-1