{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 1, "dp": 64, "ratio": 0.177129951282613, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 383436, "worker_latencies_us": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 95147, 19819, 18762, 37003, 17892, 230031, 383436, 233276, 44456, 352575, 68009, 279790, 17432, 107874, 18261, 42811, 276490, 131044, 320472, 34506, 34895, 20655, 251511, 305152, 354955, 16245, 110279, 184364, 38580, 276649], "doc2worker": {"0": 63, "1": 62, "2": 61, "3": 60, "4": 59, "5": 58, "6": 57, "7": 56, "8": 55, "9": 54, "10": 53, "11": 52, "12": 51, "13": 50, "14": 49, "15": 48, "16": 47, "17": 46, "18": 45, "19": 44, "20": 43, "21": 42, "22": 41, "23": 40, "24": 39, "25": 38, "26": 37, "27": 36, "28": 35, "29": 34}, "latency_breakdown": {"max_worker_latency_us": 383436, "worker_latencies_us": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 95147, 19819, 18762, 37003, 17892, 230031, 383436, 233276, 44456, 352575, 68009, 279790, 17432, 107874, 18261, 42811, 276490, 131044, 320472, 34506, 34895, 20655, 251511, 305152, 354955, 16245, 110279, 184364, 38580, 276649], "solver_status": "OPTIMAL", "solved_time_s": 0.026429414749145508, "num_vars": 1985, "num_cons": 222}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 8, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 9, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 10, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 11, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 12, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 13, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 14, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 15, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 16, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 17, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 18, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 19, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 20, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 21, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 22, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 23, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 24, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 25, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 26, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 27, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 28, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 29, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 30, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 31, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 32, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 33, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 34, "assigned_docs": [29], "total_batch_length": 29953, "total_latency_us": 95147, "mlp_cost_us": 54845.5810546875, "attn_cost_us": 40302.346701342, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 35, "assigned_docs": [28], "total_batch_length": 8823, "total_latency_us": 19819, "mlp_cost_us": 16155.3955078125, "attn_cost_us": 3664.156117399935, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 36, "assigned_docs": [27], "total_batch_length": 8420, "total_latency_us": 18762, "mlp_cost_us": 15417.48046875, "attn_cost_us": 3345.403444173725, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 37, "assigned_docs": [26], "total_batch_length": 14760, "total_latency_us": 37003, "mlp_cost_us": 27026.3671875, "attn_cost_us": 9976.898328752432, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 38, "assigned_docs": [25], "total_batch_length": 8083, "total_latency_us": 17892, "mlp_cost_us": 14800.4150390625, "attn_cost_us": 3092.308660886565, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 39, "assigned_docs": [24], "total_batch_length": 54086, "total_latency_us": 230031, "mlp_cost_us": 99034.423828125, "attn_cost_us": 130996.87811039317, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 40, "assigned_docs": [23], "total_batch_length": 74115, "total_latency_us": 383436, "mlp_cost_us": 135708.6181640625, "attn_cost_us": 247727.98978474925, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 41, "assigned_docs": [22], "total_batch_length": 54571, "total_latency_us": 233276, "mlp_cost_us": 99922.4853515625, "attn_cost_us": 133354.1811638524, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 42, "assigned_docs": [21], "total_batch_length": 17053, "total_latency_us": 44456, "mlp_cost_us": 31224.9755859375, "attn_cost_us": 13231.575183174276, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 43, "assigned_docs": [20], "total_batch_length": 70502, "total_latency_us": 352575, "mlp_cost_us": 129093.017578125, "attn_cost_us": 223482.95615339853, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 44, "assigned_docs": [19], "total_batch_length": 23509, "total_latency_us": 68009, "mlp_cost_us": 43046.2646484375, "attn_cost_us": 24963.71232597073, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 45, "assigned_docs": [18], "total_batch_length": 61207, "total_latency_us": 279790, "mlp_cost_us": 112073.3642578125, "attn_cost_us": 167716.94684145474, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 46, "assigned_docs": [17], "total_batch_length": 7902, "total_latency_us": 17432, "mlp_cost_us": 14468.994140625, "attn_cost_us": 2963.1743373518134, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 47, "assigned_docs": [16], "total_batch_length": 32713, "total_latency_us": 107874, "mlp_cost_us": 59899.2919921875, "attn_cost_us": 47975.59636856116, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 48, "assigned_docs": [15], "total_batch_length": 8227, "total_latency_us": 18261, "mlp_cost_us": 15064.0869140625, "attn_cost_us": 3197.7493368679343, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 49, "assigned_docs": [14], "total_batch_length": 16561, "total_latency_us": 42811, "mlp_cost_us": 30324.0966796875, "attn_cost_us": 12487.400886313713, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 50, "assigned_docs": [13], "total_batch_length": 60754, "total_latency_us": 276490, "mlp_cost_us": 111243.896484375, "attn_cost_us": 165246.21054552728, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 51, "assigned_docs": [12], "total_batch_length": 37376, "total_latency_us": 131044, "mlp_cost_us": 68437.5, "attn_cost_us": 62607.27605564004, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 52, "assigned_docs": [11], "total_batch_length": 66573, "total_latency_us": 320472, "mlp_cost_us": 121898.8037109375, "attn_cost_us": 198573.70809816883, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 53, "assigned_docs": [10], "total_batch_length": 13958, "total_latency_us": 34506, "mlp_cost_us": 25557.861328125, "attn_cost_us": 8948.768513138284, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 54, "assigned_docs": [9], "total_batch_length": 14084, "total_latency_us": 34895, "mlp_cost_us": 25788.57421875, "attn_cost_us": 9106.694446950263, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 55, "assigned_docs": [8], "total_batch_length": 9138, "total_latency_us": 20655, "mlp_cost_us": 16732.177734375, "attn_cost_us": 3923.1162705321403, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 56, "assigned_docs": [7], "total_batch_length": 57240, "total_latency_us": 251511, "mlp_cost_us": 104809.5703125, "attn_cost_us": 146702.36096331914, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 57, "assigned_docs": [6], "total_batch_length": 64608, "total_latency_us": 305152, "mlp_cost_us": 118300.78125, "attn_cost_us": 186851.43569320705, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 58, "assigned_docs": [5], "total_batch_length": 70786, "total_latency_us": 354955, "mlp_cost_us": 129613.037109375, "attn_cost_us": 225342.21768409468, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 59, "assigned_docs": [4], "total_batch_length": 7431, "total_latency_us": 16245, "mlp_cost_us": 13606.5673828125, "attn_cost_us": 2639.283449663653, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 60, "assigned_docs": [3], "total_batch_length": 33216, "total_latency_us": 110279, "mlp_cost_us": 60820.3125, "attn_cost_us": 49458.95441605371, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 61, "assigned_docs": [2], "total_batch_length": 46893, "total_latency_us": 184364, "mlp_cost_us": 85863.6474609375, "attn_cost_us": 98501.2224121676, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 62, "assigned_docs": [1], "total_batch_length": 15258, "total_latency_us": 38580, "mlp_cost_us": 27938.232421875, "attn_cost_us": 10642.641698494017, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 63, "assigned_docs": [0], "total_batch_length": 60776, "total_latency_us": 276649, "mlp_cost_us": 111284.1796875, "attn_cost_us": 165365.779031679, "allreduce_cost_us": 0, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 63, "attn_time_us": 165365.779031679, "mlp_time_us": 111284.1796875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 276649}, {"doc_id": 1, "doc_len": 15258, "worker_id": 62, "attn_time_us": 10642.641698494017, "mlp_time_us": 27938.232421875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 38580}, {"doc_id": 2, "doc_len": 46893, "worker_id": 61, "attn_time_us": 98501.2224121676, "mlp_time_us": 85863.6474609375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 184364}, {"doc_id": 3, "doc_len": 33216, "worker_id": 60, "attn_time_us": 49458.95441605371, "mlp_time_us": 60820.3125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 110279}, {"doc_id": 4, "doc_len": 7431, "worker_id": 59, "attn_time_us": 2639.283449663653, "mlp_time_us": 13606.5673828125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 16245}, {"doc_id": 5, "doc_len": 70786, "worker_id": 58, "attn_time_us": 225342.21768409468, "mlp_time_us": 129613.037109375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 354955}, {"doc_id": 6, "doc_len": 64608, "worker_id": 57, "attn_time_us": 186851.43569320705, "mlp_time_us": 118300.78125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 305152}, {"doc_id": 7, "doc_len": 57240, "worker_id": 56, "attn_time_us": 146702.36096331914, "mlp_time_us": 104809.5703125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 251511}, {"doc_id": 8, "doc_len": 9138, "worker_id": 55, "attn_time_us": 3923.1162705321403, "mlp_time_us": 16732.177734375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 20655}, {"doc_id": 9, "doc_len": 14084, "worker_id": 54, "attn_time_us": 9106.694446950263, "mlp_time_us": 25788.57421875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 34895}, {"doc_id": 10, "doc_len": 13958, "worker_id": 53, "attn_time_us": 8948.768513138284, "mlp_time_us": 25557.861328125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 34506}, {"doc_id": 11, "doc_len": 66573, "worker_id": 52, "attn_time_us": 198573.70809816883, "mlp_time_us": 121898.8037109375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 320472}, {"doc_id": 12, "doc_len": 37376, "worker_id": 51, "attn_time_us": 62607.27605564004, "mlp_time_us": 68437.5, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 131044}, {"doc_id": 13, "doc_len": 60754, "worker_id": 50, "attn_time_us": 165246.21054552728, "mlp_time_us": 111243.896484375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 276490}, {"doc_id": 14, "doc_len": 16561, "worker_id": 49, "attn_time_us": 12487.400886313713, "mlp_time_us": 30324.0966796875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 42811}, {"doc_id": 15, "doc_len": 8227, "worker_id": 48, "attn_time_us": 3197.7493368679343, "mlp_time_us": 15064.0869140625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 18261}, {"doc_id": 16, "doc_len": 32713, "worker_id": 47, "attn_time_us": 47975.59636856116, "mlp_time_us": 59899.2919921875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 107874}, {"doc_id": 17, "doc_len": 7902, "worker_id": 46, "attn_time_us": 2963.1743373518134, "mlp_time_us": 14468.994140625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 17432}, {"doc_id": 18, "doc_len": 61207, "worker_id": 45, "attn_time_us": 167716.94684145474, "mlp_time_us": 112073.3642578125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 279790}, {"doc_id": 19, "doc_len": 23509, "worker_id": 44, "attn_time_us": 24963.71232597073, "mlp_time_us": 43046.2646484375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 68009}, {"doc_id": 20, "doc_len": 70502, "worker_id": 43, "attn_time_us": 223482.95615339853, "mlp_time_us": 129093.017578125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 352575}, {"doc_id": 21, "doc_len": 17053, "worker_id": 42, "attn_time_us": 13231.575183174276, "mlp_time_us": 31224.9755859375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 44456}, {"doc_id": 22, "doc_len": 54571, "worker_id": 41, "attn_time_us": 133354.1811638524, "mlp_time_us": 99922.4853515625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 233276}, {"doc_id": 23, "doc_len": 74115, "worker_id": 40, "attn_time_us": 247727.98978474925, "mlp_time_us": 135708.6181640625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 383436}, {"doc_id": 24, "doc_len": 54086, "worker_id": 39, "attn_time_us": 130996.87811039317, "mlp_time_us": 99034.423828125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 230031}, {"doc_id": 25, "doc_len": 8083, "worker_id": 38, "attn_time_us": 3092.308660886565, "mlp_time_us": 14800.4150390625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 17892}, {"doc_id": 26, "doc_len": 14760, "worker_id": 37, "attn_time_us": 9976.898328752432, "mlp_time_us": 27026.3671875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 37003}, {"doc_id": 27, "doc_len": 8420, "worker_id": 36, "attn_time_us": 3345.403444173725, "mlp_time_us": 15417.48046875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 18762}, {"doc_id": 28, "doc_len": 8823, "worker_id": 35, "attn_time_us": 3664.156117399935, "mlp_time_us": 16155.3955078125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 19819}, {"doc_id": 29, "doc_len": 29953, "worker_id": 34, "attn_time_us": 40302.346701342, "mlp_time_us": 54845.5810546875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 95147}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 165365.779031679, "mlp_time": 111284.1796875, "allgather_time": 0, "allreduce_time": 0}, "1": {"doc_len": 15258, "attn_time": 10642.641698494017, "mlp_time": 27938.232421875, "allgather_time": 0, "allreduce_time": 0}, "2": {"doc_len": 46893, "attn_time": 98501.2224121676, "mlp_time": 85863.6474609375, "allgather_time": 0, "allreduce_time": 0}, "3": {"doc_len": 33216, "attn_time": 49458.95441605371, "mlp_time": 60820.3125, "allgather_time": 0, "allreduce_time": 0}, "4": {"doc_len": 7431, "attn_time": 2639.283449663653, "mlp_time": 13606.5673828125, "allgather_time": 0, "allreduce_time": 0}, "5": {"doc_len": 70786, "attn_time": 225342.21768409468, "mlp_time": 129613.037109375, "allgather_time": 0, "allreduce_time": 0}, "6": {"doc_len": 64608, "attn_time": 186851.43569320705, "mlp_time": 118300.78125, "allgather_time": 0, "allreduce_time": 0}, "7": {"doc_len": 57240, "attn_time": 146702.36096331914, "mlp_time": 104809.5703125, "allgather_time": 0, "allreduce_time": 0}, "8": {"doc_len": 9138, "attn_time": 3923.1162705321403, "mlp_time": 16732.177734375, "allgather_time": 0, "allreduce_time": 0}, "9": {"doc_len": 14084, "attn_time": 9106.694446950263, "mlp_time": 25788.57421875, "allgather_time": 0, "allreduce_time": 0}, "10": {"doc_len": 13958, "attn_time": 8948.768513138284, "mlp_time": 25557.861328125, "allgather_time": 0, "allreduce_time": 0}, "11": {"doc_len": 66573, "attn_time": 198573.70809816883, "mlp_time": 121898.8037109375, "allgather_time": 0, "allreduce_time": 0}, "12": {"doc_len": 37376, "attn_time": 62607.27605564004, "mlp_time": 68437.5, "allgather_time": 0, "allreduce_time": 0}, "13": {"doc_len": 60754, "attn_time": 165246.21054552728, "mlp_time": 111243.896484375, "allgather_time": 0, "allreduce_time": 0}, "14": {"doc_len": 16561, "attn_time": 12487.400886313713, "mlp_time": 30324.0966796875, "allgather_time": 0, "allreduce_time": 0}, "15": {"doc_len": 8227, "attn_time": 3197.7493368679343, "mlp_time": 15064.0869140625, "allgather_time": 0, "allreduce_time": 0}, "16": {"doc_len": 32713, "attn_time": 47975.59636856116, "mlp_time": 59899.2919921875, "allgather_time": 0, "allreduce_time": 0}, "17": {"doc_len": 7902, "attn_time": 2963.1743373518134, "mlp_time": 14468.994140625, "allgather_time": 0, "allreduce_time": 0}, "18": {"doc_len": 61207, "attn_time": 167716.94684145474, "mlp_time": 112073.3642578125, "allgather_time": 0, "allreduce_time": 0}, "19": {"doc_len": 23509, "attn_time": 24963.71232597073, "mlp_time": 43046.2646484375, "allgather_time": 0, "allreduce_time": 0}, "20": {"doc_len": 70502, "attn_time": 223482.95615339853, "mlp_time": 129093.017578125, "allgather_time": 0, "allreduce_time": 0}, "21": {"doc_len": 17053, "attn_time": 13231.575183174276, "mlp_time": 31224.9755859375, "allgather_time": 0, "allreduce_time": 0}, "22": {"doc_len": 54571, "attn_time": 133354.1811638524, "mlp_time": 99922.4853515625, "allgather_time": 0, "allreduce_time": 0}, "23": {"doc_len": 74115, "attn_time": 247727.98978474925, "mlp_time": 135708.6181640625, "allgather_time": 0, "allreduce_time": 0}, "24": {"doc_len": 54086, "attn_time": 130996.87811039317, "mlp_time": 99034.423828125, "allgather_time": 0, "allreduce_time": 0}, "25": {"doc_len": 8083, "attn_time": 3092.308660886565, "mlp_time": 14800.4150390625, "allgather_time": 0, "allreduce_time": 0}, "26": {"doc_len": 14760, "attn_time": 9976.898328752432, "mlp_time": 27026.3671875, "allgather_time": 0, "allreduce_time": 0}, "27": {"doc_len": 8420, "attn_time": 3345.403444173725, "mlp_time": 15417.48046875, "allgather_time": 0, "allreduce_time": 0}, "28": {"doc_len": 8823, "attn_time": 3664.156117399935, "mlp_time": 16155.3955078125, "allgather_time": 0, "allreduce_time": 0}, "29": {"doc_len": 29953, "attn_time": 40302.346701342, "mlp_time": 54845.5810546875, "allgather_time": 0, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 67918.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 1, "mlp_cp": 1}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 2, "dp": 32, "ratio": 0.3687748409095845, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 184172, "worker_latencies_us": [0, 0, 47842, 10271, 9728, 18961, 9283, 112726, 184172, 114262, 22679, 169991, 34457, 136169, 9050, 54062, 9470, 21850, 134621, 65343, 155166, 17714, 17908, 10699, 122872, 148042, 171087, 8448, 55237, 91008, 19746, 134696], "doc2worker": {"0": 31, "1": 30, "2": 29, "3": 28, "4": 27, "5": 26, "6": 25, "7": 24, "8": 23, "9": 22, "10": 21, "11": 20, "12": 19, "13": 18, "14": 17, "15": 16, "16": 15, "17": 14, "18": 13, "19": 12, "20": 11, "21": 10, "22": 9, "23": 8, "24": 7, "25": 6, "26": 5, "27": 4, "28": 3, "29": 2}, "latency_breakdown": {"max_worker_latency_us": 184172, "worker_latencies_us": [0, 0, 47842, 10271, 9728, 18961, 9283, 112726, 184172, 114262, 22679, 169991, 34457, 136169, 9050, 54062, 9470, 21850, 134621, 65343, 155166, 17714, 17908, 10699, 122872, 148042, 171087, 8448, 55237, 91008, 19746, 134696], "solver_status": "OPTIMAL", "solved_time_s": 0.017984628677368164, "num_vars": 993, "num_cons": 126}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [29], "total_batch_length": 29953, "total_latency_us": 47842, "mlp_cost_us": 27422.79052734375, "attn_cost_us": 20272.077100717615, "allreduce_cost_us": 0, "allgather_cost_us": 148.11163425445557}, {"worker_id": 3, "assigned_docs": [28], "total_batch_length": 8823, "total_latency_us": 10271, "mlp_cost_us": 8077.69775390625, "attn_cost_us": 2149.9821579394343, "allreduce_cost_us": 0, "allgather_cost_us": 43.6279821395874}, {"worker_id": 4, "assigned_docs": [27], "total_batch_length": 8420, "total_latency_us": 9728, "mlp_cost_us": 7708.740234375, "attn_cost_us": 1978.230701874134, "allreduce_cost_us": 0, "allgather_cost_us": 41.63522720336914}, {"worker_id": 5, "assigned_docs": [26], "total_batch_length": 14760, "total_latency_us": 18961, "mlp_cost_us": 13513.18359375, "attn_cost_us": 5375.1773603641805, "allreduce_cost_us": 0, "allgather_cost_us": 72.98526763916014}, {"worker_id": 6, "assigned_docs": [25], "total_batch_length": 8083, "total_latency_us": 9283, "mlp_cost_us": 7400.20751953125, "attn_cost_us": 1843.371105564228, "allreduce_cost_us": 0, "allgather_cost_us": 39.968829154968255}, {"worker_id": 7, "assigned_docs": [24], "total_batch_length": 54086, "total_latency_us": 112726, "mlp_cost_us": 49517.2119140625, "attn_cost_us": 62942.016870461244, "allreduce_cost_us": 0, "allgather_cost_us": 267.44452476501465}, {"worker_id": 8, "assigned_docs": [23], "total_batch_length": 74115, "total_latency_us": 184172, "mlp_cost_us": 67854.30908203125, "attn_cost_us": 115951.23346235674, "allreduce_cost_us": 0, "allgather_cost_us": 366.48395061492914}, {"worker_id": 9, "assigned_docs": [22], "total_batch_length": 54571, "total_latency_us": 114262, "mlp_cost_us": 49961.24267578125, "attn_cost_us": 64031.13809594561, "allreduce_cost_us": 0, "allgather_cost_us": 269.8427534103393}, {"worker_id": 10, "assigned_docs": [21], "total_batch_length": 17053, "total_latency_us": 22679, "mlp_cost_us": 15612.48779296875, "attn_cost_us": 6982.485664024504, "allreduce_cost_us": 0, "allgather_cost_us": 84.32369709014893}, {"worker_id": 11, "assigned_docs": [20], "total_batch_length": 70502, "total_latency_us": 169991, "mlp_cost_us": 64546.5087890625, "attn_cost_us": 105096.6058876762, "allreduce_cost_us": 0, "allgather_cost_us": 348.6183834075928}, {"worker_id": 12, "assigned_docs": [19], "total_batch_length": 23509, "total_latency_us": 34457, "mlp_cost_us": 21523.13232421875, "attn_cost_us": 12818.440398306775, "allreduce_cost_us": 0, "allgather_cost_us": 116.24733448028564}, {"worker_id": 13, "assigned_docs": [18], "total_batch_length": 61207, "total_latency_us": 136169, "mlp_cost_us": 56036.68212890625, "attn_cost_us": 79830.29207458592, "allreduce_cost_us": 0, "allgather_cost_us": 302.656455039978}, {"worker_id": 14, "assigned_docs": [17], "total_batch_length": 7902, "total_latency_us": 9050, "mlp_cost_us": 7234.4970703125, "attn_cost_us": 1776.9044014486149, "allreduce_cost_us": 0, "allgather_cost_us": 39.073820114135735}, {"worker_id": 15, "assigned_docs": [16], "total_batch_length": 32713, "total_latency_us": 54062, "mlp_cost_us": 29949.64599609375, "attn_cost_us": 23951.285283000212, "allreduce_cost_us": 0, "allgather_cost_us": 161.75928592681885}, {"worker_id": 16, "assigned_docs": [15], "total_batch_length": 8227, "total_latency_us": 9470, "mlp_cost_us": 7532.04345703125, "attn_cost_us": 1898.205005270559, "allreduce_cost_us": 0, "allgather_cost_us": 40.68088054656982}, {"worker_id": 17, "assigned_docs": [14], "total_batch_length": 16561, "total_latency_us": 21850, "mlp_cost_us": 15162.04833984375, "attn_cost_us": 6606.221801817794, "allreduce_cost_us": 0, "allgather_cost_us": 81.89085483551024}, {"worker_id": 18, "assigned_docs": [13], "total_batch_length": 60754, "total_latency_us": 134621, "mlp_cost_us": 55621.9482421875, "attn_cost_us": 78698.75510949675, "allreduce_cost_us": 0, "allgather_cost_us": 300.41646003723145}, {"worker_id": 19, "assigned_docs": [12], "total_batch_length": 37376, "total_latency_us": 65343, "mlp_cost_us": 34218.75, "attn_cost_us": 30940.074128966226, "allreduce_cost_us": 0, "allgather_cost_us": 184.81689453125}, {"worker_id": 20, "assigned_docs": [11], "total_batch_length": 66573, "total_latency_us": 155166, "mlp_cost_us": 60949.40185546875, "attn_cost_us": 93888.24949107385, "allreduce_cost_us": 0, "allgather_cost_us": 329.1902589797973}, {"worker_id": 21, "assigned_docs": [10], "total_batch_length": 13958, "total_latency_us": 17714, "mlp_cost_us": 12778.9306640625, "attn_cost_us": 4866.141055684961, "allreduce_cost_us": 0, "allgather_cost_us": 69.0195369720459}, {"worker_id": 22, "assigned_docs": [9], "total_batch_length": 14084, "total_latency_us": 17908, "mlp_cost_us": 12894.287109375, "attn_cost_us": 4944.642328302495, "allreduce_cost_us": 0, "allgather_cost_us": 69.64258193969727}, {"worker_id": 23, "assigned_docs": [8], "total_batch_length": 9138, "total_latency_us": 10699, "mlp_cost_us": 8366.0888671875, "attn_cost_us": 2288.5757186742453, "allreduce_cost_us": 0, "allgather_cost_us": 45.18559455871582}, {"worker_id": 24, "assigned_docs": [7], "total_batch_length": 57240, "total_latency_us": 122872, "mlp_cost_us": 52404.78515625, "attn_cost_us": 70184.80694395679, "allreduce_cost_us": 0, "allgather_cost_us": 283.04042816162104}, {"worker_id": 25, "assigned_docs": [6], "total_batch_length": 64608, "total_latency_us": 148042, "mlp_cost_us": 59150.390625, "attn_cost_us": 88572.61968627307, "allreduce_cost_us": 0, "allgather_cost_us": 319.4737243652344}, {"worker_id": 26, "assigned_docs": [5], "total_batch_length": 70786, "total_latency_us": 171087, "mlp_cost_us": 64806.5185546875, "attn_cost_us": 105930.842860526, "allreduce_cost_us": 0, "allgather_cost_us": 350.02270698547363}, {"worker_id": 27, "assigned_docs": [4], "total_batch_length": 7431, "total_latency_us": 8448, "mlp_cost_us": 6803.28369140625, "attn_cost_us": 1608.3687507533346, "allreduce_cost_us": 0, "allgather_cost_us": 36.744818687438965}, {"worker_id": 28, "assigned_docs": [3], "total_batch_length": 33216, "total_latency_us": 55237, "mlp_cost_us": 30410.15625, "attn_cost_us": 24662.79740928251, "allreduce_cost_us": 0, "allgather_cost_us": 164.24652099609375}, {"worker_id": 29, "assigned_docs": [2], "total_batch_length": 46893, "total_latency_us": 91008, "mlp_cost_us": 42931.82373046875, "attn_cost_us": 47845.27725082306, "allreduce_cost_us": 0, "allgather_cost_us": 231.8765687942505}, {"worker_id": 30, "assigned_docs": [1], "total_batch_length": 15258, "total_latency_us": 19746, "mlp_cost_us": 13969.1162109375, "attn_cost_us": 5702.3847281329445, "allreduce_cost_us": 0, "allgather_cost_us": 75.44777870178223}, {"worker_id": 31, "assigned_docs": [0], "total_batch_length": 60776, "total_latency_us": 134696, "mlp_cost_us": 55642.08984375, "attn_cost_us": 78753.52932748919, "allreduce_cost_us": 0, "allgather_cost_us": 300.5252456665039}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 31, "attn_time_us": 78753.52932748919, "mlp_time_us": 55642.08984375, "allgather_time_us": 300.5252456665039, "allreduce_time_us": 0, "total_latency_us": 134696}, {"doc_id": 1, "doc_len": 15258, "worker_id": 30, "attn_time_us": 5702.3847281329445, "mlp_time_us": 13969.1162109375, "allgather_time_us": 75.44777870178223, "allreduce_time_us": 0, "total_latency_us": 19746}, {"doc_id": 2, "doc_len": 46893, "worker_id": 29, "attn_time_us": 47845.27725082306, "mlp_time_us": 42931.82373046875, "allgather_time_us": 231.8765687942505, "allreduce_time_us": 0, "total_latency_us": 91008}, {"doc_id": 3, "doc_len": 33216, "worker_id": 28, "attn_time_us": 24662.79740928251, "mlp_time_us": 30410.15625, "allgather_time_us": 164.24652099609375, "allreduce_time_us": 0, "total_latency_us": 55237}, {"doc_id": 4, "doc_len": 7431, "worker_id": 27, "attn_time_us": 1608.3687507533346, "mlp_time_us": 6803.28369140625, "allgather_time_us": 36.744818687438965, "allreduce_time_us": 0, "total_latency_us": 8448}, {"doc_id": 5, "doc_len": 70786, "worker_id": 26, "attn_time_us": 105930.842860526, "mlp_time_us": 64806.5185546875, "allgather_time_us": 350.02270698547363, "allreduce_time_us": 0, "total_latency_us": 171087}, {"doc_id": 6, "doc_len": 64608, "worker_id": 25, "attn_time_us": 88572.61968627307, "mlp_time_us": 59150.390625, "allgather_time_us": 319.4737243652344, "allreduce_time_us": 0, "total_latency_us": 148042}, {"doc_id": 7, "doc_len": 57240, "worker_id": 24, "attn_time_us": 70184.80694395679, "mlp_time_us": 52404.78515625, "allgather_time_us": 283.04042816162104, "allreduce_time_us": 0, "total_latency_us": 122872}, {"doc_id": 8, "doc_len": 9138, "worker_id": 23, "attn_time_us": 2288.5757186742453, "mlp_time_us": 8366.0888671875, "allgather_time_us": 45.18559455871582, "allreduce_time_us": 0, "total_latency_us": 10699}, {"doc_id": 9, "doc_len": 14084, "worker_id": 22, "attn_time_us": 4944.642328302495, "mlp_time_us": 12894.287109375, "allgather_time_us": 69.64258193969727, "allreduce_time_us": 0, "total_latency_us": 17908}, {"doc_id": 10, "doc_len": 13958, "worker_id": 21, "attn_time_us": 4866.141055684961, "mlp_time_us": 12778.9306640625, "allgather_time_us": 69.0195369720459, "allreduce_time_us": 0, "total_latency_us": 17714}, {"doc_id": 11, "doc_len": 66573, "worker_id": 20, "attn_time_us": 93888.24949107385, "mlp_time_us": 60949.40185546875, "allgather_time_us": 329.1902589797973, "allreduce_time_us": 0, "total_latency_us": 155166}, {"doc_id": 12, "doc_len": 37376, "worker_id": 19, "attn_time_us": 30940.074128966226, "mlp_time_us": 34218.75, "allgather_time_us": 184.81689453125, "allreduce_time_us": 0, "total_latency_us": 65343}, {"doc_id": 13, "doc_len": 60754, "worker_id": 18, "attn_time_us": 78698.75510949675, "mlp_time_us": 55621.9482421875, "allgather_time_us": 300.41646003723145, "allreduce_time_us": 0, "total_latency_us": 134621}, {"doc_id": 14, "doc_len": 16561, "worker_id": 17, "attn_time_us": 6606.221801817794, "mlp_time_us": 15162.04833984375, "allgather_time_us": 81.89085483551024, "allreduce_time_us": 0, "total_latency_us": 21850}, {"doc_id": 15, "doc_len": 8227, "worker_id": 16, "attn_time_us": 1898.205005270559, "mlp_time_us": 7532.04345703125, "allgather_time_us": 40.68088054656982, "allreduce_time_us": 0, "total_latency_us": 9470}, {"doc_id": 16, "doc_len": 32713, "worker_id": 15, "attn_time_us": 23951.285283000212, "mlp_time_us": 29949.64599609375, "allgather_time_us": 161.75928592681885, "allreduce_time_us": 0, "total_latency_us": 54062}, {"doc_id": 17, "doc_len": 7902, "worker_id": 14, "attn_time_us": 1776.9044014486149, "mlp_time_us": 7234.4970703125, "allgather_time_us": 39.073820114135735, "allreduce_time_us": 0, "total_latency_us": 9050}, {"doc_id": 18, "doc_len": 61207, "worker_id": 13, "attn_time_us": 79830.29207458592, "mlp_time_us": 56036.68212890625, "allgather_time_us": 302.656455039978, "allreduce_time_us": 0, "total_latency_us": 136169}, {"doc_id": 19, "doc_len": 23509, "worker_id": 12, "attn_time_us": 12818.440398306775, "mlp_time_us": 21523.13232421875, "allgather_time_us": 116.24733448028564, "allreduce_time_us": 0, "total_latency_us": 34457}, {"doc_id": 20, "doc_len": 70502, "worker_id": 11, "attn_time_us": 105096.6058876762, "mlp_time_us": 64546.5087890625, "allgather_time_us": 348.6183834075928, "allreduce_time_us": 0, "total_latency_us": 169991}, {"doc_id": 21, "doc_len": 17053, "worker_id": 10, "attn_time_us": 6982.485664024504, "mlp_time_us": 15612.48779296875, "allgather_time_us": 84.32369709014893, "allreduce_time_us": 0, "total_latency_us": 22679}, {"doc_id": 22, "doc_len": 54571, "worker_id": 9, "attn_time_us": 64031.13809594561, "mlp_time_us": 49961.24267578125, "allgather_time_us": 269.8427534103393, "allreduce_time_us": 0, "total_latency_us": 114262}, {"doc_id": 23, "doc_len": 74115, "worker_id": 8, "attn_time_us": 115951.23346235674, "mlp_time_us": 67854.30908203125, "allgather_time_us": 366.48395061492914, "allreduce_time_us": 0, "total_latency_us": 184172}, {"doc_id": 24, "doc_len": 54086, "worker_id": 7, "attn_time_us": 62942.016870461244, "mlp_time_us": 49517.2119140625, "allgather_time_us": 267.44452476501465, "allreduce_time_us": 0, "total_latency_us": 112726}, {"doc_id": 25, "doc_len": 8083, "worker_id": 6, "attn_time_us": 1843.371105564228, "mlp_time_us": 7400.20751953125, "allgather_time_us": 39.968829154968255, "allreduce_time_us": 0, "total_latency_us": 9283}, {"doc_id": 26, "doc_len": 14760, "worker_id": 5, "attn_time_us": 5375.1773603641805, "mlp_time_us": 13513.18359375, "allgather_time_us": 72.98526763916014, "allreduce_time_us": 0, "total_latency_us": 18961}, {"doc_id": 27, "doc_len": 8420, "worker_id": 4, "attn_time_us": 1978.230701874134, "mlp_time_us": 7708.740234375, "allgather_time_us": 41.63522720336914, "allreduce_time_us": 0, "total_latency_us": 9728}, {"doc_id": 28, "doc_len": 8823, "worker_id": 3, "attn_time_us": 2149.9821579394343, "mlp_time_us": 8077.69775390625, "allgather_time_us": 43.6279821395874, "allreduce_time_us": 0, "total_latency_us": 10271}, {"doc_id": 29, "doc_len": 29953, "worker_id": 2, "attn_time_us": 20272.077100717615, "mlp_time_us": 27422.79052734375, "allgather_time_us": 148.11163425445557, "allreduce_time_us": 0, "total_latency_us": 47842}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 78753.52932748919, "mlp_time": 55642.08984375, "allgather_time": 300.5252456665039, "allreduce_time": 0}, "1": {"doc_len": 15258, "attn_time": 5702.3847281329445, "mlp_time": 13969.1162109375, "allgather_time": 75.44777870178223, "allreduce_time": 0}, "2": {"doc_len": 46893, "attn_time": 47845.27725082306, "mlp_time": 42931.82373046875, "allgather_time": 231.8765687942505, "allreduce_time": 0}, "3": {"doc_len": 33216, "attn_time": 24662.79740928251, "mlp_time": 30410.15625, "allgather_time": 164.24652099609375, "allreduce_time": 0}, "4": {"doc_len": 7431, "attn_time": 1608.3687507533346, "mlp_time": 6803.28369140625, "allgather_time": 36.744818687438965, "allreduce_time": 0}, "5": {"doc_len": 70786, "attn_time": 105930.842860526, "mlp_time": 64806.5185546875, "allgather_time": 350.02270698547363, "allreduce_time": 0}, "6": {"doc_len": 64608, "attn_time": 88572.61968627307, "mlp_time": 59150.390625, "allgather_time": 319.4737243652344, "allreduce_time": 0}, "7": {"doc_len": 57240, "attn_time": 70184.80694395679, "mlp_time": 52404.78515625, "allgather_time": 283.04042816162104, "allreduce_time": 0}, "8": {"doc_len": 9138, "attn_time": 2288.5757186742453, "mlp_time": 8366.0888671875, "allgather_time": 45.18559455871582, "allreduce_time": 0}, "9": {"doc_len": 14084, "attn_time": 4944.642328302495, "mlp_time": 12894.287109375, "allgather_time": 69.64258193969727, "allreduce_time": 0}, "10": {"doc_len": 13958, "attn_time": 4866.141055684961, "mlp_time": 12778.9306640625, "allgather_time": 69.0195369720459, "allreduce_time": 0}, "11": {"doc_len": 66573, "attn_time": 93888.24949107385, "mlp_time": 60949.40185546875, "allgather_time": 329.1902589797973, "allreduce_time": 0}, "12": {"doc_len": 37376, "attn_time": 30940.074128966226, "mlp_time": 34218.75, "allgather_time": 184.81689453125, "allreduce_time": 0}, "13": {"doc_len": 60754, "attn_time": 78698.75510949675, "mlp_time": 55621.9482421875, "allgather_time": 300.41646003723145, "allreduce_time": 0}, "14": {"doc_len": 16561, "attn_time": 6606.221801817794, "mlp_time": 15162.04833984375, "allgather_time": 81.89085483551024, "allreduce_time": 0}, "15": {"doc_len": 8227, "attn_time": 1898.205005270559, "mlp_time": 7532.04345703125, "allgather_time": 40.68088054656982, "allreduce_time": 0}, "16": {"doc_len": 32713, "attn_time": 23951.285283000212, "mlp_time": 29949.64599609375, "allgather_time": 161.75928592681885, "allreduce_time": 0}, "17": {"doc_len": 7902, "attn_time": 1776.9044014486149, "mlp_time": 7234.4970703125, "allgather_time": 39.073820114135735, "allreduce_time": 0}, "18": {"doc_len": 61207, "attn_time": 79830.29207458592, "mlp_time": 56036.68212890625, "allgather_time": 302.656455039978, "allreduce_time": 0}, "19": {"doc_len": 23509, "attn_time": 12818.440398306775, "mlp_time": 21523.13232421875, "allgather_time": 116.24733448028564, "allreduce_time": 0}, "20": {"doc_len": 70502, "attn_time": 105096.6058876762, "mlp_time": 64546.5087890625, "allgather_time": 348.6183834075928, "allreduce_time": 0}, "21": {"doc_len": 17053, "attn_time": 6982.485664024504, "mlp_time": 15612.48779296875, "allgather_time": 84.32369709014893, "allreduce_time": 0}, "22": {"doc_len": 54571, "attn_time": 64031.13809594561, "mlp_time": 49961.24267578125, "allgather_time": 269.8427534103393, "allreduce_time": 0}, "23": {"doc_len": 74115, "attn_time": 115951.23346235674, "mlp_time": 67854.30908203125, "allgather_time": 366.48395061492914, "allreduce_time": 0}, "24": {"doc_len": 54086, "attn_time": 62942.016870461244, "mlp_time": 49517.2119140625, "allgather_time": 267.44452476501465, "allreduce_time": 0}, "25": {"doc_len": 8083, "attn_time": 1843.371105564228, "mlp_time": 7400.20751953125, "allgather_time": 39.968829154968255, "allreduce_time": 0}, "26": {"doc_len": 14760, "attn_time": 5375.1773603641805, "mlp_time": 13513.18359375, "allgather_time": 72.98526763916014, "allreduce_time": 0}, "27": {"doc_len": 8420, "attn_time": 1978.230701874134, "mlp_time": 7708.740234375, "allgather_time": 41.63522720336914, "allreduce_time": 0}, "28": {"doc_len": 8823, "attn_time": 2149.9821579394343, "mlp_time": 8077.69775390625, "allgather_time": 43.6279821395874, "allreduce_time": 0}, "29": {"doc_len": 29953, "attn_time": 20272.077100717615, "mlp_time": 27422.79052734375, "allgather_time": 148.11163425445557, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 67918.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 1, "mlp_cp": 2}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 4, "dp": 16, "ratio": 0.7192722343422362, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 94426, "worker_latencies_us": [94426, 94176, 92921, 87191, 69965, 70937, 78468, 85169, 63202, 75993, 87750, 29150, 28575, 46941, 10242, 74541], "doc2worker": {"0": 15, "1": 14, "2": 13, "3": 12, "4": 11, "5": 10, "6": 9, "7": 8, "8": 7, "9": 6, "10": 5, "11": 7, "12": 5, "13": 6, "14": 2, "15": 2, "16": 5, "17": 1, "18": 4, "19": 2, "20": 3, "21": 1, "22": 2, "23": 0, "24": 1, "25": 1, "26": 1, "27": 1, "28": 15, "29": 11}, "latency_breakdown": {"max_worker_latency_us": 94426, "worker_latencies_us": [94426, 94176, 92921, 87191, 69965, 70937, 78468, 85169, 63202, 75993, 87750, 29150, 28575, 46941, 10242, 74541], "solver_status": "OPTIMAL", "solved_time_s": 0.022173166275024414, "num_vars": 497, "num_cons": 78}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [23], "total_batch_length": 74115, "total_latency_us": 94426, "mlp_cost_us": 33927.154541015625, "attn_cost_us": 60091.03072139219, "allreduce_cost_us": 0, "allgather_cost_us": 408.5394859313965}, {"worker_id": 1, "assigned_docs": [17, 21, 24, 25, 26, 27], "total_batch_length": 110304, "total_latency_us": 94176, "mlp_cost_us": 50493.1640625, "attn_cost_us": 43077.5038875264, "allreduce_cost_us": 0, "allgather_cost_us": 608.0218505859375}, {"worker_id": 2, "assigned_docs": [14, 15, 19, 22], "total_batch_length": 102868, "total_latency_us": 92921, "mlp_cost_us": 47089.2333984375, "attn_cost_us": 45266.80510121788, "allreduce_cost_us": 0, "allgather_cost_us": 567.0328521728516}, {"worker_id": 3, "assigned_docs": [20], "total_batch_length": 70502, "total_latency_us": 87191, "mlp_cost_us": 32273.25439453125, "attn_cost_us": 54529.65612087477, "allreduce_cost_us": 0, "allgather_cost_us": 388.62377166748047}, {"worker_id": 4, "assigned_docs": [18], "total_batch_length": 61207, "total_latency_us": 69965, "mlp_cost_us": 28018.341064453125, "attn_cost_us": 41609.880796052974, "allreduce_cost_us": 0, "allgather_cost_us": 337.38752365112305}, {"worker_id": 5, "assigned_docs": [10, 12, 16], "total_batch_length": 84047, "total_latency_us": 70937, "mlp_cost_us": 38473.663330078125, "attn_cost_us": 32001.50115829011, "allreduce_cost_us": 0, "allgather_cost_us": 463.2870292663574}, {"worker_id": 6, "assigned_docs": [9, 13], "total_batch_length": 74838, "total_latency_us": 78468, "mlp_cost_us": 34258.11767578125, "attn_cost_us": 43798.87495827106, "allreduce_cost_us": 0, "allgather_cost_us": 412.5248336791992}, {"worker_id": 7, "assigned_docs": [8, 11], "total_batch_length": 75711, "total_latency_us": 85169, "mlp_cost_us": 34657.745361328125, "attn_cost_us": 50094.89232875787, "allreduce_cost_us": 0, "allgather_cost_us": 417.3370170593262}, {"worker_id": 8, "assigned_docs": [7], "total_batch_length": 57240, "total_latency_us": 63202, "mlp_cost_us": 26202.392578125, "attn_cost_us": 36684.902979857055, "allreduce_cost_us": 0, "allgather_cost_us": 315.5204772949219}, {"worker_id": 9, "assigned_docs": [6], "total_batch_length": 64608, "total_latency_us": 75993, "mlp_cost_us": 29575.1953125, "attn_cost_us": 46062.47950230927, "allreduce_cost_us": 0, "allgather_cost_us": 356.1346435546875}, {"worker_id": 10, "assigned_docs": [5], "total_batch_length": 70786, "total_latency_us": 87750, "mlp_cost_us": 32403.25927734375, "attn_cost_us": 54957.31271079316, "allreduce_cost_us": 0, "allgather_cost_us": 390.18924713134766}, {"worker_id": 11, "assigned_docs": [4, 29], "total_batch_length": 37384, "total_latency_us": 29150, "mlp_cost_us": 17113.037109375, "attn_cost_us": 11832.126581886825, "allreduce_cost_us": 0, "allgather_cost_us": 206.06948852539062}, {"worker_id": 12, "assigned_docs": [3], "total_batch_length": 33216, "total_latency_us": 28575, "mlp_cost_us": 15205.078125, "attn_cost_us": 13187.381699075595, "allreduce_cost_us": 0, "allgather_cost_us": 183.094482421875}, {"worker_id": 13, "assigned_docs": [2], "total_batch_length": 46893, "total_latency_us": 46941, "mlp_cost_us": 21465.911865234375, "attn_cost_us": 25217.388191110786, "allreduce_cost_us": 0, "allgather_cost_us": 258.4853553771973}, {"worker_id": 14, "assigned_docs": [1], "total_batch_length": 15258, "total_latency_us": 10242, "mlp_cost_us": 6984.55810546875, "attn_cost_us": 3174.131171513787, "allreduce_cost_us": 0, "allgather_cost_us": 84.10572052001953}, {"worker_id": 15, "assigned_docs": [0, 28], "total_batch_length": 69599, "total_latency_us": 74541, "mlp_cost_us": 31859.893798828125, "attn_cost_us": 42298.87981334196, "allreduce_cost_us": 0, "allgather_cost_us": 383.6462211608887}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 15, "attn_time_us": 41060.75819853837, "mlp_time_us": 27821.044921875, "allgather_time_us": 335.0117492675781, "allreduce_time_us": 0, "total_latency_us": 69216}, {"doc_id": 1, "doc_len": 15258, "worker_id": 14, "attn_time_us": 3174.131171513787, "mlp_time_us": 6984.55810546875, "allgather_time_us": 84.10572052001953, "allreduce_time_us": 0, "total_latency_us": 10242}, {"doc_id": 2, "doc_len": 46893, "worker_id": 13, "attn_time_us": 25217.388191110786, "mlp_time_us": 21465.911865234375, "allgather_time_us": 258.4853553771973, "allreduce_time_us": 0, "total_latency_us": 46941}, {"doc_id": 3, "doc_len": 33216, "worker_id": 12, "attn_time_us": 13187.381699075595, "mlp_time_us": 15205.078125, "allgather_time_us": 183.094482421875, "allreduce_time_us": 0, "total_latency_us": 28575}, {"doc_id": 4, "doc_len": 7431, "worker_id": 11, "attn_time_us": 936.7605039870645, "mlp_time_us": 3401.641845703125, "allgather_time_us": 40.9614372253418, "allreduce_time_us": 0, "total_latency_us": 4379}, {"doc_id": 5, "doc_len": 70786, "worker_id": 10, "attn_time_us": 54957.31271079316, "mlp_time_us": 32403.25927734375, "allgather_time_us": 390.18924713134766, "allreduce_time_us": 0, "total_latency_us": 87750}, {"doc_id": 6, "doc_len": 64608, "worker_id": 9, "attn_time_us": 46062.47950230927, "mlp_time_us": 29575.1953125, "allgather_time_us": 356.1346435546875, "allreduce_time_us": 0, "total_latency_us": 75993}, {"doc_id": 7, "doc_len": 57240, "worker_id": 8, "attn_time_us": 36684.902979857055, "mlp_time_us": 26202.392578125, "allgather_time_us": 315.5204772949219, "allreduce_time_us": 0, "total_latency_us": 63202}, {"doc_id": 8, "doc_len": 9138, "worker_id": 7, "attn_time_us": 1315.0686957301634, "mlp_time_us": 4183.04443359375, "allgather_time_us": 50.370826721191406, "allreduce_time_us": 0, "total_latency_us": 5548}, {"doc_id": 9, "doc_len": 14084, "worker_id": 6, "attn_time_us": 2766.0546109235556, "mlp_time_us": 6447.1435546875, "allgather_time_us": 77.63435363769531, "allreduce_time_us": 0, "total_latency_us": 9290}, {"doc_id": 10, "doc_len": 13958, "worker_id": 5, "attn_time_us": 2723.6589452311337, "mlp_time_us": 6389.46533203125, "allgather_time_us": 76.93981170654297, "allreduce_time_us": 0, "total_latency_us": 9190}, {"doc_id": 11, "doc_len": 66573, "worker_id": 7, "attn_time_us": 48779.82363302771, "mlp_time_us": 30474.700927734375, "allgather_time_us": 366.96619033813477, "allreduce_time_us": 0, "total_latency_us": 79621}, {"doc_id": 12, "doc_len": 37376, "worker_id": 5, "attn_time_us": 16462.55225945504, "mlp_time_us": 17109.375, "allgather_time_us": 206.025390625, "allreduce_time_us": 0, "total_latency_us": 33777}, {"doc_id": 13, "doc_len": 60754, "worker_id": 6, "attn_time_us": 41032.8203473475, "mlp_time_us": 27810.97412109375, "allgather_time_us": 334.8904800415039, "allreduce_time_us": 0, "total_latency_us": 69178}, {"doc_id": 14, "doc_len": 16561, "worker_id": 2, "attn_time_us": 3659.028983281592, "mlp_time_us": 7581.024169921875, "allgather_time_us": 91.28816604614258, "allreduce_time_us": 0, "total_latency_us": 11331}, {"doc_id": 15, "doc_len": 8227, "worker_id": 2, "attn_time_us": 1097.8835112388933, "mlp_time_us": 3766.021728515625, "allgather_time_us": 45.34917831420899, "allreduce_time_us": 0, "total_latency_us": 4909}, {"doc_id": 16, "doc_len": 32713, "worker_id": 5, "attn_time_us": 12815.289953603937, "mlp_time_us": 14974.822998046875, "allgather_time_us": 180.32182693481445, "allreduce_time_us": 0, "total_latency_us": 27970}, {"doc_id": 17, "doc_len": 7902, "worker_id": 1, "attn_time_us": 1030.5514032607039, "mlp_time_us": 3617.24853515625, "allgather_time_us": 43.55770111083985, "allreduce_time_us": 0, "total_latency_us": 4691}, {"doc_id": 18, "doc_len": 61207, "worker_id": 4, "attn_time_us": 41609.880796052974, "mlp_time_us": 28018.341064453125, "allgather_time_us": 337.38752365112305, "allreduce_time_us": 0, "total_latency_us": 69965}, {"doc_id": 19, "doc_len": 23509, "worker_id": 2, "attn_time_us": 6974.633960633525, "mlp_time_us": 10761.566162109375, "allgather_time_us": 129.58719253540042, "allreduce_time_us": 0, "total_latency_us": 17865}, {"doc_id": 20, "doc_len": 70502, "worker_id": 3, "attn_time_us": 54529.65612087477, "mlp_time_us": 32273.25439453125, "allgather_time_us": 388.62377166748047, "allreduce_time_us": 0, "total_latency_us": 87191}, {"doc_id": 21, "doc_len": 17053, "worker_id": 1, "attn_time_us": 3861.687159657393, "mlp_time_us": 7806.243896484375, "allgather_time_us": 94.00018692016603, "allreduce_time_us": 0, "total_latency_us": 11761}, {"doc_id": 22, "doc_len": 54571, "worker_id": 2, "attn_time_us": 33535.25864606387, "mlp_time_us": 24980.621337890625, "allgather_time_us": 300.8083152770996, "allreduce_time_us": 0, "total_latency_us": 58816}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 60091.03072139219, "mlp_time_us": 33927.154541015625, "allgather_time_us": 408.5394859313965, "allreduce_time_us": 0, "total_latency_us": 94426}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 32977.14326381794, "mlp_time_us": 24758.60595703125, "allgather_time_us": 298.13488006591797, "allreduce_time_us": 0, "total_latency_us": 58033}, {"doc_id": 25, "doc_len": 8083, "worker_id": 1, "attn_time_us": 1067.4346162359816, "mlp_time_us": 3700.103759765625, "allgather_time_us": 44.55541610717774, "allreduce_time_us": 0, "total_latency_us": 4812}, {"doc_id": 26, "doc_len": 14760, "worker_id": 1, "attn_time_us": 2998.1637265447894, "mlp_time_us": 6756.591796875, "allgather_time_us": 81.36062622070312, "allreduce_time_us": 0, "total_latency_us": 9836}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 1142.5237180096021, "mlp_time_us": 3854.3701171875, "allgather_time_us": 46.41304016113281, "allreduce_time_us": 0, "total_latency_us": 5043}, {"doc_id": 28, "doc_len": 8823, "worker_id": 15, "attn_time_us": 1238.1216148035858, "mlp_time_us": 4038.848876953125, "allgather_time_us": 48.63447189331055, "allreduce_time_us": 0, "total_latency_us": 5325}, {"doc_id": 29, "doc_len": 29953, "worker_id": 11, "attn_time_us": 10895.36607789976, "mlp_time_us": 13711.395263671875, "allgather_time_us": 165.10805130004883, "allreduce_time_us": 0, "total_latency_us": 24771}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 41060.75819853837, "mlp_time": 27821.044921875, "allgather_time": 335.0117492675781, "allreduce_time": 0}, "1": {"doc_len": 15258, "attn_time": 3174.131171513787, "mlp_time": 6984.55810546875, "allgather_time": 84.10572052001953, "allreduce_time": 0}, "2": {"doc_len": 46893, "attn_time": 25217.388191110786, "mlp_time": 21465.911865234375, "allgather_time": 258.4853553771973, "allreduce_time": 0}, "3": {"doc_len": 33216, "attn_time": 13187.381699075595, "mlp_time": 15205.078125, "allgather_time": 183.094482421875, "allreduce_time": 0}, "4": {"doc_len": 7431, "attn_time": 936.7605039870645, "mlp_time": 3401.641845703125, "allgather_time": 40.9614372253418, "allreduce_time": 0}, "5": {"doc_len": 70786, "attn_time": 54957.31271079316, "mlp_time": 32403.25927734375, "allgather_time": 390.18924713134766, "allreduce_time": 0}, "6": {"doc_len": 64608, "attn_time": 46062.47950230927, "mlp_time": 29575.1953125, "allgather_time": 356.1346435546875, "allreduce_time": 0}, "7": {"doc_len": 57240, "attn_time": 36684.902979857055, "mlp_time": 26202.392578125, "allgather_time": 315.5204772949219, "allreduce_time": 0}, "8": {"doc_len": 9138, "attn_time": 1315.0686957301634, "mlp_time": 4183.04443359375, "allgather_time": 50.370826721191406, "allreduce_time": 0}, "9": {"doc_len": 14084, "attn_time": 2766.0546109235556, "mlp_time": 6447.1435546875, "allgather_time": 77.63435363769531, "allreduce_time": 0}, "10": {"doc_len": 13958, "attn_time": 2723.6589452311337, "mlp_time": 6389.46533203125, "allgather_time": 76.93981170654297, "allreduce_time": 0}, "11": {"doc_len": 66573, "attn_time": 48779.82363302771, "mlp_time": 30474.700927734375, "allgather_time": 366.96619033813477, "allreduce_time": 0}, "12": {"doc_len": 37376, "attn_time": 16462.55225945504, "mlp_time": 17109.375, "allgather_time": 206.025390625, "allreduce_time": 0}, "13": {"doc_len": 60754, "attn_time": 41032.8203473475, "mlp_time": 27810.97412109375, "allgather_time": 334.8904800415039, "allreduce_time": 0}, "14": {"doc_len": 16561, "attn_time": 3659.028983281592, "mlp_time": 7581.024169921875, "allgather_time": 91.28816604614258, "allreduce_time": 0}, "15": {"doc_len": 8227, "attn_time": 1097.8835112388933, "mlp_time": 3766.021728515625, "allgather_time": 45.34917831420899, "allreduce_time": 0}, "16": {"doc_len": 32713, "attn_time": 12815.289953603937, "mlp_time": 14974.822998046875, "allgather_time": 180.32182693481445, "allreduce_time": 0}, "17": {"doc_len": 7902, "attn_time": 1030.5514032607039, "mlp_time": 3617.24853515625, "allgather_time": 43.55770111083985, "allreduce_time": 0}, "18": {"doc_len": 61207, "attn_time": 41609.880796052974, "mlp_time": 28018.341064453125, "allgather_time": 337.38752365112305, "allreduce_time": 0}, "19": {"doc_len": 23509, "attn_time": 6974.633960633525, "mlp_time": 10761.566162109375, "allgather_time": 129.58719253540042, "allreduce_time": 0}, "20": {"doc_len": 70502, "attn_time": 54529.65612087477, "mlp_time": 32273.25439453125, "allgather_time": 388.62377166748047, "allreduce_time": 0}, "21": {"doc_len": 17053, "attn_time": 3861.687159657393, "mlp_time": 7806.243896484375, "allgather_time": 94.00018692016603, "allreduce_time": 0}, "22": {"doc_len": 54571, "attn_time": 33535.25864606387, "mlp_time": 24980.621337890625, "allgather_time": 300.8083152770996, "allreduce_time": 0}, "23": {"doc_len": 74115, "attn_time": 60091.03072139219, "mlp_time": 33927.154541015625, "allgather_time": 408.5394859313965, "allreduce_time": 0}, "24": {"doc_len": 54086, "attn_time": 32977.14326381794, "mlp_time": 24758.60595703125, "allgather_time": 298.13488006591797, "allreduce_time": 0}, "25": {"doc_len": 8083, "attn_time": 1067.4346162359816, "mlp_time": 3700.103759765625, "allgather_time": 44.55541610717774, "allreduce_time": 0}, "26": {"doc_len": 14760, "attn_time": 2998.1637265447894, "mlp_time": 6756.591796875, "allgather_time": 81.36062622070312, "allreduce_time": 0}, "27": {"doc_len": 8420, "attn_time": 1142.5237180096021, "mlp_time": 3854.3701171875, "allgather_time": 46.41304016113281, "allreduce_time": 0}, "28": {"doc_len": 8823, "attn_time": 1238.1216148035858, "mlp_time": 4038.848876953125, "allgather_time": 48.63447189331055, "allreduce_time": 0}, "29": {"doc_len": 29953, "attn_time": 10895.36607789976, "mlp_time": 13711.395263671875, "allgather_time": 165.10805130004883, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 67918.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 1, "mlp_cp": 4}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 8, "dp": 8, "ratio": 0.9623248367031753, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 70577, "worker_latencies_us": [70566, 70568, 70577, 70437, 69226, 70560, 70573, 70573], "doc2worker": {"0": 7, "1": 6, "2": 6, "3": 5, "4": 7, "5": 3, "6": 4, "7": 2, "8": 0, "9": 1, "10": 5, "11": 6, "12": 3, "13": 2, "14": 5, "15": 3, "16": 1, "17": 2, "18": 1, "19": 1, "20": 5, "21": 0, "22": 4, "23": 0, "24": 7, "25": 1, "26": 3, "27": 7, "28": 1, "29": 0}, "latency_breakdown": {"max_worker_latency_us": 70577, "worker_latencies_us": [70566, 70568, 70577, 70437, 69226, 70560, 70573, 70573], "solver_status": "OPTIMAL", "solved_time_s": 7.8927836418151855, "num_vars": 249, "num_cons": 54}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [8, 21, 23, 29], "total_batch_length": 130259, "total_latency_us": 70566, "mlp_cost_us": 29813.919067382812, "attn_cost_us": 39950.19138761793, "allreduce_cost_us": 0, "allgather_cost_us": 803.4230065345764}, {"worker_id": 1, "assigned_docs": [9, 16, 18, 19, 25, 28], "total_batch_length": 148419, "total_latency_us": 70568, "mlp_cost_us": 33970.41320800781, "attn_cost_us": 35685.152499263975, "allreduce_cost_us": 0, "allgather_cost_us": 915.4318642616272}, {"worker_id": 2, "assigned_docs": [7, 13, 17], "total_batch_length": 125896, "total_latency_us": 70577, "mlp_cost_us": 28815.3076171875, "attn_cost_us": 40986.571673685066, "allreduce_cost_us": 0, "allgather_cost_us": 776.512508392334}, {"worker_id": 3, "assigned_docs": [5, 12, 15, 26], "total_batch_length": 131149, "total_latency_us": 70437, "mlp_cost_us": 30017.623901367188, "attn_cost_us": 39612.84465926893, "allreduce_cost_us": 0, "allgather_cost_us": 808.9124274253845}, {"worker_id": 4, "assigned_docs": [6, 22], "total_batch_length": 119179, "total_latency_us": 69226, "mlp_cost_us": 27277.908325195312, "attn_cost_us": 41213.56978946937, "allreduce_cost_us": 0, "allgather_cost_us": 735.0828003883362}, {"worker_id": 5, "assigned_docs": [3, 10, 14, 20], "total_batch_length": 134237, "total_latency_us": 70560, "mlp_cost_us": 30724.411010742188, "attn_cost_us": 39009.74048408964, "allreduce_cost_us": 0, "allgather_cost_us": 827.9588675498962}, {"worker_id": 6, "assigned_docs": [1, 2, 11], "total_batch_length": 128724, "total_latency_us": 70573, "mlp_cost_us": 29462.58544921875, "attn_cost_us": 40317.84224952885, "allreduce_cost_us": 0, "allgather_cost_us": 793.9552974700928}, {"worker_id": 7, "assigned_docs": [0, 4, 24, 27], "total_batch_length": 130713, "total_latency_us": 70573, "mlp_cost_us": 29917.831420898438, "attn_cost_us": 39850.6303172354, "allreduce_cost_us": 0, "allgather_cost_us": 806.2232279777527}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 7, "attn_time_us": 21241.014091373523, "mlp_time_us": 13910.5224609375, "allgather_time_us": 374.8596000671387, "allreduce_time_us": 0, "total_latency_us": 35526}, {"doc_id": 1, "doc_len": 15258, "worker_id": 6, "attn_time_us": 1915.1914168422336, "mlp_time_us": 3492.279052734375, "allgather_time_us": 94.10964488983154, "allreduce_time_us": 0, "total_latency_us": 5501}, {"doc_id": 2, "doc_len": 46893, "worker_id": 6, "attn_time_us": 13344.582002024277, "mlp_time_us": 10732.955932617188, "allgather_time_us": 289.23080205917364, "allreduce_time_us": 0, "total_latency_us": 24366}, {"doc_id": 3, "doc_len": 33216, "worker_id": 5, "attn_time_us": 7192.338855149916, "mlp_time_us": 7602.5390625, "allgather_time_us": 204.87258911132812, "allreduce_time_us": 0, "total_latency_us": 14999}, {"doc_id": 4, "doc_len": 7431, "worker_id": 7, "attn_time_us": 626.3276518203354, "mlp_time_us": 1700.8209228515625, "allgather_time_us": 45.833580493927, "allreduce_time_us": 0, "total_latency_us": 2372}, {"doc_id": 5, "doc_len": 70786, "worker_id": 3, "attn_time_us": 28187.025783038433, "mlp_time_us": 16201.629638671875, "allgather_time_us": 436.60016536712646, "allreduce_time_us": 0, "total_latency_us": 44825}, {"doc_id": 6, "doc_len": 64608, "worker_id": 4, "attn_time_us": 23701.271031884517, "mlp_time_us": 14787.59765625, "allgather_time_us": 398.4949493408203, "allreduce_time_us": 0, "total_latency_us": 38887}, {"doc_id": 7, "doc_len": 57240, "worker_id": 2, "attn_time_us": 19077.17035062242, "mlp_time_us": 13101.1962890625, "allgather_time_us": 353.0499458312988, "allreduce_time_us": 0, "total_latency_us": 32531}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 852.3071842875656, "mlp_time_us": 2091.522216796875, "allgather_time_us": 56.36216640472412, "allreduce_time_us": 0, "total_latency_us": 3000}, {"doc_id": 9, "doc_len": 14084, "worker_id": 1, "attn_time_us": 1687.7141576748552, "mlp_time_us": 3223.57177734375, "allgather_time_us": 86.86854362487793, "allreduce_time_us": 0, "total_latency_us": 4998}, {"doc_id": 10, "doc_len": 13958, "worker_id": 5, "attn_time_us": 1663.9310761996107, "mlp_time_us": 3194.732666015625, "allgather_time_us": 86.0913896560669, "allreduce_time_us": 0, "total_latency_us": 4944}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 25058.068830662334, "mlp_time_us": 15237.350463867188, "allgather_time_us": 410.61485052108765, "allreduce_time_us": 0, "total_latency_us": 40706}, {"doc_id": 12, "doc_len": 37376, "worker_id": 3, "attn_time_us": 8886.35889112473, "mlp_time_us": 8554.6875, "allgather_time_us": 230.531005859375, "allreduce_time_us": 0, "total_latency_us": 17671}, {"doc_id": 13, "doc_len": 60754, "worker_id": 2, "attn_time_us": 21227.234238743426, "mlp_time_us": 13905.487060546875, "allgather_time_us": 374.7239065170288, "allreduce_time_us": 0, "total_latency_us": 35507}, {"doc_id": 14, "doc_len": 16561, "worker_id": 5, "attn_time_us": 2182.9009934264054, "mlp_time_us": 3790.5120849609375, "allgather_time_us": 102.14640378952026, "allreduce_time_us": 0, "total_latency_us": 6075}, {"doc_id": 15, "doc_len": 8227, "worker_id": 3, "attn_time_us": 722.0491604597373, "mlp_time_us": 1883.0108642578125, "allgather_time_us": 50.74321985244752, "allreduce_time_us": 0, "total_latency_us": 2655}, {"doc_id": 16, "doc_len": 32713, "worker_id": 1, "attn_time_us": 6999.237908631909, "mlp_time_us": 7487.4114990234375, "allgather_time_us": 201.77014112472534, "allreduce_time_us": 0, "total_latency_us": 14688}, {"doc_id": 17, "doc_len": 7902, "worker_id": 2, "attn_time_us": 682.1670843192198, "mlp_time_us": 1808.624267578125, "allgather_time_us": 48.738656044006355, "allreduce_time_us": 0, "total_latency_us": 2539}, {"doc_id": 18, "doc_len": 61207, "worker_id": 1, "attn_time_us": 21511.770923634973, "mlp_time_us": 14009.170532226562, "allgather_time_us": 377.5179600715637, "allreduce_time_us": 0, "total_latency_us": 35898}, {"doc_id": 19, "doc_len": 23509, "worker_id": 1, "attn_time_us": 3976.0785151761893, "mlp_time_us": 5380.7830810546875, "allgather_time_us": 145.00089406967166, "allreduce_time_us": 0, "total_latency_us": 9501}, {"doc_id": 20, "doc_len": 70502, "worker_id": 5, "attn_time_us": 27970.56955931371, "mlp_time_us": 16136.627197265625, "allgather_time_us": 434.84848499298096, "allreduce_time_us": 0, "total_latency_us": 44542}, {"doc_id": 21, "doc_len": 17053, "worker_id": 0, "attn_time_us": 2295.071118188579, "mlp_time_us": 3903.1219482421875, "allgather_time_us": 105.18100500106813, "allreduce_time_us": 0, "total_latency_us": 6303}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 17512.298757584853, "mlp_time_us": 12490.310668945312, "allgather_time_us": 336.58785104751587, "allreduce_time_us": 0, "total_latency_us": 30339}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 30783.743722211268, "mlp_time_us": 16963.577270507812, "allgather_time_us": 457.1330666542053, "allreduce_time_us": 0, "total_latency_us": 48204}, {"doc_id": 24, "doc_len": 54086, "worker_id": 7, "attn_time_us": 17234.307529552974, "mlp_time_us": 12379.302978515625, "allgather_time_us": 333.5964250564575, "allreduce_time_us": 0, "total_latency_us": 29947}, {"doc_id": 25, "doc_len": 8083, "worker_id": 1, "attn_time_us": 703.9772792169063, "mlp_time_us": 1850.0518798828125, "allgather_time_us": 49.85504388809205, "allreduce_time_us": 0, "total_latency_us": 2603}, {"doc_id": 26, "doc_len": 14760, "worker_id": 3, "attn_time_us": 1817.4108246460232, "mlp_time_us": 3378.2958984375, "allgather_time_us": 91.03803634643555, "allreduce_time_us": 0, "total_latency_us": 5286}, {"doc_id": 27, "doc_len": 8420, "worker_id": 7, "attn_time_us": 748.981044488576, "mlp_time_us": 1927.18505859375, "allgather_time_us": 51.93362236022949, "allreduce_time_us": 0, "total_latency_us": 2728}, {"doc_id": 28, "doc_len": 8823, "worker_id": 1, "attn_time_us": 806.3737149291395, "mlp_time_us": 2019.4244384765625, "allgather_time_us": 54.41928148269653, "allreduce_time_us": 0, "total_latency_us": 2880}, {"doc_id": 29, "doc_len": 29953, "worker_id": 0, "attn_time_us": 6019.069362930521, "mlp_time_us": 6855.6976318359375, "allgather_time_us": 184.74676847457886, "allreduce_time_us": 0, "total_latency_us": 13059}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 21241.014091373523, "mlp_time": 13910.5224609375, "allgather_time": 374.8596000671387, "allreduce_time": 0}, "1": {"doc_len": 15258, "attn_time": 1915.1914168422336, "mlp_time": 3492.279052734375, "allgather_time": 94.10964488983154, "allreduce_time": 0}, "2": {"doc_len": 46893, "attn_time": 13344.582002024277, "mlp_time": 10732.955932617188, "allgather_time": 289.23080205917364, "allreduce_time": 0}, "3": {"doc_len": 33216, "attn_time": 7192.338855149916, "mlp_time": 7602.5390625, "allgather_time": 204.87258911132812, "allreduce_time": 0}, "4": {"doc_len": 7431, "attn_time": 626.3276518203354, "mlp_time": 1700.8209228515625, "allgather_time": 45.833580493927, "allreduce_time": 0}, "5": {"doc_len": 70786, "attn_time": 28187.025783038433, "mlp_time": 16201.629638671875, "allgather_time": 436.60016536712646, "allreduce_time": 0}, "6": {"doc_len": 64608, "attn_time": 23701.271031884517, "mlp_time": 14787.59765625, "allgather_time": 398.4949493408203, "allreduce_time": 0}, "7": {"doc_len": 57240, "attn_time": 19077.17035062242, "mlp_time": 13101.1962890625, "allgather_time": 353.0499458312988, "allreduce_time": 0}, "8": {"doc_len": 9138, "attn_time": 852.3071842875656, "mlp_time": 2091.522216796875, "allgather_time": 56.36216640472412, "allreduce_time": 0}, "9": {"doc_len": 14084, "attn_time": 1687.7141576748552, "mlp_time": 3223.57177734375, "allgather_time": 86.86854362487793, "allreduce_time": 0}, "10": {"doc_len": 13958, "attn_time": 1663.9310761996107, "mlp_time": 3194.732666015625, "allgather_time": 86.0913896560669, "allreduce_time": 0}, "11": {"doc_len": 66573, "attn_time": 25058.068830662334, "mlp_time": 15237.350463867188, "allgather_time": 410.61485052108765, "allreduce_time": 0}, "12": {"doc_len": 37376, "attn_time": 8886.35889112473, "mlp_time": 8554.6875, "allgather_time": 230.531005859375, "allreduce_time": 0}, "13": {"doc_len": 60754, "attn_time": 21227.234238743426, "mlp_time": 13905.487060546875, "allgather_time": 374.7239065170288, "allreduce_time": 0}, "14": {"doc_len": 16561, "attn_time": 2182.9009934264054, "mlp_time": 3790.5120849609375, "allgather_time": 102.14640378952026, "allreduce_time": 0}, "15": {"doc_len": 8227, "attn_time": 722.0491604597373, "mlp_time": 1883.0108642578125, "allgather_time": 50.74321985244752, "allreduce_time": 0}, "16": {"doc_len": 32713, "attn_time": 6999.237908631909, "mlp_time": 7487.4114990234375, "allgather_time": 201.77014112472534, "allreduce_time": 0}, "17": {"doc_len": 7902, "attn_time": 682.1670843192198, "mlp_time": 1808.624267578125, "allgather_time": 48.738656044006355, "allreduce_time": 0}, "18": {"doc_len": 61207, "attn_time": 21511.770923634973, "mlp_time": 14009.170532226562, "allgather_time": 377.5179600715637, "allreduce_time": 0}, "19": {"doc_len": 23509, "attn_time": 3976.0785151761893, "mlp_time": 5380.7830810546875, "allgather_time": 145.00089406967166, "allreduce_time": 0}, "20": {"doc_len": 70502, "attn_time": 27970.56955931371, "mlp_time": 16136.627197265625, "allgather_time": 434.84848499298096, "allreduce_time": 0}, "21": {"doc_len": 17053, "attn_time": 2295.071118188579, "mlp_time": 3903.1219482421875, "allgather_time": 105.18100500106813, "allreduce_time": 0}, "22": {"doc_len": 54571, "attn_time": 17512.298757584853, "mlp_time": 12490.310668945312, "allgather_time": 336.58785104751587, "allreduce_time": 0}, "23": {"doc_len": 74115, "attn_time": 30783.743722211268, "mlp_time": 16963.577270507812, "allgather_time": 457.1330666542053, "allreduce_time": 0}, "24": {"doc_len": 54086, "attn_time": 17234.307529552974, "mlp_time": 12379.302978515625, "allgather_time": 333.5964250564575, "allreduce_time": 0}, "25": {"doc_len": 8083, "attn_time": 703.9772792169063, "mlp_time": 1850.0518798828125, "allgather_time": 49.85504388809205, "allreduce_time": 0}, "26": {"doc_len": 14760, "attn_time": 1817.4108246460232, "mlp_time": 3378.2958984375, "allgather_time": 91.03803634643555, "allreduce_time": 0}, "27": {"doc_len": 8420, "attn_time": 748.981044488576, "mlp_time": 1927.18505859375, "allgather_time": 51.93362236022949, "allreduce_time": 0}, "28": {"doc_len": 8823, "attn_time": 806.3737149291395, "mlp_time": 2019.4244384765625, "allgather_time": 54.41928148269653, "allreduce_time": 0}, "29": {"doc_len": 29953, "attn_time": 6019.069362930521, "mlp_time": 6855.6976318359375, "allgather_time": 184.74676847457886, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 67918.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 1, "mlp_cp": 8}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 1, "dp": 32, "ratio": 0.3579005329704009, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 192506, "worker_latencies_us": [0, 0, 48046, 10091, 9558, 18739, 9118, 115695, 192506, 117319, 22483, 177023, 34357, 140576, 8886, 54468, 9304, 21653, 138926, 66103, 160918, 17485, 17680, 10513, 126439, 153248, 178217, 8287, 55677, 92835, 19530, 139006], "doc2worker": {"0": 31, "1": 30, "2": 29, "3": 28, "4": 27, "5": 26, "6": 25, "7": 24, "8": 23, "9": 22, "10": 21, "11": 20, "12": 19, "13": 18, "14": 17, "15": 16, "16": 15, "17": 14, "18": 13, "19": 12, "20": 11, "21": 10, "22": 9, "23": 8, "24": 7, "25": 6, "26": 5, "27": 4, "28": 3, "29": 2}, "latency_breakdown": {"max_worker_latency_us": 192506, "worker_latencies_us": [0, 0, 48046, 10091, 9558, 18739, 9118, 115695, 192506, 117319, 22483, 177023, 34357, 140576, 8886, 54468, 9304, 21653, 138926, 66103, 160918, 17485, 17680, 10513, 126439, 153248, 178217, 8287, 55677, 92835, 19530, 139006], "solver_status": "OPTIMAL", "solved_time_s": 0.018996238708496094, "num_vars": 993, "num_cons": 126}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [29], "total_batch_length": 29953, "total_latency_us": 48046, "mlp_cost_us": 27422.79052734375, "attn_cost_us": 20167.630939180402, "allreduce_cost_us": 455.7235592731879, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [28], "total_batch_length": 8823, "total_latency_us": 10091, "mlp_cost_us": 8077.69775390625, "attn_cost_us": 1834.6416189432853, "allreduce_cost_us": 179.32812397160214, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [27], "total_batch_length": 8420, "total_latency_us": 9558, "mlp_cost_us": 7708.740234375, "attn_cost_us": 1675.930921883661, "allreduce_cost_us": 173.3930081849844, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [26], "total_batch_length": 14760, "total_latency_us": 18739, "mlp_cost_us": 13513.18359375, "attn_cost_us": 4966.353702126039, "allreduce_cost_us": 259.7303763431473, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [25], "total_batch_length": 8083, "total_latency_us": 9118, "mlp_cost_us": 7400.20751953125, "attn_cost_us": 1550.222724431095, "allreduce_cost_us": 168.26567284520402, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [24], "total_batch_length": 54086, "total_latency_us": 115695, "mlp_cost_us": 49517.2119140625, "attn_cost_us": 65411.69103837542, "allreduce_cost_us": 766.5888992822663, "allgather_cost_us": 0}, {"worker_id": 8, "assigned_docs": [23], "total_batch_length": 74115, "total_latency_us": 192506, "mlp_cost_us": 67854.30908203125, "attn_cost_us": 123634.52424287876, "allreduce_cost_us": 1017.7996806179004, "allgather_cost_us": 0}, {"worker_id": 9, "assigned_docs": [22], "total_batch_length": 54571, "total_latency_us": 117319, "mlp_cost_us": 49961.24267578125, "attn_cost_us": 66585.1037663516, "allreduce_cost_us": 772.7251705065116, "allgather_cost_us": 0}, {"worker_id": 10, "assigned_docs": [21], "total_batch_length": 17053, "total_latency_us": 22483, "mlp_cost_us": 15612.48779296875, "attn_cost_us": 6581.4998828649905, "allreduce_cost_us": 289.1948457524418, "allgather_cost_us": 0}, {"worker_id": 11, "assigned_docs": [20], "total_batch_length": 70502, "total_latency_us": 177023, "mlp_cost_us": 64546.5087890625, "attn_cost_us": 111504.60786684924, "allreduce_cost_us": 972.5452100109775, "allgather_cost_us": 0}, {"worker_id": 12, "assigned_docs": [19], "total_batch_length": 23509, "total_latency_us": 34357, "mlp_cost_us": 21523.13232421875, "attn_cost_us": 12459.791510871277, "allreduce_cost_us": 374.7682243346597, "allgather_cost_us": 0}, {"worker_id": 13, "assigned_docs": [18], "total_batch_length": 61207, "total_latency_us": 140576, "mlp_cost_us": 56036.68212890625, "attn_cost_us": 83683.34637517887, "allreduce_cost_us": 856.1220330237647, "allgather_cost_us": 0}, {"worker_id": 14, "assigned_docs": [17], "total_batch_length": 7902, "total_latency_us": 8886, "mlp_cost_us": 7234.4970703125, "attn_cost_us": 1486.4598286550738, "allreduce_cost_us": 165.37355732719422, "allgather_cost_us": 0}, {"worker_id": 15, "assigned_docs": [16], "total_batch_length": 32713, "total_latency_us": 54468, "mlp_cost_us": 29949.64599609375, "attn_cost_us": 24029.986359950555, "allreduce_cost_us": 489.3358845446602, "allgather_cost_us": 0}, {"worker_id": 16, "assigned_docs": [15], "total_batch_length": 8227, "total_latency_us": 9304, "mlp_cost_us": 7532.04345703125, "attn_cost_us": 1602.3828142042266, "allreduce_cost_us": 170.52255853118973, "allgather_cost_us": 0}, {"worker_id": 17, "assigned_docs": [14], "total_batch_length": 16561, "total_latency_us": 21653, "mlp_cost_us": 15162.04833984375, "attn_cost_us": 6209.400534133425, "allreduce_cost_us": 282.4396393393575, "allgather_cost_us": 0}, {"worker_id": 18, "assigned_docs": [13], "total_batch_length": 60754, "total_latency_us": 138926, "mlp_cost_us": 55621.9482421875, "attn_cost_us": 82454.34769705903, "allreduce_cost_us": 850.4609732267587, "allgather_cost_us": 0}, {"worker_id": 19, "assigned_docs": [12], "total_batch_length": 37376, "total_latency_us": 66103, "mlp_cost_us": 34218.75, "attn_cost_us": 31333.737259603335, "allreduce_cost_us": 551.0988729358676, "allgather_cost_us": 0}, {"worker_id": 20, "assigned_docs": [11], "total_batch_length": 66573, "total_latency_us": 160918, "mlp_cost_us": 60949.40185546875, "attn_cost_us": 99045.95441777358, "allreduce_cost_us": 923.094889626756, "allgather_cost_us": 0}, {"worker_id": 21, "assigned_docs": [10], "total_batch_length": 13958, "total_latency_us": 17485, "mlp_cost_us": 12778.9306640625, "attn_cost_us": 4457.389946423081, "allreduce_cost_us": 249.49157551066844, "allgather_cost_us": 0}, {"worker_id": 22, "assigned_docs": [9], "total_batch_length": 14084, "total_latency_us": 17680, "mlp_cost_us": 12894.287109375, "attn_cost_us": 4535.5905794069495, "allreduce_cost_us": 251.11086062313277, "allgather_cost_us": 0}, {"worker_id": 23, "assigned_docs": [8], "total_batch_length": 9138, "total_latency_us": 10513, "mlp_cost_us": 8366.0888671875, "attn_cost_us": 1963.521308105598, "allreduce_cost_us": 183.9144575988745, "allgather_cost_us": 0}, {"worker_id": 24, "assigned_docs": [7], "total_batch_length": 57240, "total_latency_us": 126439, "mlp_cost_us": 52404.78515625, "attn_cost_us": 73228.34917390783, "allreduce_cost_us": 806.3908572133528, "allgather_cost_us": 0}, {"worker_id": 25, "assigned_docs": [6], "total_batch_length": 64608, "total_latency_us": 153248, "mlp_cost_us": 59150.390625, "attn_cost_us": 93199.423940683, "allreduce_cost_us": 898.483182476601, "allgather_cost_us": 0}, {"worker_id": 26, "assigned_docs": [5], "total_batch_length": 70786, "total_latency_us": 178217, "mlp_cost_us": 64806.5185546875, "attn_cost_us": 112434.68945129575, "allreduce_cost_us": 976.1098620851685, "allgather_cost_us": 0}, {"worker_id": 27, "assigned_docs": [4], "total_batch_length": 7431, "total_latency_us": 8287, "mlp_cost_us": 6803.28369140625, "attn_cost_us": 1326.3391830572828, "allreduce_cost_us": 157.77352430564432, "allgather_cost_us": 0}, {"worker_id": 28, "assigned_docs": [3], "total_batch_length": 33216, "total_latency_us": 55677, "mlp_cost_us": 30410.15625, "attn_cost_us": 24771.332764314247, "allreduce_cost_us": 495.9786195646589, "allgather_cost_us": 0}, {"worker_id": 29, "assigned_docs": [2], "total_batch_length": 46893, "total_latency_us": 92835, "mlp_cost_us": 42931.82373046875, "attn_cost_us": 49228.8283206606, "allreduce_cost_us": 674.8572955732859, "allgather_cost_us": 0}, {"worker_id": 30, "assigned_docs": [1], "total_batch_length": 15258, "total_latency_us": 19530, "mlp_cost_us": 13969.1162109375, "attn_cost_us": 5295.757035542673, "allreduce_cost_us": 266.00958874864097, "allgather_cost_us": 0}, {"worker_id": 31, "assigned_docs": [0], "total_batch_length": 60776, "total_latency_us": 139006, "mlp_cost_us": 55642.08984375, "attn_cost_us": 82513.82500039978, "allreduce_cost_us": 850.7360072887997, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 31, "attn_time_us": 82513.82500039978, "mlp_time_us": 55642.08984375, "allgather_time_us": 0, "allreduce_time_us": 850.7360072887997, "total_latency_us": 139006}, {"doc_id": 1, "doc_len": 15258, "worker_id": 30, "attn_time_us": 5295.757035542673, "mlp_time_us": 13969.1162109375, "allgather_time_us": 0, "allreduce_time_us": 266.00958874864097, "total_latency_us": 19530}, {"doc_id": 2, "doc_len": 46893, "worker_id": 29, "attn_time_us": 49228.8283206606, "mlp_time_us": 42931.82373046875, "allgather_time_us": 0, "allreduce_time_us": 674.8572955732859, "total_latency_us": 92835}, {"doc_id": 3, "doc_len": 33216, "worker_id": 28, "attn_time_us": 24771.332764314247, "mlp_time_us": 30410.15625, "allgather_time_us": 0, "allreduce_time_us": 495.9786195646589, "total_latency_us": 55677}, {"doc_id": 4, "doc_len": 7431, "worker_id": 27, "attn_time_us": 1326.3391830572828, "mlp_time_us": 6803.28369140625, "allgather_time_us": 0, "allreduce_time_us": 157.77352430564432, "total_latency_us": 8287}, {"doc_id": 5, "doc_len": 70786, "worker_id": 26, "attn_time_us": 112434.68945129575, "mlp_time_us": 64806.5185546875, "allgather_time_us": 0, "allreduce_time_us": 976.1098620851685, "total_latency_us": 178217}, {"doc_id": 6, "doc_len": 64608, "worker_id": 25, "attn_time_us": 93199.423940683, "mlp_time_us": 59150.390625, "allgather_time_us": 0, "allreduce_time_us": 898.483182476601, "total_latency_us": 153248}, {"doc_id": 7, "doc_len": 57240, "worker_id": 24, "attn_time_us": 73228.34917390783, "mlp_time_us": 52404.78515625, "allgather_time_us": 0, "allreduce_time_us": 806.3908572133528, "total_latency_us": 126439}, {"doc_id": 8, "doc_len": 9138, "worker_id": 23, "attn_time_us": 1963.521308105598, "mlp_time_us": 8366.0888671875, "allgather_time_us": 0, "allreduce_time_us": 183.9144575988745, "total_latency_us": 10513}, {"doc_id": 9, "doc_len": 14084, "worker_id": 22, "attn_time_us": 4535.5905794069495, "mlp_time_us": 12894.287109375, "allgather_time_us": 0, "allreduce_time_us": 251.11086062313277, "total_latency_us": 17680}, {"doc_id": 10, "doc_len": 13958, "worker_id": 21, "attn_time_us": 4457.389946423081, "mlp_time_us": 12778.9306640625, "allgather_time_us": 0, "allreduce_time_us": 249.49157551066844, "total_latency_us": 17485}, {"doc_id": 11, "doc_len": 66573, "worker_id": 20, "attn_time_us": 99045.95441777358, "mlp_time_us": 60949.40185546875, "allgather_time_us": 0, "allreduce_time_us": 923.094889626756, "total_latency_us": 160918}, {"doc_id": 12, "doc_len": 37376, "worker_id": 19, "attn_time_us": 31333.737259603335, "mlp_time_us": 34218.75, "allgather_time_us": 0, "allreduce_time_us": 551.0988729358676, "total_latency_us": 66103}, {"doc_id": 13, "doc_len": 60754, "worker_id": 18, "attn_time_us": 82454.34769705903, "mlp_time_us": 55621.9482421875, "allgather_time_us": 0, "allreduce_time_us": 850.4609732267587, "total_latency_us": 138926}, {"doc_id": 14, "doc_len": 16561, "worker_id": 17, "attn_time_us": 6209.400534133425, "mlp_time_us": 15162.04833984375, "allgather_time_us": 0, "allreduce_time_us": 282.4396393393575, "total_latency_us": 21653}, {"doc_id": 15, "doc_len": 8227, "worker_id": 16, "attn_time_us": 1602.3828142042266, "mlp_time_us": 7532.04345703125, "allgather_time_us": 0, "allreduce_time_us": 170.52255853118973, "total_latency_us": 9304}, {"doc_id": 16, "doc_len": 32713, "worker_id": 15, "attn_time_us": 24029.986359950555, "mlp_time_us": 29949.64599609375, "allgather_time_us": 0, "allreduce_time_us": 489.3358845446602, "total_latency_us": 54468}, {"doc_id": 17, "doc_len": 7902, "worker_id": 14, "attn_time_us": 1486.4598286550738, "mlp_time_us": 7234.4970703125, "allgather_time_us": 0, "allreduce_time_us": 165.37355732719422, "total_latency_us": 8886}, {"doc_id": 18, "doc_len": 61207, "worker_id": 13, "attn_time_us": 83683.34637517887, "mlp_time_us": 56036.68212890625, "allgather_time_us": 0, "allreduce_time_us": 856.1220330237647, "total_latency_us": 140576}, {"doc_id": 19, "doc_len": 23509, "worker_id": 12, "attn_time_us": 12459.791510871277, "mlp_time_us": 21523.13232421875, "allgather_time_us": 0, "allreduce_time_us": 374.7682243346597, "total_latency_us": 34357}, {"doc_id": 20, "doc_len": 70502, "worker_id": 11, "attn_time_us": 111504.60786684924, "mlp_time_us": 64546.5087890625, "allgather_time_us": 0, "allreduce_time_us": 972.5452100109775, "total_latency_us": 177023}, {"doc_id": 21, "doc_len": 17053, "worker_id": 10, "attn_time_us": 6581.4998828649905, "mlp_time_us": 15612.48779296875, "allgather_time_us": 0, "allreduce_time_us": 289.1948457524418, "total_latency_us": 22483}, {"doc_id": 22, "doc_len": 54571, "worker_id": 9, "attn_time_us": 66585.1037663516, "mlp_time_us": 49961.24267578125, "allgather_time_us": 0, "allreduce_time_us": 772.7251705065116, "total_latency_us": 117319}, {"doc_id": 23, "doc_len": 74115, "worker_id": 8, "attn_time_us": 123634.52424287876, "mlp_time_us": 67854.30908203125, "allgather_time_us": 0, "allreduce_time_us": 1017.7996806179004, "total_latency_us": 192506}, {"doc_id": 24, "doc_len": 54086, "worker_id": 7, "attn_time_us": 65411.69103837542, "mlp_time_us": 49517.2119140625, "allgather_time_us": 0, "allreduce_time_us": 766.5888992822663, "total_latency_us": 115695}, {"doc_id": 25, "doc_len": 8083, "worker_id": 6, "attn_time_us": 1550.222724431095, "mlp_time_us": 7400.20751953125, "allgather_time_us": 0, "allreduce_time_us": 168.26567284520402, "total_latency_us": 9118}, {"doc_id": 26, "doc_len": 14760, "worker_id": 5, "attn_time_us": 4966.353702126039, "mlp_time_us": 13513.18359375, "allgather_time_us": 0, "allreduce_time_us": 259.7303763431473, "total_latency_us": 18739}, {"doc_id": 27, "doc_len": 8420, "worker_id": 4, "attn_time_us": 1675.930921883661, "mlp_time_us": 7708.740234375, "allgather_time_us": 0, "allreduce_time_us": 173.3930081849844, "total_latency_us": 9558}, {"doc_id": 28, "doc_len": 8823, "worker_id": 3, "attn_time_us": 1834.6416189432853, "mlp_time_us": 8077.69775390625, "allgather_time_us": 0, "allreduce_time_us": 179.32812397160214, "total_latency_us": 10091}, {"doc_id": 29, "doc_len": 29953, "worker_id": 2, "attn_time_us": 20167.630939180402, "mlp_time_us": 27422.79052734375, "allgather_time_us": 0, "allreduce_time_us": 455.7235592731879, "total_latency_us": 48046}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 82513.82500039978, "mlp_time": 55642.08984375, "allgather_time": 0, "allreduce_time": 850.7360072887997}, "1": {"doc_len": 15258, "attn_time": 5295.757035542673, "mlp_time": 13969.1162109375, "allgather_time": 0, "allreduce_time": 266.00958874864097}, "2": {"doc_len": 46893, "attn_time": 49228.8283206606, "mlp_time": 42931.82373046875, "allgather_time": 0, "allreduce_time": 674.8572955732859}, "3": {"doc_len": 33216, "attn_time": 24771.332764314247, "mlp_time": 30410.15625, "allgather_time": 0, "allreduce_time": 495.9786195646589}, "4": {"doc_len": 7431, "attn_time": 1326.3391830572828, "mlp_time": 6803.28369140625, "allgather_time": 0, "allreduce_time": 157.77352430564432}, "5": {"doc_len": 70786, "attn_time": 112434.68945129575, "mlp_time": 64806.5185546875, "allgather_time": 0, "allreduce_time": 976.1098620851685}, "6": {"doc_len": 64608, "attn_time": 93199.423940683, "mlp_time": 59150.390625, "allgather_time": 0, "allreduce_time": 898.483182476601}, "7": {"doc_len": 57240, "attn_time": 73228.34917390783, "mlp_time": 52404.78515625, "allgather_time": 0, "allreduce_time": 806.3908572133528}, "8": {"doc_len": 9138, "attn_time": 1963.521308105598, "mlp_time": 8366.0888671875, "allgather_time": 0, "allreduce_time": 183.9144575988745}, "9": {"doc_len": 14084, "attn_time": 4535.5905794069495, "mlp_time": 12894.287109375, "allgather_time": 0, "allreduce_time": 251.11086062313277}, "10": {"doc_len": 13958, "attn_time": 4457.389946423081, "mlp_time": 12778.9306640625, "allgather_time": 0, "allreduce_time": 249.49157551066844}, "11": {"doc_len": 66573, "attn_time": 99045.95441777358, "mlp_time": 60949.40185546875, "allgather_time": 0, "allreduce_time": 923.094889626756}, "12": {"doc_len": 37376, "attn_time": 31333.737259603335, "mlp_time": 34218.75, "allgather_time": 0, "allreduce_time": 551.0988729358676}, "13": {"doc_len": 60754, "attn_time": 82454.34769705903, "mlp_time": 55621.9482421875, "allgather_time": 0, "allreduce_time": 850.4609732267587}, "14": {"doc_len": 16561, "attn_time": 6209.400534133425, "mlp_time": 15162.04833984375, "allgather_time": 0, "allreduce_time": 282.4396393393575}, "15": {"doc_len": 8227, "attn_time": 1602.3828142042266, "mlp_time": 7532.04345703125, "allgather_time": 0, "allreduce_time": 170.52255853118973}, "16": {"doc_len": 32713, "attn_time": 24029.986359950555, "mlp_time": 29949.64599609375, "allgather_time": 0, "allreduce_time": 489.3358845446602}, "17": {"doc_len": 7902, "attn_time": 1486.4598286550738, "mlp_time": 7234.4970703125, "allgather_time": 0, "allreduce_time": 165.37355732719422}, "18": {"doc_len": 61207, "attn_time": 83683.34637517887, "mlp_time": 56036.68212890625, "allgather_time": 0, "allreduce_time": 856.1220330237647}, "19": {"doc_len": 23509, "attn_time": 12459.791510871277, "mlp_time": 21523.13232421875, "allgather_time": 0, "allreduce_time": 374.7682243346597}, "20": {"doc_len": 70502, "attn_time": 111504.60786684924, "mlp_time": 64546.5087890625, "allgather_time": 0, "allreduce_time": 972.5452100109775}, "21": {"doc_len": 17053, "attn_time": 6581.4998828649905, "mlp_time": 15612.48779296875, "allgather_time": 0, "allreduce_time": 289.1948457524418}, "22": {"doc_len": 54571, "attn_time": 66585.1037663516, "mlp_time": 49961.24267578125, "allgather_time": 0, "allreduce_time": 772.7251705065116}, "23": {"doc_len": 74115, "attn_time": 123634.52424287876, "mlp_time": 67854.30908203125, "allgather_time": 0, "allreduce_time": 1017.7996806179004}, "24": {"doc_len": 54086, "attn_time": 65411.69103837542, "mlp_time": 49517.2119140625, "allgather_time": 0, "allreduce_time": 766.5888992822663}, "25": {"doc_len": 8083, "attn_time": 1550.222724431095, "mlp_time": 7400.20751953125, "allgather_time": 0, "allreduce_time": 168.26567284520402}, "26": {"doc_len": 14760, "attn_time": 4966.353702126039, "mlp_time": 13513.18359375, "allgather_time": 0, "allreduce_time": 259.7303763431473}, "27": {"doc_len": 8420, "attn_time": 1675.930921883661, "mlp_time": 7708.740234375, "allgather_time": 0, "allreduce_time": 173.3930081849844}, "28": {"doc_len": 8823, "attn_time": 1834.6416189432853, "mlp_time": 8077.69775390625, "allgather_time": 0, "allreduce_time": 179.32812397160214}, "29": {"doc_len": 29953, "attn_time": 20167.630939180402, "mlp_time": 27422.79052734375, "allgather_time": 0, "allreduce_time": 455.7235592731879}}}, "attnserver_result": {"batch_total_time": 68898.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 980.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 2, "mlp_cp": 1}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 2, "dp": 16, "ratio": 0.7418778323865449, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 94002, "worker_latencies_us": [94002, 93748, 92316, 86802, 69585, 70285, 78055, 84843, 62799, 75644, 87359, 28932, 28283, 51891, 10196, 68833], "doc2worker": {"0": 15, "1": 14, "2": 13, "3": 12, "4": 11, "5": 10, "6": 9, "7": 8, "8": 7, "9": 6, "10": 5, "11": 7, "12": 5, "13": 6, "14": 2, "15": 2, "16": 5, "17": 1, "18": 4, "19": 2, "20": 3, "21": 1, "22": 2, "23": 0, "24": 1, "25": 1, "26": 1, "27": 1, "28": 13, "29": 11}, "latency_breakdown": {"max_worker_latency_us": 94002, "worker_latencies_us": [94002, 93748, 92316, 86802, 69585, 70285, 78055, 84843, 62799, 75644, 87359, 28932, 28283, 51891, 10196, 68833], "solver_status": "OPTIMAL", "solved_time_s": 0.023009777069091797, "num_vars": 497, "num_cons": 78}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [23], "total_batch_length": 74115, "total_latency_us": 94002, "mlp_cost_us": 33927.154541015625, "attn_cost_us": 58874.74670188367, "allreduce_cost_us": 1017.7996806179004, "allgather_cost_us": 183.24197530746457}, {"worker_id": 1, "assigned_docs": [17, 21, 24, 25, 26, 27], "total_batch_length": 110304, "total_latency_us": 93748, "mlp_cost_us": 50493.1640625, "attn_cost_us": 41162.43460353132, "allreduce_cost_us": 1822.5463597352382, "allgather_cost_us": 272.71568298339844}, {"worker_id": 2, "assigned_docs": [14, 15, 19, 22], "total_batch_length": 102868, "total_latency_us": 92316, "mlp_cost_us": 47089.2333984375, "attn_cost_us": 43374.30843931581, "allreduce_cost_us": 1600.4555927117185, "allgather_cost_us": 254.3309116363525}, {"worker_id": 3, "assigned_docs": [20], "total_batch_length": 70502, "total_latency_us": 86802, "mlp_cost_us": 32273.25439453125, "attn_cost_us": 53382.75150437761, "allreduce_cost_us": 972.5452100109775, "allgather_cost_us": 174.3091917037964}, {"worker_id": 4, "assigned_docs": [18], "total_batch_length": 61207, "total_latency_us": 69585, "mlp_cost_us": 28018.341064453125, "attn_cost_us": 40559.63632514838, "allreduce_cost_us": 856.1220330237647, "allgather_cost_us": 151.328227519989}, {"worker_id": 5, "assigned_docs": [10, 12, 16], "total_batch_length": 84047, "total_latency_us": 70285, "mlp_cost_us": 38473.663330078125, "attn_cost_us": 30315.65429240931, "allreduce_cost_us": 1289.9263329911962, "allgather_cost_us": 207.79785871505737}, {"worker_id": 6, "assigned_docs": [9, 13], "total_batch_length": 74838, "total_latency_us": 78055, "mlp_cost_us": 34258.11767578125, "attn_cost_us": 42510.610130030545, "allreduce_cost_us": 1101.5718338498914, "allgather_cost_us": 185.02952098846436}, {"worker_id": 7, "assigned_docs": [8, 11], "total_batch_length": 75711, "total_latency_us": 84843, "mlp_cost_us": 34657.745361328125, "attn_cost_us": 48892.759032956135, "allreduce_cost_us": 1107.0093472256303, "allgather_cost_us": 187.18792676925656}, {"worker_id": 8, "assigned_docs": [7], "total_batch_length": 57240, "total_latency_us": 62799, "mlp_cost_us": 26202.392578125, "attn_cost_us": 35649.54816212674, "allreduce_cost_us": 806.3908572133528, "allgather_cost_us": 141.52021408081052}, {"worker_id": 9, "assigned_docs": [6], "total_batch_length": 64608, "total_latency_us": 75644, "mlp_cost_us": 29575.1953125, "attn_cost_us": 45011.031354778104, "allreduce_cost_us": 898.483182476601, "allgather_cost_us": 159.7368621826172}, {"worker_id": 10, "assigned_docs": [5], "total_batch_length": 70786, "total_latency_us": 87359, "mlp_cost_us": 32403.25927734375, "attn_cost_us": 53804.91323100491, "allreduce_cost_us": 976.1098620851685, "allgather_cost_us": 175.01135349273682}, {"worker_id": 11, "assigned_docs": [4, 29], "total_batch_length": 37384, "total_latency_us": 28932, "mlp_cost_us": 17113.037109375, "attn_cost_us": 11113.745724742334, "allreduce_cost_us": 613.4970835788322, "allgather_cost_us": 92.42822647094727}, {"worker_id": 12, "assigned_docs": [3], "total_batch_length": 33216, "total_latency_us": 28283, "mlp_cost_us": 15205.078125, "attn_cost_us": 12500.169524014229, "allreduce_cost_us": 495.9786195646589, "allgather_cost_us": 82.12326049804688}, {"worker_id": 13, "assigned_docs": [2, 28], "total_batch_length": 55716, "total_latency_us": 51891, "mlp_cost_us": 25504.7607421875, "attn_cost_us": 25395.81809669871, "allreduce_cost_us": 854.1854195448881, "allgather_cost_us": 137.75227546691895}, {"worker_id": 14, "assigned_docs": [1], "total_batch_length": 15258, "total_latency_us": 10196, "mlp_cost_us": 6984.55810546875, "attn_cost_us": 2908.098131727924, "allreduce_cost_us": 266.00958874864097, "allgather_cost_us": 37.72388935089111}, {"worker_id": 15, "assigned_docs": [0], "total_batch_length": 60776, "total_latency_us": 68833, "mlp_cost_us": 27821.044921875, "attn_cost_us": 40011.44061618633, "allreduce_cost_us": 850.7360072887997, "allgather_cost_us": 150.26262283325195}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 15, "attn_time_us": 40011.44061618633, "mlp_time_us": 27821.044921875, "allgather_time_us": 150.26262283325195, "allreduce_time_us": 850.7360072887997, "total_latency_us": 68833}, {"doc_id": 1, "doc_len": 15258, "worker_id": 14, "attn_time_us": 2908.098131727924, "mlp_time_us": 6984.55810546875, "allgather_time_us": 37.72388935089111, "allreduce_time_us": 266.00958874864097, "total_latency_us": 10196}, {"doc_id": 2, "doc_len": 46893, "worker_id": 13, "attn_time_us": 24283.23713124822, "mlp_time_us": 21465.911865234375, "allgather_time_us": 115.93828439712524, "allreduce_time_us": 674.8572955732859, "total_latency_us": 46539}, {"doc_id": 3, "doc_len": 33216, "worker_id": 12, "attn_time_us": 12500.169524014229, "mlp_time_us": 15205.078125, "allgather_time_us": 82.12326049804688, "allreduce_time_us": 495.9786195646589, "total_latency_us": 28283}, {"doc_id": 4, "doc_len": 7431, "worker_id": 11, "attn_time_us": 833.7780161518946, "mlp_time_us": 3401.641845703125, "allgather_time_us": 18.372409343719482, "allreduce_time_us": 157.77352430564432, "total_latency_us": 4411}, {"doc_id": 5, "doc_len": 70786, "worker_id": 10, "attn_time_us": 53804.91323100491, "mlp_time_us": 32403.25927734375, "allgather_time_us": 175.01135349273682, "allreduce_time_us": 976.1098620851685, "total_latency_us": 87359}, {"doc_id": 6, "doc_len": 64608, "worker_id": 9, "attn_time_us": 45011.031354778104, "mlp_time_us": 29575.1953125, "allgather_time_us": 159.7368621826172, "allreduce_time_us": 898.483182476601, "total_latency_us": 75644}, {"doc_id": 7, "doc_len": 57240, "worker_id": 8, "attn_time_us": 35649.54816212674, "mlp_time_us": 26202.392578125, "allgather_time_us": 141.52021408081052, "allreduce_time_us": 806.3908572133528, "total_latency_us": 62799}, {"doc_id": 8, "doc_len": 9138, "worker_id": 7, "attn_time_us": 1183.1934200424412, "mlp_time_us": 4183.04443359375, "allgather_time_us": 22.59279727935791, "allreduce_time_us": 183.9144575988745, "total_latency_us": 5572}, {"doc_id": 9, "doc_len": 14084, "worker_id": 6, "attn_time_us": 2527.055460011067, "mlp_time_us": 6447.1435546875, "allgather_time_us": 34.82129096984863, "allreduce_time_us": 251.11086062313277, "total_latency_us": 9260}, {"doc_id": 10, "doc_len": 13958, "worker_id": 5, "attn_time_us": 2487.5319747840995, "mlp_time_us": 6389.46533203125, "allgather_time_us": 34.50976848602295, "allreduce_time_us": 249.49157551066844, "total_latency_us": 9160}, {"doc_id": 11, "doc_len": 66573, "worker_id": 7, "attn_time_us": 47709.56561291369, "mlp_time_us": 30474.700927734375, "allgather_time_us": 164.59512948989865, "allreduce_time_us": 923.094889626756, "total_latency_us": 79271}, {"doc_id": 12, "doc_len": 37376, "worker_id": 5, "attn_time_us": 15689.104382008916, "mlp_time_us": 17109.375, "allgather_time_us": 92.408447265625, "allreduce_time_us": 551.0988729358676, "total_latency_us": 33441}, {"doc_id": 13, "doc_len": 60754, "worker_id": 6, "attn_time_us": 39983.554670019475, "mlp_time_us": 27810.97412109375, "allgather_time_us": 150.20823001861572, "allreduce_time_us": 850.4609732267587, "total_latency_us": 68795}, {"doc_id": 14, "doc_len": 16561, "worker_id": 2, "attn_time_us": 3362.4195002272822, "mlp_time_us": 7581.024169921875, "allgather_time_us": 40.94542741775512, "allreduce_time_us": 282.4396393393575, "total_latency_us": 11266}, {"doc_id": 15, "doc_len": 8227, "worker_id": 2, "attn_time_us": 984.1243343596134, "mlp_time_us": 3766.021728515625, "allgather_time_us": 20.34044027328491, "allreduce_time_us": 170.52255853118973, "total_latency_us": 4941}, {"doc_id": 16, "doc_len": 32713, "worker_id": 5, "attn_time_us": 12139.017935616292, "mlp_time_us": 14974.822998046875, "allgather_time_us": 80.87964296340942, "allreduce_time_us": 489.3358845446602, "total_latency_us": 27684}, {"doc_id": 17, "doc_len": 7902, "worker_id": 1, "attn_time_us": 921.2690967329225, "mlp_time_us": 3617.24853515625, "allgather_time_us": 19.536910057067868, "allreduce_time_us": 165.37355732719422, "total_latency_us": 4723}, {"doc_id": 18, "doc_len": 61207, "worker_id": 4, "attn_time_us": 40559.63632514838, "mlp_time_us": 28018.341064453125, "allgather_time_us": 151.328227519989, "allreduce_time_us": 856.1220330237647, "total_latency_us": 69585}, {"doc_id": 19, "doc_len": 23509, "worker_id": 2, "attn_time_us": 6510.058824349658, "mlp_time_us": 10761.566162109375, "allgather_time_us": 58.12366724014282, "allreduce_time_us": 374.7682243346597, "total_latency_us": 17704}, {"doc_id": 20, "doc_len": 70502, "worker_id": 3, "attn_time_us": 53382.75150437761, "mlp_time_us": 32273.25439453125, "allgather_time_us": 174.3091917037964, "allreduce_time_us": 972.5452100109775, "total_latency_us": 86802}, {"doc_id": 21, "doc_len": 17053, "worker_id": 1, "attn_time_us": 3553.2804994376656, "mlp_time_us": 7806.243896484375, "allgather_time_us": 42.16184854507446, "allreduce_time_us": 289.1948457524418, "total_latency_us": 11690}, {"doc_id": 22, "doc_len": 54571, "worker_id": 2, "attn_time_us": 32517.70578037926, "mlp_time_us": 24980.621337890625, "allgather_time_us": 134.92137670516965, "allreduce_time_us": 772.7251705065116, "total_latency_us": 58405}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 58874.74670188367, "mlp_time_us": 33927.154541015625, "allgather_time_us": 183.24197530746457, "allreduce_time_us": 1017.7996806179004, "total_latency_us": 94002}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 31963.47252644385, "mlp_time_us": 24758.60595703125, "allgather_time_us": 133.72226238250732, "allreduce_time_us": 766.5888992822663, "total_latency_us": 57622}, {"doc_id": 25, "doc_len": 8083, "worker_id": 1, "attn_time_us": 955.7767288902585, "mlp_time_us": 3700.103759765625, "allgather_time_us": 19.984414577484127, "allreduce_time_us": 168.26567284520402, "total_latency_us": 4844}, {"doc_id": 26, "doc_len": 14760, "worker_id": 1, "attn_time_us": 2743.656169527251, "mlp_time_us": 6756.591796875, "allgather_time_us": 36.49263381958007, "allreduce_time_us": 259.7303763431473, "total_latency_us": 9796}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 1024.9795824993685, "mlp_time_us": 3854.3701171875, "allgather_time_us": 20.81761360168457, "allreduce_time_us": 173.3930081849844, "total_latency_us": 5073}, {"doc_id": 28, "doc_len": 8823, "worker_id": 13, "attn_time_us": 1112.5809654504883, "mlp_time_us": 4038.848876953125, "allgather_time_us": 21.8139910697937, "allreduce_time_us": 179.32812397160214, "total_latency_us": 5352}, {"doc_id": 29, "doc_len": 29953, "worker_id": 11, "attn_time_us": 10279.967708590439, "mlp_time_us": 13711.395263671875, "allgather_time_us": 74.05581712722778, "allreduce_time_us": 455.7235592731879, "total_latency_us": 24521}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 40011.44061618633, "mlp_time": 27821.044921875, "allgather_time": 150.26262283325195, "allreduce_time": 850.7360072887997}, "1": {"doc_len": 15258, "attn_time": 2908.098131727924, "mlp_time": 6984.55810546875, "allgather_time": 37.72388935089111, "allreduce_time": 266.00958874864097}, "2": {"doc_len": 46893, "attn_time": 24283.23713124822, "mlp_time": 21465.911865234375, "allgather_time": 115.93828439712524, "allreduce_time": 674.8572955732859}, "3": {"doc_len": 33216, "attn_time": 12500.169524014229, "mlp_time": 15205.078125, "allgather_time": 82.12326049804688, "allreduce_time": 495.9786195646589}, "4": {"doc_len": 7431, "attn_time": 833.7780161518946, "mlp_time": 3401.641845703125, "allgather_time": 18.372409343719482, "allreduce_time": 157.77352430564432}, "5": {"doc_len": 70786, "attn_time": 53804.91323100491, "mlp_time": 32403.25927734375, "allgather_time": 175.01135349273682, "allreduce_time": 976.1098620851685}, "6": {"doc_len": 64608, "attn_time": 45011.031354778104, "mlp_time": 29575.1953125, "allgather_time": 159.7368621826172, "allreduce_time": 898.483182476601}, "7": {"doc_len": 57240, "attn_time": 35649.54816212674, "mlp_time": 26202.392578125, "allgather_time": 141.52021408081052, "allreduce_time": 806.3908572133528}, "8": {"doc_len": 9138, "attn_time": 1183.1934200424412, "mlp_time": 4183.04443359375, "allgather_time": 22.59279727935791, "allreduce_time": 183.9144575988745}, "9": {"doc_len": 14084, "attn_time": 2527.055460011067, "mlp_time": 6447.1435546875, "allgather_time": 34.82129096984863, "allreduce_time": 251.11086062313277}, "10": {"doc_len": 13958, "attn_time": 2487.5319747840995, "mlp_time": 6389.46533203125, "allgather_time": 34.50976848602295, "allreduce_time": 249.49157551066844}, "11": {"doc_len": 66573, "attn_time": 47709.56561291369, "mlp_time": 30474.700927734375, "allgather_time": 164.59512948989865, "allreduce_time": 923.094889626756}, "12": {"doc_len": 37376, "attn_time": 15689.104382008916, "mlp_time": 17109.375, "allgather_time": 92.408447265625, "allreduce_time": 551.0988729358676}, "13": {"doc_len": 60754, "attn_time": 39983.554670019475, "mlp_time": 27810.97412109375, "allgather_time": 150.20823001861572, "allreduce_time": 850.4609732267587}, "14": {"doc_len": 16561, "attn_time": 3362.4195002272822, "mlp_time": 7581.024169921875, "allgather_time": 40.94542741775512, "allreduce_time": 282.4396393393575}, "15": {"doc_len": 8227, "attn_time": 984.1243343596134, "mlp_time": 3766.021728515625, "allgather_time": 20.34044027328491, "allreduce_time": 170.52255853118973}, "16": {"doc_len": 32713, "attn_time": 12139.017935616292, "mlp_time": 14974.822998046875, "allgather_time": 80.87964296340942, "allreduce_time": 489.3358845446602}, "17": {"doc_len": 7902, "attn_time": 921.2690967329225, "mlp_time": 3617.24853515625, "allgather_time": 19.536910057067868, "allreduce_time": 165.37355732719422}, "18": {"doc_len": 61207, "attn_time": 40559.63632514838, "mlp_time": 28018.341064453125, "allgather_time": 151.328227519989, "allreduce_time": 856.1220330237647}, "19": {"doc_len": 23509, "attn_time": 6510.058824349658, "mlp_time": 10761.566162109375, "allgather_time": 58.12366724014282, "allreduce_time": 374.7682243346597}, "20": {"doc_len": 70502, "attn_time": 53382.75150437761, "mlp_time": 32273.25439453125, "allgather_time": 174.3091917037964, "allreduce_time": 972.5452100109775}, "21": {"doc_len": 17053, "attn_time": 3553.2804994376656, "mlp_time": 7806.243896484375, "allgather_time": 42.16184854507446, "allreduce_time": 289.1948457524418}, "22": {"doc_len": 54571, "attn_time": 32517.70578037926, "mlp_time": 24980.621337890625, "allgather_time": 134.92137670516965, "allreduce_time": 772.7251705065116}, "23": {"doc_len": 74115, "attn_time": 58874.74670188367, "mlp_time": 33927.154541015625, "allgather_time": 183.24197530746457, "allreduce_time": 1017.7996806179004}, "24": {"doc_len": 54086, "attn_time": 31963.47252644385, "mlp_time": 24758.60595703125, "allgather_time": 133.72226238250732, "allreduce_time": 766.5888992822663}, "25": {"doc_len": 8083, "attn_time": 955.7767288902585, "mlp_time": 3700.103759765625, "allgather_time": 19.984414577484127, "allreduce_time": 168.26567284520402}, "26": {"doc_len": 14760, "attn_time": 2743.656169527251, "mlp_time": 6756.591796875, "allgather_time": 36.49263381958007, "allreduce_time": 259.7303763431473}, "27": {"doc_len": 8420, "attn_time": 1024.9795824993685, "mlp_time": 3854.3701171875, "allgather_time": 20.81761360168457, "allreduce_time": 173.3930081849844}, "28": {"doc_len": 8823, "attn_time": 1112.5809654504883, "mlp_time": 4038.848876953125, "allgather_time": 21.8139910697937, "allreduce_time": 179.32812397160214}, "29": {"doc_len": 29953, "attn_time": 10279.967708590439, "mlp_time": 13711.395263671875, "allgather_time": 74.05581712722778, "allreduce_time": 455.7235592731879}}}, "attnserver_result": {"batch_total_time": 69738.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 1820.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 2, "mlp_cp": 2}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 4, "dp": 8, "ratio": 1.002290129961363, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 71175, "worker_latencies_us": [71033, 71117, 70060, 71168, 71175, 71101, 71117, 71103], "doc2worker": {"0": 7, "1": 6, "2": 5, "3": 6, "4": 4, "5": 6, "6": 2, "7": 4, "8": 1, "9": 7, "10": 3, "11": 5, "12": 3, "13": 4, "14": 0, "15": 0, "16": 0, "17": 0, "18": 3, "19": 3, "20": 0, "21": 1, "22": 2, "23": 1, "24": 7, "25": 5, "26": 6, "27": 5, "28": 3, "29": 1}, "latency_breakdown": {"max_worker_latency_us": 71175, "worker_latencies_us": [71033, 71117, 70060, 71168, 71175, 71101, 71117, 71103], "solver_status": "OPTIMAL", "solved_time_s": 0.41655826568603516, "num_vars": 249, "num_cons": 54}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [14, 15, 16, 17, 20], "total_batch_length": 135905, "total_latency_us": 71033, "mlp_cost_us": 31106.185913085938, "attn_cost_us": 37474.50278434288, "allreduce_cost_us": 2080.216849753379, "allgather_cost_us": 374.57032203674316}, {"worker_id": 1, "assigned_docs": [8, 21, 23, 29], "total_batch_length": 130259, "total_latency_us": 71117, "mlp_cost_us": 29813.919067382812, "attn_cost_us": 38999.54456163198, "allreduce_cost_us": 1946.6325432424046, "allgather_cost_us": 359.00927543640137}, {"worker_id": 2, "assigned_docs": [6, 22], "total_batch_length": 119179, "total_latency_us": 70060, "mlp_cost_us": 27277.908325195312, "attn_cost_us": 40782.98996060148, "allreduce_cost_us": 1671.2083529831125, "allgather_cost_us": 328.47147941589355}, {"worker_id": 3, "assigned_docs": [10, 12, 18, 19, 28], "total_batch_length": 144873, "total_latency_us": 71168, "mlp_cost_us": 33158.79821777344, "attn_cost_us": 35400.561970168535, "allreduce_cost_us": 2210.8088297765626, "allgather_cost_us": 399.2871952056885}, {"worker_id": 4, "assigned_docs": [4, 7, 13], "total_batch_length": 125425, "total_latency_us": 71175, "mlp_cost_us": 28707.504272460938, "attn_cost_us": 40309.203906964394, "allreduce_cost_us": 1814.6253547457559, "allgather_cost_us": 345.6861972808838}, {"worker_id": 5, "assigned_docs": [2, 11, 25, 27], "total_batch_length": 129969, "total_latency_us": 71101, "mlp_cost_us": 29747.543334960938, "attn_cost_us": 39057.51333949794, "allreduce_cost_us": 1939.6108662302304, "allgather_cost_us": 358.21000099182135}, {"worker_id": 6, "assigned_docs": [1, 3, 5, 26], "total_batch_length": 134020, "total_latency_us": 71117, "mlp_cost_us": 30674.74365234375, "attn_cost_us": 38076.74334882952, "allreduce_cost_us": 1997.8284467416156, "allgather_cost_us": 369.37503814697266}, {"worker_id": 7, "assigned_docs": [0, 9, 24], "total_batch_length": 128946, "total_latency_us": 71103, "mlp_cost_us": 29513.397216796875, "attn_cost_us": 39367.20020725321, "allreduce_cost_us": 1868.4357671941987, "allgather_cost_us": 355.3904914855957}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 7, "attn_time_us": 21037.592501483618, "mlp_time_us": 13910.5224609375, "allgather_time_us": 167.50587463378906, "allreduce_time_us": 850.7360072887997, "total_latency_us": 35966}, {"doc_id": 1, "doc_len": 15258, "worker_id": 6, "attn_time_us": 1639.334883920645, "mlp_time_us": 3492.279052734375, "allgather_time_us": 42.052860260009766, "allreduce_time_us": 266.00958874864097, "total_latency_us": 5439}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12927.34806679707, "mlp_time_us": 10732.955932617188, "allgather_time_us": 129.24267768859866, "allreduce_time_us": 674.8572955732859, "total_latency_us": 24464}, {"doc_id": 3, "doc_len": 33216, "worker_id": 6, "attn_time_us": 6765.305361786525, "mlp_time_us": 7602.5390625, "allgather_time_us": 91.5472412109375, "allreduce_time_us": 495.9786195646589, "total_latency_us": 14955}, {"doc_id": 4, "doc_len": 7431, "worker_id": 4, "attn_time_us": 487.8945067030157, "mlp_time_us": 1700.8209228515625, "allgather_time_us": 20.4807186126709, "allreduce_time_us": 157.77352430564432, "total_latency_us": 2366}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 28123.246826300783, "mlp_time_us": 16201.629638671875, "allgather_time_us": 195.09462356567383, "allreduce_time_us": 976.1098620851685, "total_latency_us": 45496}, {"doc_id": 6, "doc_len": 64608, "worker_id": 2, "attn_time_us": 23597.159997048584, "mlp_time_us": 14787.59765625, "allgather_time_us": 178.06732177734375, "allreduce_time_us": 898.483182476601, "total_latency_us": 39461}, {"doc_id": 7, "doc_len": 57240, "worker_id": 4, "attn_time_us": 18798.014695929673, "mlp_time_us": 13101.1962890625, "allgather_time_us": 157.76023864746094, "allreduce_time_us": 806.3908572133528, "total_latency_us": 32863}, {"doc_id": 8, "doc_len": 9138, "worker_id": 1, "attn_time_us": 681.9248061890113, "mlp_time_us": 2091.522216796875, "allgather_time_us": 25.185413360595703, "allreduce_time_us": 183.9144575988745, "total_latency_us": 2982}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 1429.4735424708608, "mlp_time_us": 3223.57177734375, "allgather_time_us": 38.817176818847656, "allreduce_time_us": 251.11086062313277, "total_latency_us": 4942}, {"doc_id": 10, "doc_len": 13958, "worker_id": 3, "attn_time_us": 1407.6629778558618, "mlp_time_us": 3194.732666015625, "allgather_time_us": 38.469905853271484, "allreduce_time_us": 249.49157551066844, "total_latency_us": 4890}, {"doc_id": 11, "doc_len": 66573, "worker_id": 5, "attn_time_us": 24983.07422413108, "mlp_time_us": 15237.350463867188, "allgather_time_us": 183.48309516906738, "allreduce_time_us": 923.094889626756, "total_latency_us": 41327}, {"doc_id": 12, "doc_len": 37376, "worker_id": 3, "attn_time_us": 8443.386510419421, "mlp_time_us": 8554.6875, "allgather_time_us": 103.0126953125, "allreduce_time_us": 551.0988729358676, "total_latency_us": 17652}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 21023.294704331704, "mlp_time_us": 13905.487060546875, "allgather_time_us": 167.44524002075195, "allreduce_time_us": 850.4609732267587, "total_latency_us": 35946}, {"doc_id": 14, "doc_len": 16561, "worker_id": 0, "attn_time_us": 1888.5350583408422, "mlp_time_us": 3790.5120849609375, "allgather_time_us": 45.64408302307129, "allreduce_time_us": 282.4396393393575, "total_latency_us": 6007}, {"doc_id": 15, "doc_len": 8227, "worker_id": 0, "attn_time_us": 569.7729510363607, "mlp_time_us": 1883.0108642578125, "allgather_time_us": 22.674589157104496, "allreduce_time_us": 170.52255853118973, "total_latency_us": 2645}, {"doc_id": 16, "doc_len": 32713, "worker_id": 0, "attn_time_us": 6574.705273329774, "mlp_time_us": 7487.4114990234375, "allgather_time_us": 90.16091346740723, "allreduce_time_us": 489.3358845446602, "total_latency_us": 14641}, {"doc_id": 17, "doc_len": 7902, "worker_id": 0, "attn_time_us": 535.5475379348818, "mlp_time_us": 1808.624267578125, "allgather_time_us": 21.778850555419925, "allreduce_time_us": 165.37355732719422, "total_latency_us": 2531}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21318.61558785478, "mlp_time_us": 14009.170532226562, "allgather_time_us": 168.69376182556152, "allreduce_time_us": 856.1220330237647, "total_latency_us": 36352}, {"doc_id": 19, "doc_len": 23509, "worker_id": 3, "attn_time_us": 3588.6961937262495, "mlp_time_us": 5380.7830810546875, "allgather_time_us": 64.79359626770021, "allreduce_time_us": 374.7682243346597, "total_latency_us": 9409}, {"doc_id": 20, "doc_len": 70502, "worker_id": 0, "attn_time_us": 27905.941963701025, "mlp_time_us": 16136.627197265625, "allgather_time_us": 194.31188583374023, "allreduce_time_us": 972.5452100109775, "total_latency_us": 45209}, {"doc_id": 21, "doc_len": 17053, "worker_id": 1, "attn_time_us": 1992.6177030505444, "mlp_time_us": 3903.1219482421875, "allgather_time_us": 47.000093460083015, "allreduce_time_us": 289.1948457524418, "total_latency_us": 6231}, {"doc_id": 22, "doc_len": 54571, "worker_id": 2, "attn_time_us": 17185.829963552893, "mlp_time_us": 12490.310668945312, "allgather_time_us": 150.4041576385498, "allreduce_time_us": 772.7251705065116, "total_latency_us": 30599}, {"doc_id": 23, "doc_len": 74115, "worker_id": 1, "attn_time_us": 30730.933178380918, "mlp_time_us": 16963.577270507812, "allgather_time_us": 204.26974296569824, "allreduce_time_us": 1017.7996806179004, "total_latency_us": 48916}, {"doc_id": 24, "doc_len": 54086, "worker_id": 7, "attn_time_us": 16900.134163298735, "mlp_time_us": 12379.302978515625, "allgather_time_us": 149.06744003295898, "allreduce_time_us": 766.5888992822663, "total_latency_us": 30195}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 554.2587585990817, "mlp_time_us": 1850.0518798828125, "allgather_time_us": 22.27770805358887, "allreduce_time_us": 168.26567284520402, "total_latency_us": 2594}, {"doc_id": 26, "doc_len": 14760, "worker_id": 6, "attn_time_us": 1548.8562768215602, "mlp_time_us": 3378.2958984375, "allgather_time_us": 40.68031311035156, "allreduce_time_us": 259.7303763431473, "total_latency_us": 5227}, {"doc_id": 27, "doc_len": 8420, "worker_id": 5, "attn_time_us": 592.8322899707059, "mlp_time_us": 1927.18505859375, "allgather_time_us": 23.206520080566406, "allreduce_time_us": 173.3930081849844, "total_latency_us": 2716}, {"doc_id": 28, "doc_len": 8823, "worker_id": 3, "attn_time_us": 642.2007003122245, "mlp_time_us": 2019.4244384765625, "allgather_time_us": 24.317235946655273, "allreduce_time_us": 179.32812397160214, "total_latency_us": 2865}, {"doc_id": 29, "doc_len": 29953, "worker_id": 1, "attn_time_us": 5594.0688740115065, "mlp_time_us": 6855.6976318359375, "allgather_time_us": 82.55402565002441, "allreduce_time_us": 455.7235592731879, "total_latency_us": 12988}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 21037.592501483618, "mlp_time": 13910.5224609375, "allgather_time": 167.50587463378906, "allreduce_time": 850.7360072887997}, "1": {"doc_len": 15258, "attn_time": 1639.334883920645, "mlp_time": 3492.279052734375, "allgather_time": 42.052860260009766, "allreduce_time": 266.00958874864097}, "2": {"doc_len": 46893, "attn_time": 12927.34806679707, "mlp_time": 10732.955932617188, "allgather_time": 129.24267768859866, "allreduce_time": 674.8572955732859}, "3": {"doc_len": 33216, "attn_time": 6765.305361786525, "mlp_time": 7602.5390625, "allgather_time": 91.5472412109375, "allreduce_time": 495.9786195646589}, "4": {"doc_len": 7431, "attn_time": 487.8945067030157, "mlp_time": 1700.8209228515625, "allgather_time": 20.4807186126709, "allreduce_time": 157.77352430564432}, "5": {"doc_len": 70786, "attn_time": 28123.246826300783, "mlp_time": 16201.629638671875, "allgather_time": 195.09462356567383, "allreduce_time": 976.1098620851685}, "6": {"doc_len": 64608, "attn_time": 23597.159997048584, "mlp_time": 14787.59765625, "allgather_time": 178.06732177734375, "allreduce_time": 898.483182476601}, "7": {"doc_len": 57240, "attn_time": 18798.014695929673, "mlp_time": 13101.1962890625, "allgather_time": 157.76023864746094, "allreduce_time": 806.3908572133528}, "8": {"doc_len": 9138, "attn_time": 681.9248061890113, "mlp_time": 2091.522216796875, "allgather_time": 25.185413360595703, "allreduce_time": 183.9144575988745}, "9": {"doc_len": 14084, "attn_time": 1429.4735424708608, "mlp_time": 3223.57177734375, "allgather_time": 38.817176818847656, "allreduce_time": 251.11086062313277}, "10": {"doc_len": 13958, "attn_time": 1407.6629778558618, "mlp_time": 3194.732666015625, "allgather_time": 38.469905853271484, "allreduce_time": 249.49157551066844}, "11": {"doc_len": 66573, "attn_time": 24983.07422413108, "mlp_time": 15237.350463867188, "allgather_time": 183.48309516906738, "allreduce_time": 923.094889626756}, "12": {"doc_len": 37376, "attn_time": 8443.386510419421, "mlp_time": 8554.6875, "allgather_time": 103.0126953125, "allreduce_time": 551.0988729358676}, "13": {"doc_len": 60754, "attn_time": 21023.294704331704, "mlp_time": 13905.487060546875, "allgather_time": 167.44524002075195, "allreduce_time": 850.4609732267587}, "14": {"doc_len": 16561, "attn_time": 1888.5350583408422, "mlp_time": 3790.5120849609375, "allgather_time": 45.64408302307129, "allreduce_time": 282.4396393393575}, "15": {"doc_len": 8227, "attn_time": 569.7729510363607, "mlp_time": 1883.0108642578125, "allgather_time": 22.674589157104496, "allreduce_time": 170.52255853118973}, "16": {"doc_len": 32713, "attn_time": 6574.705273329774, "mlp_time": 7487.4114990234375, "allgather_time": 90.16091346740723, "allreduce_time": 489.3358845446602}, "17": {"doc_len": 7902, "attn_time": 535.5475379348818, "mlp_time": 1808.624267578125, "allgather_time": 21.778850555419925, "allreduce_time": 165.37355732719422}, "18": {"doc_len": 61207, "attn_time": 21318.61558785478, "mlp_time": 14009.170532226562, "allgather_time": 168.69376182556152, "allreduce_time": 856.1220330237647}, "19": {"doc_len": 23509, "attn_time": 3588.6961937262495, "mlp_time": 5380.7830810546875, "allgather_time": 64.79359626770021, "allreduce_time": 374.7682243346597}, "20": {"doc_len": 70502, "attn_time": 27905.941963701025, "mlp_time": 16136.627197265625, "allgather_time": 194.31188583374023, "allreduce_time": 972.5452100109775}, "21": {"doc_len": 17053, "attn_time": 1992.6177030505444, "mlp_time": 3903.1219482421875, "allgather_time": 47.000093460083015, "allreduce_time": 289.1948457524418}, "22": {"doc_len": 54571, "attn_time": 17185.829963552893, "mlp_time": 12490.310668945312, "allgather_time": 150.4041576385498, "allreduce_time": 772.7251705065116}, "23": {"doc_len": 74115, "attn_time": 30730.933178380918, "mlp_time": 16963.577270507812, "allgather_time": 204.26974296569824, "allreduce_time": 1017.7996806179004}, "24": {"doc_len": 54086, "attn_time": 16900.134163298735, "mlp_time": 12379.302978515625, "allgather_time": 149.06744003295898, "allreduce_time": 766.5888992822663}, "25": {"doc_len": 8083, "attn_time": 554.2587585990817, "mlp_time": 1850.0518798828125, "allgather_time": 22.27770805358887, "allreduce_time": 168.26567284520402}, "26": {"doc_len": 14760, "attn_time": 1548.8562768215602, "mlp_time": 3378.2958984375, "allgather_time": 40.68031311035156, "allreduce_time": 259.7303763431473}, "27": {"doc_len": 8420, "attn_time": 592.8322899707059, "mlp_time": 1927.18505859375, "allgather_time": 23.206520080566406, "allreduce_time": 173.3930081849844}, "28": {"doc_len": 8823, "attn_time": 642.2007003122245, "mlp_time": 2019.4244384765625, "allgather_time": 24.317235946655273, "allreduce_time": 179.32812397160214}, "29": {"doc_len": 29953, "attn_time": 5594.0688740115065, "mlp_time": 6855.6976318359375, "allgather_time": 82.55402565002441, "allreduce_time": 455.7235592731879}}}, "attnserver_result": {"batch_total_time": 71338.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 3420.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 2, "mlp_cp": 4}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 8, "dp": 4, "ratio": 0.9901856481727751, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 75196, "worker_latencies_us": [75196, 75195, 75196, 75196], "doc2worker": {"0": 3, "1": 3, "2": 2, "3": 3, "4": 1, "5": 3, "6": 2, "7": 2, "8": 1, "9": 1, "10": 2, "11": 2, "12": 0, "13": 0, "14": 3, "15": 1, "16": 3, "17": 1, "18": 0, "19": 3, "20": 1, "21": 3, "22": 0, "23": 1, "24": 1, "25": 1, "26": 0, "27": 3, "28": 0, "29": 0}, "latency_breakdown": {"max_worker_latency_us": 75196, "worker_latencies_us": [75196, 75195, 75196, 75196], "solver_status": "OPTIMAL", "solved_time_s": 0.5030572414398193, "num_vars": 125, "num_cons": 42}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [12, 13, 18, 22, 26, 28, 29], "total_batch_length": 267444, "total_latency_us": 75196, "mlp_cost_us": 30606.536865234375, "attn_cost_us": 39843.56394981486, "allreduce_cost_us": 3925.18910928084, "allgather_cost_us": 824.7824048995972}, {"worker_id": 1, "assigned_docs": [4, 8, 9, 15, 17, 20, 23, 24, 25], "total_batch_length": 253568, "total_latency_us": 75195, "mlp_cost_us": 29018.5546875, "attn_cost_us": 41547.05934405122, "allreduce_cost_us": 3853.894421142383, "allgather_cost_us": 781.9895935058594}, {"worker_id": 2, "assigned_docs": [2, 6, 7, 10, 11], "total_batch_length": 249272, "total_latency_us": 75196, "mlp_cost_us": 28526.91650390625, "attn_cost_us": 42350.28763600944, "allreduce_cost_us": 3552.317800400664, "allgather_cost_us": 768.7409687042236}, {"worker_id": 3, "assigned_docs": [0, 1, 3, 5, 14, 16, 19, 21, 27], "total_batch_length": 278292, "total_latency_us": 75196, "mlp_cost_us": 31847.991943359375, "attn_cost_us": 38296.9189975678, "allreduce_cost_us": 4197.965679843372, "allgather_cost_us": 858.2370328903198}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 3, "attn_time_us": 10853.167937480666, "mlp_time_us": 6955.26123046875, "allgather_time_us": 187.42980003356934, "allreduce_time_us": 850.7360072887997, "total_latency_us": 18846}, {"doc_id": 1, "doc_len": 15258, "worker_id": 3, "attn_time_us": 988.3350665061008, "mlp_time_us": 1746.1395263671875, "allgather_time_us": 47.05482244491577, "allreduce_time_us": 266.00958874864097, "total_latency_us": 3047}, {"doc_id": 2, "doc_len": 46893, "worker_id": 2, "attn_time_us": 6847.762201848844, "mlp_time_us": 5366.477966308594, "allgather_time_us": 144.61540102958682, "allreduce_time_us": 674.8572955732859, "total_latency_us": 13033}, {"doc_id": 3, "doc_len": 33216, "worker_id": 3, "attn_time_us": 3711.849580505667, "mlp_time_us": 3801.26953125, "allgather_time_us": 102.43629455566406, "allreduce_time_us": 495.9786195646589, "total_latency_us": 8111}, {"doc_id": 4, "doc_len": 7431, "worker_id": 1, "attn_time_us": 328.86816081117274, "mlp_time_us": 850.4104614257812, "allgather_time_us": 22.9167902469635, "allreduce_time_us": 157.77352430564432, "total_latency_us": 1359}, {"doc_id": 5, "doc_len": 70786, "worker_id": 3, "attn_time_us": 14380.950014534516, "mlp_time_us": 8100.8148193359375, "allgather_time_us": 218.30008268356323, "allreduce_time_us": 976.1098620851685, "total_latency_us": 23676}, {"doc_id": 6, "doc_len": 64608, "worker_id": 2, "attn_time_us": 12098.006034866637, "mlp_time_us": 7393.798828125, "allgather_time_us": 199.24747467041016, "allreduce_time_us": 898.483182476601, "total_latency_us": 20589}, {"doc_id": 7, "doc_len": 57240, "worker_id": 2, "attn_time_us": 9757.211584129227, "mlp_time_us": 6550.59814453125, "allgather_time_us": 176.5249729156494, "allreduce_time_us": 806.3908572133528, "total_latency_us": 17290}, {"doc_id": 8, "doc_len": 9138, "worker_id": 1, "attn_time_us": 444.8530966532996, "mlp_time_us": 1045.7611083984375, "allgather_time_us": 28.18108320236206, "allreduce_time_us": 183.9144575988745, "total_latency_us": 1702}, {"doc_id": 9, "doc_len": 14084, "worker_id": 1, "attn_time_us": 872.4903002226864, "mlp_time_us": 1611.785888671875, "allgather_time_us": 43.434271812438965, "allreduce_time_us": 251.11086062313277, "total_latency_us": 2778}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 860.3663945635782, "mlp_time_us": 1597.3663330078125, "allgather_time_us": 43.04569482803345, "allreduce_time_us": 249.49157551066844, "total_latency_us": 2750}, {"doc_id": 11, "doc_len": 66573, "worker_id": 2, "attn_time_us": 12786.941420601148, "mlp_time_us": 7618.675231933594, "allgather_time_us": 205.30742526054382, "allreduce_time_us": 923.094889626756, "total_latency_us": 21534}, {"doc_id": 12, "doc_len": 37376, "worker_id": 0, "attn_time_us": 4577.165871560209, "mlp_time_us": 4277.34375, "allgather_time_us": 115.2655029296875, "allreduce_time_us": 551.0988729358676, "total_latency_us": 9520}, {"doc_id": 13, "doc_len": 60754, "worker_id": 0, "attn_time_us": 10846.192012083337, "mlp_time_us": 6952.7435302734375, "allgather_time_us": 187.3619532585144, "allreduce_time_us": 850.4609732267587, "total_latency_us": 18836}, {"doc_id": 14, "doc_len": 16561, "worker_id": 3, "attn_time_us": 1124.745144445701, "mlp_time_us": 1895.2560424804688, "allgather_time_us": 51.07320189476013, "allreduce_time_us": 282.4396393393575, "total_latency_us": 3353}, {"doc_id": 15, "doc_len": 8227, "worker_id": 1, "attn_time_us": 377.74336182768815, "mlp_time_us": 941.5054321289062, "allgather_time_us": 25.37160992622376, "allreduce_time_us": 170.52255853118973, "total_latency_us": 1515}, {"doc_id": 16, "doc_len": 32713, "worker_id": 3, "attn_time_us": 3612.9882003814137, "mlp_time_us": 3743.7057495117188, "allgather_time_us": 100.88507056236267, "allreduce_time_us": 489.3358845446602, "total_latency_us": 7946}, {"doc_id": 17, "doc_len": 7902, "worker_id": 1, "attn_time_us": 357.38351016074824, "mlp_time_us": 904.3121337890625, "allgather_time_us": 24.369328022003177, "allreduce_time_us": 165.37355732719422, "total_latency_us": 1451}, {"doc_id": 18, "doc_len": 61207, "worker_id": 0, "attn_time_us": 10990.227692229248, "mlp_time_us": 7004.585266113281, "allgather_time_us": 188.75898003578186, "allreduce_time_us": 856.1220330237647, "total_latency_us": 19039}, {"doc_id": 19, "doc_len": 23509, "worker_id": 3, "attn_time_us": 2050.616964044694, "mlp_time_us": 2690.3915405273438, "allgather_time_us": 72.50044703483583, "allreduce_time_us": 374.7682243346597, "total_latency_us": 5188}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 14270.688436458531, "mlp_time_us": 8068.3135986328125, "allgather_time_us": 217.42424249649048, "allreduce_time_us": 972.5452100109775, "total_latency_us": 23528}, {"doc_id": 21, "doc_len": 17053, "worker_id": 3, "attn_time_us": 1182.634261521964, "mlp_time_us": 1951.5609741210938, "allgather_time_us": 52.590502500534065, "allreduce_time_us": 289.1948457524418, "total_latency_us": 3475}, {"doc_id": 22, "doc_len": 54571, "worker_id": 0, "attn_time_us": 8963.917562175971, "mlp_time_us": 6245.155334472656, "allgather_time_us": 168.29392552375793, "allreduce_time_us": 772.7251705065116, "total_latency_us": 16150}, {"doc_id": 23, "doc_len": 74115, "worker_id": 1, "attn_time_us": 15703.601971965221, "mlp_time_us": 8481.788635253906, "allgather_time_us": 228.56653332710266, "allreduce_time_us": 1017.7996806179004, "total_latency_us": 25431}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 8822.926222164944, "mlp_time_us": 6189.6514892578125, "allgather_time_us": 166.79821252822876, "allreduce_time_us": 766.5888992822663, "total_latency_us": 15945}, {"doc_id": 25, "doc_len": 8083, "worker_id": 1, "attn_time_us": 368.504283786924, "mlp_time_us": 925.0259399414062, "allgather_time_us": 24.927521944046024, "allreduce_time_us": 168.26567284520402, "total_latency_us": 1486}, {"doc_id": 26, "doc_len": 14760, "worker_id": 0, "attn_time_us": 938.564519254812, "mlp_time_us": 1689.14794921875, "allgather_time_us": 45.51901817321777, "allreduce_time_us": 259.7303763431473, "total_latency_us": 2932}, {"doc_id": 27, "doc_len": 8420, "worker_id": 3, "attn_time_us": 391.6318281470827, "mlp_time_us": 963.592529296875, "allgather_time_us": 25.966811180114746, "allreduce_time_us": 173.3930081849844, "total_latency_us": 1554}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 421.2055328484815, "mlp_time_us": 1009.7122192382812, "allgather_time_us": 27.209640741348267, "allreduce_time_us": 179.32812397160214, "total_latency_us": 1637}, {"doc_id": 29, "doc_len": 29953, "worker_id": 0, "attn_time_us": 3106.2907596628074, "mlp_time_us": 3427.8488159179688, "allgather_time_us": 92.37338423728943, "allreduce_time_us": 455.7235592731879, "total_latency_us": 7082}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 10853.167937480666, "mlp_time": 6955.26123046875, "allgather_time": 187.42980003356934, "allreduce_time": 850.7360072887997}, "1": {"doc_len": 15258, "attn_time": 988.3350665061008, "mlp_time": 1746.1395263671875, "allgather_time": 47.05482244491577, "allreduce_time": 266.00958874864097}, "2": {"doc_len": 46893, "attn_time": 6847.762201848844, "mlp_time": 5366.477966308594, "allgather_time": 144.61540102958682, "allreduce_time": 674.8572955732859}, "3": {"doc_len": 33216, "attn_time": 3711.849580505667, "mlp_time": 3801.26953125, "allgather_time": 102.43629455566406, "allreduce_time": 495.9786195646589}, "4": {"doc_len": 7431, "attn_time": 328.86816081117274, "mlp_time": 850.4104614257812, "allgather_time": 22.9167902469635, "allreduce_time": 157.77352430564432}, "5": {"doc_len": 70786, "attn_time": 14380.950014534516, "mlp_time": 8100.8148193359375, "allgather_time": 218.30008268356323, "allreduce_time": 976.1098620851685}, "6": {"doc_len": 64608, "attn_time": 12098.006034866637, "mlp_time": 7393.798828125, "allgather_time": 199.24747467041016, "allreduce_time": 898.483182476601}, "7": {"doc_len": 57240, "attn_time": 9757.211584129227, "mlp_time": 6550.59814453125, "allgather_time": 176.5249729156494, "allreduce_time": 806.3908572133528}, "8": {"doc_len": 9138, "attn_time": 444.8530966532996, "mlp_time": 1045.7611083984375, "allgather_time": 28.18108320236206, "allreduce_time": 183.9144575988745}, "9": {"doc_len": 14084, "attn_time": 872.4903002226864, "mlp_time": 1611.785888671875, "allgather_time": 43.434271812438965, "allreduce_time": 251.11086062313277}, "10": {"doc_len": 13958, "attn_time": 860.3663945635782, "mlp_time": 1597.3663330078125, "allgather_time": 43.04569482803345, "allreduce_time": 249.49157551066844}, "11": {"doc_len": 66573, "attn_time": 12786.941420601148, "mlp_time": 7618.675231933594, "allgather_time": 205.30742526054382, "allreduce_time": 923.094889626756}, "12": {"doc_len": 37376, "attn_time": 4577.165871560209, "mlp_time": 4277.34375, "allgather_time": 115.2655029296875, "allreduce_time": 551.0988729358676}, "13": {"doc_len": 60754, "attn_time": 10846.192012083337, "mlp_time": 6952.7435302734375, "allgather_time": 187.3619532585144, "allreduce_time": 850.4609732267587}, "14": {"doc_len": 16561, "attn_time": 1124.745144445701, "mlp_time": 1895.2560424804688, "allgather_time": 51.07320189476013, "allreduce_time": 282.4396393393575}, "15": {"doc_len": 8227, "attn_time": 377.74336182768815, "mlp_time": 941.5054321289062, "allgather_time": 25.37160992622376, "allreduce_time": 170.52255853118973}, "16": {"doc_len": 32713, "attn_time": 3612.9882003814137, "mlp_time": 3743.7057495117188, "allgather_time": 100.88507056236267, "allreduce_time": 489.3358845446602}, "17": {"doc_len": 7902, "attn_time": 357.38351016074824, "mlp_time": 904.3121337890625, "allgather_time": 24.369328022003177, "allreduce_time": 165.37355732719422}, "18": {"doc_len": 61207, "attn_time": 10990.227692229248, "mlp_time": 7004.585266113281, "allgather_time": 188.75898003578186, "allreduce_time": 856.1220330237647}, "19": {"doc_len": 23509, "attn_time": 2050.616964044694, "mlp_time": 2690.3915405273438, "allgather_time": 72.50044703483583, "allreduce_time": 374.7682243346597}, "20": {"doc_len": 70502, "attn_time": 14270.688436458531, "mlp_time": 8068.3135986328125, "allgather_time": 217.42424249649048, "allreduce_time": 972.5452100109775}, "21": {"doc_len": 17053, "attn_time": 1182.634261521964, "mlp_time": 1951.5609741210938, "allgather_time": 52.590502500534065, "allreduce_time": 289.1948457524418}, "22": {"doc_len": 54571, "attn_time": 8963.917562175971, "mlp_time": 6245.155334472656, "allgather_time": 168.29392552375793, "allreduce_time": 772.7251705065116}, "23": {"doc_len": 74115, "attn_time": 15703.601971965221, "mlp_time": 8481.788635253906, "allgather_time": 228.56653332710266, "allreduce_time": 1017.7996806179004}, "24": {"doc_len": 54086, "attn_time": 8822.926222164944, "mlp_time": 6189.6514892578125, "allgather_time": 166.79821252822876, "allreduce_time": 766.5888992822663}, "25": {"doc_len": 8083, "attn_time": 368.504283786924, "mlp_time": 925.0259399414062, "allgather_time": 24.927521944046024, "allreduce_time": 168.26567284520402}, "26": {"doc_len": 14760, "attn_time": 938.564519254812, "mlp_time": 1689.14794921875, "allgather_time": 45.51901817321777, "allreduce_time": 259.7303763431473}, "27": {"doc_len": 8420, "attn_time": 391.6318281470827, "mlp_time": 963.592529296875, "allgather_time": 25.966811180114746, "allreduce_time": 173.3930081849844}, "28": {"doc_len": 8823, "attn_time": 421.2055328484815, "mlp_time": 1009.7122192382812, "allgather_time": 27.209640741348267, "allreduce_time": 179.32812397160214}, "29": {"doc_len": 29953, "attn_time": 3106.2907596628074, "mlp_time": 3427.8488159179688, "allgather_time": 92.37338423728943, "allreduce_time": 455.7235592731879}}}, "attnserver_result": {"batch_total_time": 74458.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 6540.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 2, "mlp_cp": 8}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 1, "dp": 16, "ratio": 0.71533883821016, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 97126, "worker_latencies_us": [93231, 69766, 4574, 74959, 89372, 71005, 88012, 38677, 81301, 63837, 77434, 94237, 28016, 46812, 97126, 80104], "doc2worker": {"0": 15, "1": 15, "2": 13, "3": 12, "4": 11, "5": 11, "6": 10, "7": 9, "8": 7, "9": 6, "10": 6, "11": 8, "12": 7, "13": 6, "14": 3, "15": 3, "16": 0, "17": 2, "18": 5, "19": 0, "20": 4, "21": 1, "22": 3, "23": 14, "24": 1, "25": 0, "26": 0, "27": 0, "28": 0, "29": 0}, "latency_breakdown": {"max_worker_latency_us": 97126, "worker_latencies_us": [93231, 69766, 4574, 74959, 89372, 71005, 88012, 38677, 81301, 63837, 77434, 94237, 28016, 46812, 97126, 80104], "solver_status": "OPTIMAL", "solved_time_s": 0.023959875106811523, "num_vars": 497, "num_cons": 78}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [16, 19, 25, 26, 27, 28, 29], "total_batch_length": 126261, "total_latency_us": 93231, "mlp_cost_us": 57797.698974609375, "attn_cost_us": 33679.67430160426, "allreduce_cost_us": 1758.4064986616177, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [21, 24], "total_batch_length": 71139, "total_latency_us": 69766, "mlp_cost_us": 32564.849853515625, "attn_cost_us": 36361.01808501369, "allreduce_cost_us": 840.9981555052217, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [17], "total_batch_length": 7902, "total_latency_us": 4574, "mlp_cost_us": 3617.24853515625, "attn_cost_us": 764.4586168173399, "allreduce_cost_us": 192.91992187499994, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [14, 15, 22], "total_batch_length": 79359, "total_latency_us": 74959, "mlp_cost_us": 36327.667236328125, "attn_cost_us": 37590.28118845298, "allreduce_cost_us": 1042.9227755776774, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [20], "total_batch_length": 70502, "total_latency_us": 89372, "mlp_cost_us": 32273.25439453125, "attn_cost_us": 56276.57511193636, "allreduce_cost_us": 823.1372615435038, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [18], "total_batch_length": 61207, "total_latency_us": 71005, "mlp_cost_us": 28018.341064453125, "attn_cost_us": 42266.74761492919, "allreduce_cost_us": 720.7461467003234, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [9, 10, 13], "total_batch_length": 88796, "total_latency_us": 88012, "mlp_cost_us": 40647.5830078125, "attn_cost_us": 46235.61481076745, "allreduce_cost_us": 1130.0029856728759, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [8, 12], "total_batch_length": 46514, "total_latency_us": 38677, "mlp_cost_us": 21292.41943359375, "attn_cost_us": 16776.503547716893, "allreduce_cost_us": 609.0485571195856, "allgather_cost_us": 0}, {"worker_id": 8, "assigned_docs": [11], "total_batch_length": 66573, "total_latency_us": 81301, "mlp_cost_us": 30474.700927734375, "attn_cost_us": 50037.503784906956, "allreduce_cost_us": 789.0769907611343, "allgather_cost_us": 0}, {"worker_id": 9, "assigned_docs": [7], "total_batch_length": 57240, "total_latency_us": 63837, "mlp_cost_us": 26202.392578125, "attn_cost_us": 36968.17573139491, "allreduce_cost_us": 667.0180136944196, "allgather_cost_us": 0}, {"worker_id": 10, "assigned_docs": [6], "total_batch_length": 64608, "total_latency_us": 77434, "mlp_cost_us": 29575.1953125, "attn_cost_us": 47091.585408020575, "allreduce_cost_us": 767.2449246356181, "allgather_cost_us": 0}, {"worker_id": 11, "assigned_docs": [4, 5], "total_batch_length": 78217, "total_latency_us": 94237, "mlp_cost_us": 35804.901123046875, "attn_cost_us": 57426.18470810958, "allreduce_cost_us": 1007.0005027989916, "allgather_cost_us": 0}, {"worker_id": 12, "assigned_docs": [3], "total_batch_length": 33216, "total_latency_us": 28016, "mlp_cost_us": 15205.078125, "attn_cost_us": 12456.16498464768, "allreduce_cost_us": 355.53809255314735, "allgather_cost_us": 0}, {"worker_id": 13, "assigned_docs": [2], "total_batch_length": 46893, "total_latency_us": 46812, "mlp_cost_us": 21465.911865234375, "attn_cost_us": 24816.492375381982, "allreduce_cost_us": 529.6967921630227, "allgather_cost_us": 0}, {"worker_id": 14, "assigned_docs": [23], "total_batch_length": 74115, "total_latency_us": 97126, "mlp_cost_us": 33927.154541015625, "attn_cost_us": 62345.48705996466, "allreduce_cost_us": 854.0196450318422, "allgather_cost_us": 0}, {"worker_id": 15, "assigned_docs": [0, 1], "total_batch_length": 76034, "total_latency_us": 80104, "mlp_cost_us": 34805.60302734375, "attn_cost_us": 44375.61409418745, "allreduce_cost_us": 923.8319226492822, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 15, "attn_time_us": 41673.91084783327, "mlp_time_us": 27821.044921875, "allgather_time_us": 0, "allreduce_time_us": 714.8817699797066, "total_latency_us": 70209}, {"doc_id": 1, "doc_len": 15258, "worker_id": 15, "attn_time_us": 2701.703246354173, "mlp_time_us": 6984.55810546875, "allgather_time_us": 0, "allreduce_time_us": 208.95015266957554, "total_latency_us": 9895}, {"doc_id": 2, "doc_len": 46893, "worker_id": 13, "attn_time_us": 24816.492375381982, "mlp_time_us": 21465.911865234375, "allgather_time_us": 0, "allreduce_time_us": 529.6967921630227, "total_latency_us": 46812}, {"doc_id": 3, "doc_len": 33216, "worker_id": 12, "attn_time_us": 12456.16498464768, "mlp_time_us": 15205.078125, "allgather_time_us": 0, "allreduce_time_us": 355.53809255314735, "total_latency_us": 28016}, {"doc_id": 4, "doc_len": 7431, "worker_id": 11, "attn_time_us": 684.0801584795776, "mlp_time_us": 3401.641845703125, "allgather_time_us": 0, "allreduce_time_us": 181.42089843749994, "total_latency_us": 4267}, {"doc_id": 5, "doc_len": 70786, "worker_id": 11, "attn_time_us": 56742.10454963, "mlp_time_us": 32403.25927734375, "allgather_time_us": 0, "allreduce_time_us": 825.5796043614916, "total_latency_us": 89970}, {"doc_id": 6, "doc_len": 64608, "worker_id": 10, "attn_time_us": 47091.585408020575, "mlp_time_us": 29575.1953125, "allgather_time_us": 0, "allreduce_time_us": 767.2449246356181, "total_latency_us": 77434}, {"doc_id": 7, "doc_len": 57240, "worker_id": 9, "attn_time_us": 36968.17573139491, "mlp_time_us": 26202.392578125, "allgather_time_us": 0, "allreduce_time_us": 667.0180136944196, "total_latency_us": 63837}, {"doc_id": 8, "doc_len": 9138, "worker_id": 7, "attn_time_us": 1006.9732247113694, "mlp_time_us": 4183.04443359375, "allgather_time_us": 0, "allreduce_time_us": 201.54441055761754, "total_latency_us": 5391}, {"doc_id": 9, "doc_len": 14084, "worker_id": 6, "attn_time_us": 2315.7857428373727, "mlp_time_us": 6447.1435546875, "allgather_time_us": 0, "allreduce_time_us": 207.77588635661948, "total_latency_us": 8970}, {"doc_id": 10, "doc_len": 13958, "worker_id": 6, "attn_time_us": 2276.06677593347, "mlp_time_us": 6389.46533203125, "allgather_time_us": 0, "allreduce_time_us": 207.644497331791, "total_latency_us": 8873}, {"doc_id": 11, "doc_len": 66573, "worker_id": 8, "attn_time_us": 50037.503784906956, "mlp_time_us": 30474.700927734375, "allgather_time_us": 0, "allreduce_time_us": 789.0769907611343, "total_latency_us": 81301}, {"doc_id": 12, "doc_len": 37376, "worker_id": 7, "attn_time_us": 15769.530323005525, "mlp_time_us": 17109.375, "allgather_time_us": 0, "allreduce_time_us": 407.504146561968, "total_latency_us": 33286}, {"doc_id": 13, "doc_len": 60754, "worker_id": 6, "attn_time_us": 41643.76229199661, "mlp_time_us": 27810.97412109375, "allgather_time_us": 0, "allreduce_time_us": 714.5826019844654, "total_latency_us": 70169}, {"doc_id": 14, "doc_len": 16561, "worker_id": 3, "attn_time_us": 3164.831418275334, "mlp_time_us": 7581.024169921875, "allgather_time_us": 0, "allreduce_time_us": 211.66957194989644, "total_latency_us": 10957}, {"doc_id": 15, "doc_len": 8227, "worker_id": 3, "attn_time_us": 822.6482024584512, "mlp_time_us": 3766.021728515625, "allgather_time_us": 0, "allreduce_time_us": 200.06002801404227, "total_latency_us": 4788}, {"doc_id": 16, "doc_len": 32713, "worker_id": 0, "attn_time_us": 12082.596880372033, "mlp_time_us": 14974.822998046875, "allgather_time_us": 0, "allreduce_time_us": 349.5669640639302, "total_latency_us": 27406}, {"doc_id": 17, "doc_len": 7902, "worker_id": 2, "attn_time_us": 764.4586168173399, "mlp_time_us": 3617.24853515625, "allgather_time_us": 0, "allreduce_time_us": 192.91992187499994, "total_latency_us": 4574}, {"doc_id": 18, "doc_len": 61207, "worker_id": 5, "attn_time_us": 42266.74761492919, "mlp_time_us": 28018.341064453125, "allgather_time_us": 0, "allreduce_time_us": 720.7461467003234, "total_latency_us": 71005}, {"doc_id": 19, "doc_len": 23509, "worker_id": 0, "attn_time_us": 6306.3528600002655, "mlp_time_us": 10761.566162109375, "allgather_time_us": 0, "allreduce_time_us": 274.02234407689997, "total_latency_us": 17341}, {"doc_id": 20, "doc_len": 70502, "worker_id": 4, "attn_time_us": 56276.57511193636, "mlp_time_us": 32273.25439453125, "allgather_time_us": 0, "allreduce_time_us": 823.1372615435038, "total_latency_us": 89372}, {"doc_id": 21, "doc_len": 17053, "worker_id": 1, "attn_time_us": 3352.5270974851105, "mlp_time_us": 7806.243896484375, "allgather_time_us": 0, "allreduce_time_us": 216.28598822825097, "total_latency_us": 11375}, {"doc_id": 22, "doc_len": 54571, "worker_id": 3, "attn_time_us": 33602.801567719194, "mlp_time_us": 24980.621337890625, "allgather_time_us": 0, "allreduce_time_us": 631.1931756137386, "total_latency_us": 59214}, {"doc_id": 23, "doc_len": 74115, "worker_id": 14, "attn_time_us": 62345.48705996466, "mlp_time_us": 33927.154541015625, "allgather_time_us": 0, "allreduce_time_us": 854.0196450318422, "total_latency_us": 97126}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 33008.49098752858, "mlp_time_us": 24758.60595703125, "allgather_time_us": 0, "allreduce_time_us": 624.7121672769707, "total_latency_us": 58391}, {"doc_id": 25, "doc_len": 8083, "worker_id": 0, "attn_time_us": 796.4044414195592, "mlp_time_us": 3700.103759765625, "allgather_time_us": 0, "allreduce_time_us": 197.3388671874999, "total_latency_us": 4693}, {"doc_id": 26, "doc_len": 14760, "worker_id": 0, "attn_time_us": 2534.5119625075217, "mlp_time_us": 6756.591796875, "allgather_time_us": 0, "allreduce_time_us": 208.4626692553447, "total_latency_us": 9499}, {"doc_id": 27, "doc_len": 8420, "worker_id": 0, "attn_time_us": 860.2034715329819, "mlp_time_us": 3854.3701171875, "allgather_time_us": 0, "allreduce_time_us": 200.38683580973043, "total_latency_us": 4914}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 941.2154745538863, "mlp_time_us": 4038.848876953125, "allgather_time_us": 0, "allreduce_time_us": 201.04736514460106, "total_latency_us": 5181}, {"doc_id": 29, "doc_len": 29953, "worker_id": 0, "attn_time_us": 10158.389211218013, "mlp_time_us": 13711.395263671875, "allgather_time_us": 0, "allreduce_time_us": 327.58145312361154, "total_latency_us": 24197}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 41673.91084783327, "mlp_time": 27821.044921875, "allgather_time": 0, "allreduce_time": 714.8817699797066}, "1": {"doc_len": 15258, "attn_time": 2701.703246354173, "mlp_time": 6984.55810546875, "allgather_time": 0, "allreduce_time": 208.95015266957554}, "2": {"doc_len": 46893, "attn_time": 24816.492375381982, "mlp_time": 21465.911865234375, "allgather_time": 0, "allreduce_time": 529.6967921630227}, "3": {"doc_len": 33216, "attn_time": 12456.16498464768, "mlp_time": 15205.078125, "allgather_time": 0, "allreduce_time": 355.53809255314735}, "4": {"doc_len": 7431, "attn_time": 684.0801584795776, "mlp_time": 3401.641845703125, "allgather_time": 0, "allreduce_time": 181.42089843749994}, "5": {"doc_len": 70786, "attn_time": 56742.10454963, "mlp_time": 32403.25927734375, "allgather_time": 0, "allreduce_time": 825.5796043614916}, "6": {"doc_len": 64608, "attn_time": 47091.585408020575, "mlp_time": 29575.1953125, "allgather_time": 0, "allreduce_time": 767.2449246356181}, "7": {"doc_len": 57240, "attn_time": 36968.17573139491, "mlp_time": 26202.392578125, "allgather_time": 0, "allreduce_time": 667.0180136944196}, "8": {"doc_len": 9138, "attn_time": 1006.9732247113694, "mlp_time": 4183.04443359375, "allgather_time": 0, "allreduce_time": 201.54441055761754}, "9": {"doc_len": 14084, "attn_time": 2315.7857428373727, "mlp_time": 6447.1435546875, "allgather_time": 0, "allreduce_time": 207.77588635661948}, "10": {"doc_len": 13958, "attn_time": 2276.06677593347, "mlp_time": 6389.46533203125, "allgather_time": 0, "allreduce_time": 207.644497331791}, "11": {"doc_len": 66573, "attn_time": 50037.503784906956, "mlp_time": 30474.700927734375, "allgather_time": 0, "allreduce_time": 789.0769907611343}, "12": {"doc_len": 37376, "attn_time": 15769.530323005525, "mlp_time": 17109.375, "allgather_time": 0, "allreduce_time": 407.504146561968}, "13": {"doc_len": 60754, "attn_time": 41643.76229199661, "mlp_time": 27810.97412109375, "allgather_time": 0, "allreduce_time": 714.5826019844654}, "14": {"doc_len": 16561, "attn_time": 3164.831418275334, "mlp_time": 7581.024169921875, "allgather_time": 0, "allreduce_time": 211.66957194989644}, "15": {"doc_len": 8227, "attn_time": 822.6482024584512, "mlp_time": 3766.021728515625, "allgather_time": 0, "allreduce_time": 200.06002801404227}, "16": {"doc_len": 32713, "attn_time": 12082.596880372033, "mlp_time": 14974.822998046875, "allgather_time": 0, "allreduce_time": 349.5669640639302}, "17": {"doc_len": 7902, "attn_time": 764.4586168173399, "mlp_time": 3617.24853515625, "allgather_time": 0, "allreduce_time": 192.91992187499994}, "18": {"doc_len": 61207, "attn_time": 42266.74761492919, "mlp_time": 28018.341064453125, "allgather_time": 0, "allreduce_time": 720.7461467003234}, "19": {"doc_len": 23509, "attn_time": 6306.3528600002655, "mlp_time": 10761.566162109375, "allgather_time": 0, "allreduce_time": 274.02234407689997}, "20": {"doc_len": 70502, "attn_time": 56276.57511193636, "mlp_time": 32273.25439453125, "allgather_time": 0, "allreduce_time": 823.1372615435038}, "21": {"doc_len": 17053, "attn_time": 3352.5270974851105, "mlp_time": 7806.243896484375, "allgather_time": 0, "allreduce_time": 216.28598822825097}, "22": {"doc_len": 54571, "attn_time": 33602.801567719194, "mlp_time": 24980.621337890625, "allgather_time": 0, "allreduce_time": 631.1931756137386}, "23": {"doc_len": 74115, "attn_time": 62345.48705996466, "mlp_time": 33927.154541015625, "allgather_time": 0, "allreduce_time": 854.0196450318422}, "24": {"doc_len": 54086, "attn_time": 33008.49098752858, "mlp_time": 24758.60595703125, "allgather_time": 0, "allreduce_time": 624.7121672769707}, "25": {"doc_len": 8083, "attn_time": 796.4044414195592, "mlp_time": 3700.103759765625, "allgather_time": 0, "allreduce_time": 197.3388671874999}, "26": {"doc_len": 14760, "attn_time": 2534.5119625075217, "mlp_time": 6756.591796875, "allgather_time": 0, "allreduce_time": 208.4626692553447}, "27": {"doc_len": 8420, "attn_time": 860.2034715329819, "mlp_time": 3854.3701171875, "allgather_time": 0, "allreduce_time": 200.38683580973043}, "28": {"doc_len": 8823, "attn_time": 941.2154745538863, "mlp_time": 4038.848876953125, "allgather_time": 0, "allreduce_time": 201.04736514460106}, "29": {"doc_len": 29953, "attn_time": 10158.389211218013, "mlp_time": 13711.395263671875, "allgather_time": 0, "allreduce_time": 327.58145312361154}}}, "attnserver_result": {"batch_total_time": 69478.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 1560.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 4, "mlp_cp": 1}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 2, "dp": 8, "ratio": 1.006853422427825, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 70038, "worker_latencies_us": [69941, 68512, 69767, 69624, 70038, 69866, 69957, 69820], "doc2worker": {"0": 7, "1": 6, "2": 6, "3": 5, "4": 4, "5": 5, "6": 3, "7": 4, "8": 5, "9": 7, "10": 5, "11": 6, "12": 3, "13": 4, "14": 2, "15": 2, "16": 2, "17": 3, "18": 1, "19": 0, "20": 2, "21": 3, "22": 1, "23": 0, "24": 7, "25": 2, "26": 3, "27": 1, "28": 5, "29": 0}, "latency_breakdown": {"max_worker_latency_us": 70038, "worker_latencies_us": [69941, 68512, 69767, 69624, 70038, 69866, 69957, 69820], "solver_status": "OPTIMAL", "solved_time_s": 9.157635688781738, "num_vars": 249, "num_cons": 54}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [19, 23, 29], "total_batch_length": 127577, "total_latency_us": 69941, "mlp_cost_us": 29200.057983398438, "attn_cost_us": 39128.37321287337, "allreduce_cost_us": 1455.6234422323537, "allgather_cost_us": 157.7107298374176}, {"worker_id": 1, "assigned_docs": [18, 22, 27], "total_batch_length": 124198, "total_latency_us": 68512, "mlp_cost_us": 28426.666259765625, "attn_cost_us": 38381.5998683303, "allreduce_cost_us": 1552.3261581237923, "allgather_cost_us": 153.53360891342163}, {"worker_id": 2, "assigned_docs": [14, 15, 16, 20, 25], "total_batch_length": 136086, "total_latency_us": 69767, "mlp_cost_us": 31147.613525390625, "attn_cost_us": 36673.069363483395, "allreduce_cost_us": 1781.7726927588728, "allgather_cost_us": 168.229558467865}, {"worker_id": 3, "assigned_docs": [6, 12, 17, 21, 26], "total_batch_length": 141699, "total_latency_us": 69624, "mlp_cost_us": 32432.327270507812, "attn_cost_us": 35227.69289180796, "allreduce_cost_us": 1792.4176505561818, "allgather_cost_us": 175.1683509349823}, {"worker_id": 4, "assigned_docs": [4, 7, 13], "total_batch_length": 125425, "total_latency_us": 70038, "mlp_cost_us": 28707.504272460938, "attn_cost_us": 39614.44800170009, "allreduce_cost_us": 1563.0215141163849, "allgather_cost_us": 155.05042672157288}, {"worker_id": 5, "assigned_docs": [3, 5, 8, 10, 28], "total_batch_length": 135921, "total_latency_us": 69866, "mlp_cost_us": 31109.848022460938, "attn_cost_us": 36801.05664104272, "allreduce_cost_us": 1791.3539699486487, "allgather_cost_us": 168.02558541297913}, {"worker_id": 6, "assigned_docs": [1, 2, 11], "total_batch_length": 128724, "total_latency_us": 69957, "mlp_cost_us": 29462.58544921875, "attn_cost_us": 38809.36670508004, "allreduce_cost_us": 1527.7239355937327, "allgather_cost_us": 159.12865161895752}, {"worker_id": 7, "assigned_docs": [0, 9, 24], "total_batch_length": 128946, "total_latency_us": 69820, "mlp_cost_us": 29513.397216796875, "attn_cost_us": 38600.65647066734, "allreduce_cost_us": 1547.3698236132968, "allgather_cost_us": 159.40308809280396}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 7, "attn_time_us": 20731.932894014863, "mlp_time_us": 13910.5224609375, "allgather_time_us": 75.13131141662598, "allreduce_time_us": 714.8817699797066, "total_latency_us": 35432}, {"doc_id": 1, "doc_len": 15258, "worker_id": 6, "attn_time_us": 1537.7804242496668, "mlp_time_us": 3492.279052734375, "allgather_time_us": 18.861944675445557, "allreduce_time_us": 208.95015266957554, "total_latency_us": 5257}, {"doc_id": 2, "doc_len": 46893, "worker_id": 6, "attn_time_us": 12532.70988866313, "mlp_time_us": 10732.955932617188, "allgather_time_us": 57.96914219856262, "allreduce_time_us": 529.6967921630227, "total_latency_us": 23853}, {"doc_id": 3, "doc_len": 33216, "worker_id": 5, "attn_time_us": 6417.573923248309, "mlp_time_us": 7602.5390625, "allgather_time_us": 41.06163024902344, "allreduce_time_us": 355.53809255314735, "total_latency_us": 14416}, {"doc_id": 4, "doc_len": 7431, "worker_id": 4, "attn_time_us": 442.1353481280947, "mlp_time_us": 1700.8209228515625, "allgather_time_us": 9.186204671859741, "allreduce_time_us": 181.42089843749994, "total_latency_us": 2333}, {"doc_id": 5, "doc_len": 70786, "worker_id": 5, "attn_time_us": 27854.23940312051, "mlp_time_us": 16201.629638671875, "allgather_time_us": 87.50567674636841, "allreduce_time_us": 825.5796043614916, "total_latency_us": 44968}, {"doc_id": 6, "doc_len": 64608, "worker_id": 3, "attn_time_us": 23344.22425843067, "mlp_time_us": 14787.59765625, "allgather_time_us": 79.8684310913086, "allreduce_time_us": 767.2449246356181, "total_latency_us": 38978}, {"doc_id": 7, "doc_len": 57240, "worker_id": 4, "attn_time_us": 18454.94323139414, "mlp_time_us": 13101.1962890625, "allgather_time_us": 70.76010704040526, "allreduce_time_us": 667.0180136944196, "total_latency_us": 32293}, {"doc_id": 8, "doc_len": 9138, "worker_id": 5, "attn_time_us": 625.6076113906161, "mlp_time_us": 2091.522216796875, "allgather_time_us": 11.296398639678955, "allreduce_time_us": 201.54441055761754, "total_latency_us": 2929}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 1336.2691875804232, "mlp_time_us": 3223.57177734375, "allgather_time_us": 17.410645484924316, "allreduce_time_us": 207.77588635661948, "total_latency_us": 4785}, {"doc_id": 10, "doc_len": 13958, "worker_id": 5, "attn_time_us": 1315.3676886638589, "mlp_time_us": 3194.732666015625, "allgather_time_us": 17.254884243011475, "allreduce_time_us": 207.644497331791, "total_latency_us": 4734}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 24738.876392167243, "mlp_time_us": 15237.350463867188, "allgather_time_us": 82.29756474494933, "allreduce_time_us": 789.0769907611343, "total_latency_us": 40847}, {"doc_id": 12, "doc_len": 37376, "worker_id": 3, "attn_time_us": 8069.274303227303, "mlp_time_us": 8554.6875, "allgather_time_us": 46.2042236328125, "allreduce_time_us": 407.504146561968, "total_latency_us": 17077}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857, "mlp_time_us": 13905.487060546875, "allgather_time_us": 75.10411500930786, "allreduce_time_us": 714.5826019844654, "total_latency_us": 35412}, {"doc_id": 14, "doc_len": 16561, "worker_id": 2, "attn_time_us": 1777.2241522200052, "mlp_time_us": 3790.5120849609375, "allgather_time_us": 20.47271370887756, "allreduce_time_us": 211.66957194989644, "total_latency_us": 5799}, {"doc_id": 15, "doc_len": 8227, "worker_id": 2, "attn_time_us": 520.3412561592487, "mlp_time_us": 1883.0108642578125, "allgather_time_us": 10.170220136642454, "allreduce_time_us": 200.06002801404227, "total_latency_us": 2613}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397, "mlp_time_us": 7487.4114990234375, "allgather_time_us": 40.43982148170471, "allreduce_time_us": 349.5669640639302, "total_latency_us": 14108}, {"doc_id": 17, "doc_len": 7902, "worker_id": 3, "attn_time_us": 487.63265598040385, "mlp_time_us": 1808.624267578125, "allgather_time_us": 9.768455028533934, "allreduce_time_us": 192.91992187499994, "total_latency_us": 2498}, {"doc_id": 18, "doc_len": 61207, "worker_id": 1, "attn_time_us": 21018.245068857104, "mlp_time_us": 14009.170532226562, "allgather_time_us": 75.6641137599945, "allreduce_time_us": 720.7461467003234, "total_latency_us": 35823}, {"doc_id": 19, "doc_len": 23509, "worker_id": 0, "attn_time_us": 3389.552065012025, "mlp_time_us": 5380.7830810546875, "allgather_time_us": 29.06183362007141, "allreduce_time_us": 274.02234407689997, "total_latency_us": 9073}, {"doc_id": 20, "doc_len": 70502, "worker_id": 2, "attn_time_us": 27638.630568300454, "mlp_time_us": 16136.627197265625, "allgather_time_us": 87.1545958518982, "allreduce_time_us": 823.1372615435038, "total_latency_us": 44685}, {"doc_id": 21, "doc_len": 17053, "worker_id": 3, "attn_time_us": 1875.7453543506756, "mlp_time_us": 3903.1219482421875, "allgather_time_us": 21.08092427253723, "allreduce_time_us": 216.28598822825097, "total_latency_us": 6016}, {"doc_id": 22, "doc_len": 54571, "worker_id": 1, "attn_time_us": 16821.409731364707, "mlp_time_us": 12490.310668945312, "allgather_time_us": 67.46068835258482, "allreduce_time_us": 631.1931756137386, "total_latency_us": 30010}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 30441.798818474155, "mlp_time_us": 16963.577270507812, "allgather_time_us": 91.62098765373229, "allreduce_time_us": 854.0196450318422, "total_latency_us": 48351}, {"doc_id": 24, "doc_len": 54086, "worker_id": 7, "attn_time_us": 16532.45438907205, "mlp_time_us": 12379.302978515625, "allgather_time_us": 66.86113119125366, "allreduce_time_us": 624.7121672769707, "total_latency_us": 29603}, {"doc_id": 25, "doc_len": 8083, "worker_id": 2, "attn_time_us": 505.55506445529664, "mlp_time_us": 1850.0518798828125, "allgather_time_us": 9.992207288742064, "allreduce_time_us": 197.3388671874999, "total_latency_us": 2562}, {"doc_id": 26, "doc_len": 14760, "worker_id": 3, "attn_time_us": 1450.8163198189072, "mlp_time_us": 3378.2958984375, "allgather_time_us": 18.246316909790036, "allreduce_time_us": 208.4626692553447, "total_latency_us": 5055}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887, "mlp_time_us": 1927.18505859375, "allgather_time_us": 10.408806800842285, "allreduce_time_us": 200.38683580973043, "total_latency_us": 2679}, {"doc_id": 28, "doc_len": 8823, "worker_id": 5, "attn_time_us": 588.2680146194227, "mlp_time_us": 2019.4244384765625, "allgather_time_us": 10.90699553489685, "allreduce_time_us": 201.04736514460106, "total_latency_us": 2819}, {"doc_id": 29, "doc_len": 29953, "worker_id": 0, "attn_time_us": 5297.022329387189, "mlp_time_us": 6855.6976318359375, "allgather_time_us": 37.02790856361389, "allreduce_time_us": 327.58145312361154, "total_latency_us": 12517}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 20731.932894014863, "mlp_time": 13910.5224609375, "allgather_time": 75.13131141662598, "allreduce_time": 714.8817699797066}, "1": {"doc_len": 15258, "attn_time": 1537.7804242496668, "mlp_time": 3492.279052734375, "allgather_time": 18.861944675445557, "allreduce_time": 208.95015266957554}, "2": {"doc_len": 46893, "attn_time": 12532.70988866313, "mlp_time": 10732.955932617188, "allgather_time": 57.96914219856262, "allreduce_time": 529.6967921630227}, "3": {"doc_len": 33216, "attn_time": 6417.573923248309, "mlp_time": 7602.5390625, "allgather_time": 41.06163024902344, "allreduce_time": 355.53809255314735}, "4": {"doc_len": 7431, "attn_time": 442.1353481280947, "mlp_time": 1700.8209228515625, "allgather_time": 9.186204671859741, "allreduce_time": 181.42089843749994}, "5": {"doc_len": 70786, "attn_time": 27854.23940312051, "mlp_time": 16201.629638671875, "allgather_time": 87.50567674636841, "allreduce_time": 825.5796043614916}, "6": {"doc_len": 64608, "attn_time": 23344.22425843067, "mlp_time": 14787.59765625, "allgather_time": 79.8684310913086, "allreduce_time": 767.2449246356181}, "7": {"doc_len": 57240, "attn_time": 18454.94323139414, "mlp_time": 13101.1962890625, "allgather_time": 70.76010704040526, "allreduce_time": 667.0180136944196}, "8": {"doc_len": 9138, "attn_time": 625.6076113906161, "mlp_time": 2091.522216796875, "allgather_time": 11.296398639678955, "allreduce_time": 201.54441055761754}, "9": {"doc_len": 14084, "attn_time": 1336.2691875804232, "mlp_time": 3223.57177734375, "allgather_time": 17.410645484924316, "allreduce_time": 207.77588635661948}, "10": {"doc_len": 13958, "attn_time": 1315.3676886638589, "mlp_time": 3194.732666015625, "allgather_time": 17.254884243011475, "allreduce_time": 207.644497331791}, "11": {"doc_len": 66573, "attn_time": 24738.876392167243, "mlp_time": 15237.350463867188, "allgather_time": 82.29756474494933, "allreduce_time": 789.0769907611343}, "12": {"doc_len": 37376, "attn_time": 8069.274303227303, "mlp_time": 8554.6875, "allgather_time": 46.2042236328125, "allreduce_time": 407.504146561968}, "13": {"doc_len": 60754, "attn_time": 20717.369422177857, "mlp_time": 13905.487060546875, "allgather_time": 75.10411500930786, "allreduce_time": 714.5826019844654}, "14": {"doc_len": 16561, "attn_time": 1777.2241522200052, "mlp_time": 3790.5120849609375, "allgather_time": 20.47271370887756, "allreduce_time": 211.66957194989644}, "15": {"doc_len": 8227, "attn_time": 520.3412561592487, "mlp_time": 1883.0108642578125, "allgather_time": 10.170220136642454, "allreduce_time": 200.06002801404227}, "16": {"doc_len": 32713, "attn_time": 6231.318322348397, "mlp_time": 7487.4114990234375, "allgather_time": 40.43982148170471, "allreduce_time": 349.5669640639302}, "17": {"doc_len": 7902, "attn_time": 487.63265598040385, "mlp_time": 1808.624267578125, "allgather_time": 9.768455028533934, "allreduce_time": 192.91992187499994}, "18": {"doc_len": 61207, "attn_time": 21018.245068857104, "mlp_time": 14009.170532226562, "allgather_time": 75.6641137599945, "allreduce_time": 720.7461467003234}, "19": {"doc_len": 23509, "attn_time": 3389.552065012025, "mlp_time": 5380.7830810546875, "allgather_time": 29.06183362007141, "allreduce_time": 274.02234407689997}, "20": {"doc_len": 70502, "attn_time": 27638.630568300454, "mlp_time": 16136.627197265625, "allgather_time": 87.1545958518982, "allreduce_time": 823.1372615435038}, "21": {"doc_len": 17053, "attn_time": 1875.7453543506756, "mlp_time": 3903.1219482421875, "allgather_time": 21.08092427253723, "allreduce_time": 216.28598822825097}, "22": {"doc_len": 54571, "attn_time": 16821.409731364707, "mlp_time": 12490.310668945312, "allgather_time": 67.46068835258482, "allreduce_time": 631.1931756137386}, "23": {"doc_len": 74115, "attn_time": 30441.798818474155, "mlp_time": 16963.577270507812, "allgather_time": 91.62098765373229, "allreduce_time": 854.0196450318422}, "24": {"doc_len": 54086, "attn_time": 16532.45438907205, "mlp_time": 12379.302978515625, "allgather_time": 66.86113119125366, "allreduce_time": 624.7121672769707}, "25": {"doc_len": 8083, "attn_time": 505.55506445529664, "mlp_time": 1850.0518798828125, "allgather_time": 9.992207288742064, "allreduce_time": 197.3388671874999}, "26": {"doc_len": 14760, "attn_time": 1450.8163198189072, "mlp_time": 3378.2958984375, "allgather_time": 18.246316909790036, "allreduce_time": 208.4626692553447}, "27": {"doc_len": 8420, "attn_time": 541.9450681084887, "mlp_time": 1927.18505859375, "allgather_time": 10.408806800842285, "allreduce_time": 200.38683580973043}, "28": {"doc_len": 8823, "attn_time": 588.2680146194227, "mlp_time": 2019.4244384765625, "allgather_time": 10.90699553489685, "allreduce_time": 201.04736514460106}, "29": {"doc_len": 29953, "attn_time": 5297.022329387189, "mlp_time": 6855.6976318359375, "allgather_time": 37.02790856361389, "allreduce_time": 327.58145312361154}}}, "attnserver_result": {"batch_total_time": 70518.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 2600.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 4, "mlp_cp": 2}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 4, "dp": 4, "ratio": 0.9827625895383949, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 73851, "worker_latencies_us": [73851, 73851, 73851, 73851], "doc2worker": {"0": 3, "1": 2, "2": 1, "3": 1, "4": 0, "5": 0, "6": 2, "7": 1, "8": 3, "9": 1, "10": 2, "11": 2, "12": 1, "13": 0, "14": 3, "15": 3, "16": 2, "17": 3, "18": 2, "19": 0, "20": 3, "21": 1, "22": 3, "23": 0, "24": 1, "25": 1, "26": 1, "27": 3, "28": 1, "29": 3}, "latency_breakdown": {"max_worker_latency_us": 73851, "worker_latencies_us": [73851, 73851, 73851, 73851], "solver_status": "OPTIMAL", "solved_time_s": 0.18239927291870117, "num_vars": 125, "num_cons": 42}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [4, 5, 13, 19, 23], "total_batch_length": 236595, "total_latency_us": 73851, "mlp_cost_us": 27076.148986816406, "attn_cost_us": 43601.99732227679, "allreduce_cost_us": 2849.6250938921994, "allgather_cost_us": 326.04196071624756}, {"worker_id": 1, "assigned_docs": [2, 3, 7, 9, 12, 21, 24, 25, 26, 28], "total_batch_length": 291614, "total_latency_us": 73851, "mlp_cost_us": 33372.57385253906, "attn_cost_us": 36466.598272790594, "allreduce_cost_us": 3615.3799884218442, "allgather_cost_us": 401.8614101409912}, {"worker_id": 2, "assigned_docs": [1, 6, 10, 11, 16, 18], "total_batch_length": 254317, "total_latency_us": 73851, "mlp_cost_us": 29104.270935058594, "attn_cost_us": 41355.715021483105, "allreduce_cost_us": 3043.229676162373, "allgather_cost_us": 350.46392917633057}, {"worker_id": 3, "assigned_docs": [0, 8, 14, 15, 17, 20, 22, 27, 29], "total_batch_length": 266050, "total_latency_us": 73851, "mlp_cost_us": 30447.006225585938, "attn_cost_us": 39538.60555035306, "allreduce_cost_us": 3503.374428466847, "allgather_cost_us": 366.63269996643066}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 3, "attn_time_us": 10936.708854096567, "mlp_time_us": 6955.26123046875, "allgather_time_us": 83.75293731689453, "allreduce_time_us": 714.8817699797066, "total_latency_us": 18690}, {"doc_id": 1, "doc_len": 15258, "worker_id": 2, "attn_time_us": 860.8003533683882, "mlp_time_us": 1746.1395263671875, "allgather_time_us": 21.026430130004883, "allreduce_time_us": 208.95015266957554, "total_latency_us": 2836}, {"doc_id": 2, "doc_len": 46893, "worker_id": 1, "attn_time_us": 6727.89515179676, "mlp_time_us": 5366.477966308594, "allgather_time_us": 64.62133884429933, "allreduce_time_us": 529.6967921630227, "total_latency_us": 12688}, {"doc_id": 3, "doc_len": 33216, "worker_id": 1, "attn_time_us": 3526.0976429635375, "mlp_time_us": 3801.26953125, "allgather_time_us": 45.77362060546875, "allreduce_time_us": 355.53809255314735, "total_latency_us": 7728}, {"doc_id": 4, "doc_len": 7431, "worker_id": 0, "attn_time_us": 261.89729067804507, "mlp_time_us": 850.4104614257812, "allgather_time_us": 10.24035930633545, "allreduce_time_us": 181.42089843749994, "total_latency_us": 1303}, {"doc_id": 5, "doc_len": 70786, "worker_id": 0, "attn_time_us": 14597.022571344341, "mlp_time_us": 8100.8148193359375, "allgather_time_us": 97.54731178283691, "allreduce_time_us": 825.5796043614916, "total_latency_us": 23620}, {"doc_id": 6, "doc_len": 64608, "worker_id": 2, "attn_time_us": 12264.147767723874, "mlp_time_us": 7393.798828125, "allgather_time_us": 89.03366088867188, "allreduce_time_us": 767.2449246356181, "total_latency_us": 20514}, {"doc_id": 7, "doc_len": 57240, "worker_id": 1, "attn_time_us": 9774.923170272443, "mlp_time_us": 6550.59814453125, "allgather_time_us": 78.88011932373047, "allreduce_time_us": 667.0180136944196, "total_latency_us": 17071}, {"doc_id": 8, "doc_len": 9138, "worker_id": 3, "attn_time_us": 363.2637158344594, "mlp_time_us": 1045.7611083984375, "allgather_time_us": 12.592706680297852, "allreduce_time_us": 201.54441055761754, "total_latency_us": 1623}, {"doc_id": 9, "doc_len": 14084, "worker_id": 1, "attn_time_us": 752.2931140123533, "mlp_time_us": 1611.785888671875, "allgather_time_us": 19.408588409423828, "allreduce_time_us": 207.77588635661948, "total_latency_us": 2591}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 741.0017351944763, "mlp_time_us": 1597.3663330078125, "allgather_time_us": 19.234952926635742, "allreduce_time_us": 207.644497331791, "total_latency_us": 2565}, {"doc_id": 11, "doc_len": 66573, "worker_id": 2, "attn_time_us": 12980.296504741471, "mlp_time_us": 7618.675231933594, "allgather_time_us": 91.74154758453369, "allreduce_time_us": 789.0769907611343, "total_latency_us": 21479}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 4398.509927037227, "mlp_time_us": 4277.34375, "allgather_time_us": 51.50634765625, "allreduce_time_us": 407.504146561968, "total_latency_us": 9134}, {"doc_id": 13, "doc_len": 60754, "worker_id": 0, "attn_time_us": 10929.292764106156, "mlp_time_us": 6952.7435302734375, "allgather_time_us": 83.72262001037598, "allreduce_time_us": 714.5826019844654, "total_latency_us": 18680}, {"doc_id": 14, "doc_len": 16561, "worker_id": 3, "attn_time_us": 989.590403539061, "mlp_time_us": 1895.2560424804688, "allgather_time_us": 22.822041511535645, "allreduce_time_us": 211.66957194989644, "total_latency_us": 3119}, {"doc_id": 15, "doc_len": 8227, "worker_id": 3, "attn_time_us": 304.416260322779, "mlp_time_us": 941.5054321289062, "allgather_time_us": 11.337294578552248, "allreduce_time_us": 200.06002801404227, "total_latency_us": 1457}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 3426.998926348645, "mlp_time_us": 3743.7057495117188, "allgather_time_us": 45.08045673370361, "allreduce_time_us": 349.5669640639302, "total_latency_us": 7565}, {"doc_id": 17, "doc_len": 7902, "worker_id": 3, "attn_time_us": 286.64910820530804, "mlp_time_us": 904.3121337890625, "allgather_time_us": 10.889425277709963, "allreduce_time_us": 192.91992187499994, "total_latency_us": 1394}, {"doc_id": 18, "doc_len": 61207, "worker_id": 2, "attn_time_us": 11082.469734106253, "mlp_time_us": 7004.585266113281, "allgather_time_us": 84.34688091278076, "allreduce_time_us": 720.7461467003234, "total_latency_us": 18892}, {"doc_id": 19, "doc_len": 23509, "worker_id": 0, "attn_time_us": 1875.370842158494, "mlp_time_us": 2690.3915405273438, "allgather_time_us": 32.396798133850105, "allreduce_time_us": 274.02234407689997, "total_latency_us": 4872}, {"doc_id": 20, "doc_len": 70502, "worker_id": 3, "attn_time_us": 14485.194426315213, "mlp_time_us": 8068.3135986328125, "allgather_time_us": 97.15594291687012, "allreduce_time_us": 823.1372615435038, "total_latency_us": 23473}, {"doc_id": 21, "doc_len": 17053, "worker_id": 1, "attn_time_us": 1043.892565885043, "mlp_time_us": 1951.5609741210938, "allgather_time_us": 23.500046730041507, "allreduce_time_us": 216.28598822825097, "total_latency_us": 3235}, {"doc_id": 22, "doc_len": 54571, "worker_id": 3, "attn_time_us": 8938.406614252573, "mlp_time_us": 6245.155334472656, "allgather_time_us": 75.2020788192749, "allreduce_time_us": 631.1931756137386, "total_latency_us": 15889}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 15938.41385398975, "mlp_time_us": 8481.788635253906, "allgather_time_us": 102.13487148284912, "allreduce_time_us": 854.0196450318422, "total_latency_us": 25376}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 8790.149142323775, "mlp_time_us": 6189.6514892578125, "allgather_time_us": 74.53372001647949, "allreduce_time_us": 624.7121672769707, "total_latency_us": 15679}, {"doc_id": 25, "doc_len": 8083, "worker_id": 1, "attn_time_us": 296.3490676789468, "mlp_time_us": 925.0259399414062, "allgather_time_us": 11.138854026794435, "allreduce_time_us": 197.3388671874999, "total_latency_us": 1429}, {"doc_id": 26, "doc_len": 14760, "worker_id": 1, "attn_time_us": 814.0488566442455, "mlp_time_us": 1689.14794921875, "allgather_time_us": 20.34015655517578, "allreduce_time_us": 208.4626692553447, "total_latency_us": 2731}, {"doc_id": 27, "doc_len": 8420, "worker_id": 3, "attn_time_us": 316.5301896818625, "mlp_time_us": 963.592529296875, "allgather_time_us": 11.603260040283203, "allreduce_time_us": 200.38683580973043, "total_latency_us": 1492}, {"doc_id": 28, "doc_len": 8823, "worker_id": 1, "attn_time_us": 342.4396341762643, "mlp_time_us": 1009.7122192382812, "allgather_time_us": 12.158617973327637, "allreduce_time_us": 201.04736514460106, "total_latency_us": 1565}, {"doc_id": 29, "doc_len": 29953, "worker_id": 3, "attn_time_us": 2917.8459781052343, "mlp_time_us": 3427.8488159179688, "allgather_time_us": 41.27701282501221, "allreduce_time_us": 327.58145312361154, "total_latency_us": 6714}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 10936.708854096567, "mlp_time": 6955.26123046875, "allgather_time": 83.75293731689453, "allreduce_time": 714.8817699797066}, "1": {"doc_len": 15258, "attn_time": 860.8003533683882, "mlp_time": 1746.1395263671875, "allgather_time": 21.026430130004883, "allreduce_time": 208.95015266957554}, "2": {"doc_len": 46893, "attn_time": 6727.89515179676, "mlp_time": 5366.477966308594, "allgather_time": 64.62133884429933, "allreduce_time": 529.6967921630227}, "3": {"doc_len": 33216, "attn_time": 3526.0976429635375, "mlp_time": 3801.26953125, "allgather_time": 45.77362060546875, "allreduce_time": 355.53809255314735}, "4": {"doc_len": 7431, "attn_time": 261.89729067804507, "mlp_time": 850.4104614257812, "allgather_time": 10.24035930633545, "allreduce_time": 181.42089843749994}, "5": {"doc_len": 70786, "attn_time": 14597.022571344341, "mlp_time": 8100.8148193359375, "allgather_time": 97.54731178283691, "allreduce_time": 825.5796043614916}, "6": {"doc_len": 64608, "attn_time": 12264.147767723874, "mlp_time": 7393.798828125, "allgather_time": 89.03366088867188, "allreduce_time": 767.2449246356181}, "7": {"doc_len": 57240, "attn_time": 9774.923170272443, "mlp_time": 6550.59814453125, "allgather_time": 78.88011932373047, "allreduce_time": 667.0180136944196}, "8": {"doc_len": 9138, "attn_time": 363.2637158344594, "mlp_time": 1045.7611083984375, "allgather_time": 12.592706680297852, "allreduce_time": 201.54441055761754}, "9": {"doc_len": 14084, "attn_time": 752.2931140123533, "mlp_time": 1611.785888671875, "allgather_time": 19.408588409423828, "allreduce_time": 207.77588635661948}, "10": {"doc_len": 13958, "attn_time": 741.0017351944763, "mlp_time": 1597.3663330078125, "allgather_time": 19.234952926635742, "allreduce_time": 207.644497331791}, "11": {"doc_len": 66573, "attn_time": 12980.296504741471, "mlp_time": 7618.675231933594, "allgather_time": 91.74154758453369, "allreduce_time": 789.0769907611343}, "12": {"doc_len": 37376, "attn_time": 4398.509927037227, "mlp_time": 4277.34375, "allgather_time": 51.50634765625, "allreduce_time": 407.504146561968}, "13": {"doc_len": 60754, "attn_time": 10929.292764106156, "mlp_time": 6952.7435302734375, "allgather_time": 83.72262001037598, "allreduce_time": 714.5826019844654}, "14": {"doc_len": 16561, "attn_time": 989.590403539061, "mlp_time": 1895.2560424804688, "allgather_time": 22.822041511535645, "allreduce_time": 211.66957194989644}, "15": {"doc_len": 8227, "attn_time": 304.416260322779, "mlp_time": 941.5054321289062, "allgather_time": 11.337294578552248, "allreduce_time": 200.06002801404227}, "16": {"doc_len": 32713, "attn_time": 3426.998926348645, "mlp_time": 3743.7057495117188, "allgather_time": 45.08045673370361, "allreduce_time": 349.5669640639302}, "17": {"doc_len": 7902, "attn_time": 286.64910820530804, "mlp_time": 904.3121337890625, "allgather_time": 10.889425277709963, "allreduce_time": 192.91992187499994}, "18": {"doc_len": 61207, "attn_time": 11082.469734106253, "mlp_time": 7004.585266113281, "allgather_time": 84.34688091278076, "allreduce_time": 720.7461467003234}, "19": {"doc_len": 23509, "attn_time": 1875.370842158494, "mlp_time": 2690.3915405273438, "allgather_time": 32.396798133850105, "allreduce_time": 274.02234407689997}, "20": {"doc_len": 70502, "attn_time": 14485.194426315213, "mlp_time": 8068.3135986328125, "allgather_time": 97.15594291687012, "allreduce_time": 823.1372615435038}, "21": {"doc_len": 17053, "attn_time": 1043.892565885043, "mlp_time": 1951.5609741210938, "allgather_time": 23.500046730041507, "allreduce_time": 216.28598822825097}, "22": {"doc_len": 54571, "attn_time": 8938.406614252573, "mlp_time": 6245.155334472656, "allgather_time": 75.2020788192749, "allreduce_time": 631.1931756137386}, "23": {"doc_len": 74115, "attn_time": 15938.41385398975, "mlp_time": 8481.788635253906, "allgather_time": 102.13487148284912, "allreduce_time": 854.0196450318422}, "24": {"doc_len": 54086, "attn_time": 8790.149142323775, "mlp_time": 6189.6514892578125, "allgather_time": 74.53372001647949, "allreduce_time": 624.7121672769707}, "25": {"doc_len": 8083, "attn_time": 296.3490676789468, "mlp_time": 925.0259399414062, "allgather_time": 11.138854026794435, "allreduce_time": 197.3388671874999}, "26": {"doc_len": 14760, "attn_time": 814.0488566442455, "mlp_time": 1689.14794921875, "allgather_time": 20.34015655517578, "allreduce_time": 208.4626692553447}, "27": {"doc_len": 8420, "attn_time": 316.5301896818625, "mlp_time": 963.592529296875, "allgather_time": 11.603260040283203, "allreduce_time": 200.38683580973043}, "28": {"doc_len": 8823, "attn_time": 342.4396341762643, "mlp_time": 1009.7122192382812, "allgather_time": 12.158617973327637, "allreduce_time": 201.04736514460106}, "29": {"doc_len": 29953, "attn_time": 2917.8459781052343, "mlp_time": 3427.8488159179688, "allgather_time": 41.27701282501221, "allreduce_time": 327.58145312361154}}}, "attnserver_result": {"batch_total_time": 72578.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 4660.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 4, "mlp_cp": 4}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 8, "dp": 2, "ratio": 0.9709097787024777, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 79305, "worker_latencies_us": [79305, 79305], "doc2worker": {"0": 0, "1": 1, "2": 0, "3": 1, "4": 1, "5": 0, "6": 0, "7": 1, "8": 1, "9": 0, "10": 0, "11": 0, "12": 1, "13": 1, "14": 0, "15": 1, "16": 1, "17": 1, "18": 0, "19": 1, "20": 1, "21": 1, "22": 1, "23": 0, "24": 1, "25": 1, "26": 1, "27": 1, "28": 1, "29": 1}, "latency_breakdown": {"max_worker_latency_us": 79305, "worker_latencies_us": [79305, 79305], "solver_status": "OPTIMAL", "solved_time_s": 0.035608530044555664, "num_vars": 63, "num_cons": 36}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [0, 2, 5, 6, 9, 10, 11, 14, 18, 23], "total_batch_length": 489561, "total_latency_us": 79305, "mlp_cost_us": 28012.90512084961, "attn_cost_us": 44713.47807728293, "allreduce_cost_us": 5828.335829271446, "allgather_cost_us": 754.8894327878952}, {"worker_id": 1, "assigned_docs": [1, 3, 4, 7, 8, 12, 13, 15, 16, 17, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29], "total_batch_length": 559015, "total_latency_us": 79305, "mlp_cost_us": 31987.09487915039, "attn_cost_us": 39284.31235474392, "allreduce_cost_us": 7183.273357671818, "allgather_cost_us": 861.9855672121048}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 0, "attn_time_us": 5611.829381476507, "mlp_time_us": 3477.630615234375, "allgather_time_us": 93.71490001678467, "allreduce_time_us": 714.8817699797066, "total_latency_us": 9898}, {"doc_id": 1, "doc_len": 15258, "worker_id": 1, "attn_time_us": 523.9204174783986, "mlp_time_us": 873.0697631835938, "allgather_time_us": 23.527411222457886, "allreduce_time_us": 208.95015266957554, "total_latency_us": 1629}, {"doc_id": 2, "doc_len": 46893, "worker_id": 0, "attn_time_us": 3561.269995859349, "mlp_time_us": 2683.238983154297, "allgather_time_us": 72.30770051479341, "allreduce_time_us": 529.6967921630227, "total_latency_us": 6846}, {"doc_id": 3, "doc_len": 33216, "worker_id": 1, "attn_time_us": 1945.2793522777968, "mlp_time_us": 1900.634765625, "allgather_time_us": 51.21814727783203, "allreduce_time_us": 355.53809255314735, "total_latency_us": 4252}, {"doc_id": 4, "doc_len": 7431, "worker_id": 1, "attn_time_us": 179.65944979525406, "mlp_time_us": 425.2052307128906, "allgather_time_us": 11.45839512348175, "allreduce_time_us": 181.42089843749994, "total_latency_us": 797}, {"doc_id": 5, "doc_len": 70786, "worker_id": 0, "attn_time_us": 7411.547482235762, "mlp_time_us": 4050.4074096679688, "allgather_time_us": 109.15004134178162, "allreduce_time_us": 825.5796043614916, "total_latency_us": 12396}, {"doc_id": 6, "doc_len": 64608, "worker_id": 0, "attn_time_us": 6246.983137701561, "mlp_time_us": 3696.8994140625, "allgather_time_us": 99.62373733520508, "allreduce_time_us": 767.2449246356181, "total_latency_us": 10810}, {"doc_id": 7, "doc_len": 57240, "worker_id": 1, "attn_time_us": 5051.884789891843, "mlp_time_us": 3275.299072265625, "allgather_time_us": 88.2624864578247, "allreduce_time_us": 667.0180136944196, "total_latency_us": 9082}, {"doc_id": 8, "doc_len": 9138, "worker_id": 1, "attn_time_us": 240.52796371408334, "mlp_time_us": 522.8805541992188, "allgather_time_us": 14.09054160118103, "allreduce_time_us": 201.54441055761754, "total_latency_us": 979}, {"doc_id": 9, "doc_len": 14084, "worker_id": 0, "attn_time_us": 463.94118086924016, "mlp_time_us": 805.8929443359375, "allgather_time_us": 21.717135906219482, "allreduce_time_us": 207.77588635661948, "total_latency_us": 1499}, {"doc_id": 10, "doc_len": 13958, "worker_id": 0, "attn_time_us": 457.6529784002987, "mlp_time_us": 798.6831665039062, "allgather_time_us": 21.522847414016724, "allreduce_time_us": 207.644497331791, "total_latency_us": 1485}, {"doc_id": 11, "doc_len": 66573, "worker_id": 0, "attn_time_us": 6598.469564963384, "mlp_time_us": 3809.337615966797, "allgather_time_us": 102.65371263027191, "allreduce_time_us": 789.0769907611343, "total_latency_us": 11299}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 2392.472483392879, "mlp_time_us": 2138.671875, "allgather_time_us": 57.63275146484375, "allreduce_time_us": 407.504146561968, "total_latency_us": 4996}, {"doc_id": 13, "doc_len": 60754, "worker_id": 1, "attn_time_us": 5608.267572747394, "mlp_time_us": 3476.3717651367188, "allgather_time_us": 93.6809766292572, "allreduce_time_us": 714.5826019844654, "total_latency_us": 9892}, {"doc_id": 14, "doc_len": 16561, "worker_id": 0, "attn_time_us": 594.5193699671378, "mlp_time_us": 947.6280212402344, "allgather_time_us": 25.536600947380066, "allreduce_time_us": 211.66957194989644, "total_latency_us": 1779}, {"doc_id": 15, "doc_len": 8227, "worker_id": 1, "attn_time_us": 205.0713718149633, "mlp_time_us": 470.7527160644531, "allgather_time_us": 12.68580496311188, "allreduce_time_us": 200.06002801404227, "total_latency_us": 888}, {"doc_id": 16, "doc_len": 32713, "worker_id": 1, "attn_time_us": 1894.0800507997526, "mlp_time_us": 1871.8528747558594, "allgather_time_us": 50.442535281181335, "allreduce_time_us": 349.5669640639302, "total_latency_us": 4165}, {"doc_id": 17, "doc_len": 7902, "worker_id": 1, "attn_time_us": 194.4881949431844, "mlp_time_us": 452.15606689453125, "allgather_time_us": 12.184664011001589, "allreduce_time_us": 192.91992187499994, "total_latency_us": 851}, {"doc_id": 18, "doc_len": 61207, "worker_id": 0, "attn_time_us": 5681.804351294031, "mlp_time_us": 3502.2926330566406, "allgather_time_us": 94.37949001789093, "allreduce_time_us": 720.7461467003234, "total_latency_us": 9999}, {"doc_id": 19, "doc_len": 23509, "worker_id": 1, "attn_time_us": 1079.3292232720862, "mlp_time_us": 1345.1957702636719, "allgather_time_us": 36.250223517417915, "allreduce_time_us": 274.02234407689997, "total_latency_us": 2734}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 7355.337730263202, "mlp_time_us": 4034.1567993164062, "allgather_time_us": 108.71212124824524, "allreduce_time_us": 823.1372615435038, "total_latency_us": 12321}, {"doc_id": 21, "doc_len": 17053, "worker_id": 1, "attn_time_us": 624.8969002675743, "mlp_time_us": 975.7804870605469, "allgather_time_us": 26.295251250267032, "allreduce_time_us": 216.28598822825097, "total_latency_us": 1843}, {"doc_id": 22, "doc_len": 54571, "worker_id": 1, "attn_time_us": 4646.087947997327, "mlp_time_us": 3122.577667236328, "allgather_time_us": 84.14696276187897, "allreduce_time_us": 631.1931756137386, "total_latency_us": 8484}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 8085.460634515663, "mlp_time_us": 4240.894317626953, "allgather_time_us": 114.28326666355133, "allreduce_time_us": 854.0196450318422, "total_latency_us": 13294}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 4573.9200341379965, "mlp_time_us": 3094.8257446289062, "allgather_time_us": 83.39910626411438, "allreduce_time_us": 624.7121672769707, "total_latency_us": 8376}, {"doc_id": 25, "doc_len": 8083, "worker_id": 1, "attn_time_us": 200.2562328122266, "mlp_time_us": 462.5129699707031, "allgather_time_us": 12.463760972023012, "allreduce_time_us": 197.3388671874999, "total_latency_us": 872}, {"doc_id": 26, "doc_len": 14760, "worker_id": 1, "attn_time_us": 498.1740679638904, "mlp_time_us": 844.573974609375, "allgather_time_us": 22.759509086608887, "allreduce_time_us": 208.4626692553447, "total_latency_us": 1573}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 212.42114045170894, "mlp_time_us": 481.7962646484375, "allgather_time_us": 12.983405590057373, "allreduce_time_us": 200.38683580973043, "total_latency_us": 907}, {"doc_id": 28, "doc_len": 8823, "worker_id": 1, "attn_time_us": 228.05030523757097, "mlp_time_us": 504.8561096191406, "allgather_time_us": 13.604820370674133, "allreduce_time_us": 201.04736514460106, "total_latency_us": 947}, {"doc_id": 29, "doc_len": 29953, "worker_id": 1, "attn_time_us": 1630.1871254847852, "mlp_time_us": 1713.9244079589844, "allgather_time_us": 46.186692118644714, "allreduce_time_us": 327.58145312361154, "total_latency_us": 3717}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 5611.829381476507, "mlp_time": 3477.630615234375, "allgather_time": 93.71490001678467, "allreduce_time": 714.8817699797066}, "1": {"doc_len": 15258, "attn_time": 523.9204174783986, "mlp_time": 873.0697631835938, "allgather_time": 23.527411222457886, "allreduce_time": 208.95015266957554}, "2": {"doc_len": 46893, "attn_time": 3561.269995859349, "mlp_time": 2683.238983154297, "allgather_time": 72.30770051479341, "allreduce_time": 529.6967921630227}, "3": {"doc_len": 33216, "attn_time": 1945.2793522777968, "mlp_time": 1900.634765625, "allgather_time": 51.21814727783203, "allreduce_time": 355.53809255314735}, "4": {"doc_len": 7431, "attn_time": 179.65944979525406, "mlp_time": 425.2052307128906, "allgather_time": 11.45839512348175, "allreduce_time": 181.42089843749994}, "5": {"doc_len": 70786, "attn_time": 7411.547482235762, "mlp_time": 4050.4074096679688, "allgather_time": 109.15004134178162, "allreduce_time": 825.5796043614916}, "6": {"doc_len": 64608, "attn_time": 6246.983137701561, "mlp_time": 3696.8994140625, "allgather_time": 99.62373733520508, "allreduce_time": 767.2449246356181}, "7": {"doc_len": 57240, "attn_time": 5051.884789891843, "mlp_time": 3275.299072265625, "allgather_time": 88.2624864578247, "allreduce_time": 667.0180136944196}, "8": {"doc_len": 9138, "attn_time": 240.52796371408334, "mlp_time": 522.8805541992188, "allgather_time": 14.09054160118103, "allreduce_time": 201.54441055761754}, "9": {"doc_len": 14084, "attn_time": 463.94118086924016, "mlp_time": 805.8929443359375, "allgather_time": 21.717135906219482, "allreduce_time": 207.77588635661948}, "10": {"doc_len": 13958, "attn_time": 457.6529784002987, "mlp_time": 798.6831665039062, "allgather_time": 21.522847414016724, "allreduce_time": 207.644497331791}, "11": {"doc_len": 66573, "attn_time": 6598.469564963384, "mlp_time": 3809.337615966797, "allgather_time": 102.65371263027191, "allreduce_time": 789.0769907611343}, "12": {"doc_len": 37376, "attn_time": 2392.472483392879, "mlp_time": 2138.671875, "allgather_time": 57.63275146484375, "allreduce_time": 407.504146561968}, "13": {"doc_len": 60754, "attn_time": 5608.267572747394, "mlp_time": 3476.3717651367188, "allgather_time": 93.6809766292572, "allreduce_time": 714.5826019844654}, "14": {"doc_len": 16561, "attn_time": 594.5193699671378, "mlp_time": 947.6280212402344, "allgather_time": 25.536600947380066, "allreduce_time": 211.66957194989644}, "15": {"doc_len": 8227, "attn_time": 205.0713718149633, "mlp_time": 470.7527160644531, "allgather_time": 12.68580496311188, "allreduce_time": 200.06002801404227}, "16": {"doc_len": 32713, "attn_time": 1894.0800507997526, "mlp_time": 1871.8528747558594, "allgather_time": 50.442535281181335, "allreduce_time": 349.5669640639302}, "17": {"doc_len": 7902, "attn_time": 194.4881949431844, "mlp_time": 452.15606689453125, "allgather_time": 12.184664011001589, "allreduce_time": 192.91992187499994}, "18": {"doc_len": 61207, "attn_time": 5681.804351294031, "mlp_time": 3502.2926330566406, "allgather_time": 94.37949001789093, "allreduce_time": 720.7461467003234}, "19": {"doc_len": 23509, "attn_time": 1079.3292232720862, "mlp_time": 1345.1957702636719, "allgather_time": 36.250223517417915, "allreduce_time": 274.02234407689997}, "20": {"doc_len": 70502, "attn_time": 7355.337730263202, "mlp_time": 4034.1567993164062, "allgather_time": 108.71212124824524, "allreduce_time": 823.1372615435038}, "21": {"doc_len": 17053, "attn_time": 624.8969002675743, "mlp_time": 975.7804870605469, "allgather_time": 26.295251250267032, "allreduce_time": 216.28598822825097}, "22": {"doc_len": 54571, "attn_time": 4646.087947997327, "mlp_time": 3122.577667236328, "allgather_time": 84.14696276187897, "allreduce_time": 631.1931756137386}, "23": {"doc_len": 74115, "attn_time": 8085.460634515663, "mlp_time": 4240.894317626953, "allgather_time": 114.28326666355133, "allreduce_time": 854.0196450318422}, "24": {"doc_len": 54086, "attn_time": 4573.9200341379965, "mlp_time": 3094.8257446289062, "allgather_time": 83.39910626411438, "allreduce_time": 624.7121672769707}, "25": {"doc_len": 8083, "attn_time": 200.2562328122266, "mlp_time": 462.5129699707031, "allgather_time": 12.463760972023012, "allreduce_time": 197.3388671874999}, "26": {"doc_len": 14760, "attn_time": 498.1740679638904, "mlp_time": 844.573974609375, "allgather_time": 22.759509086608887, "allreduce_time": 208.4626692553447}, "27": {"doc_len": 8420, "attn_time": 212.42114045170894, "mlp_time": 481.7962646484375, "allgather_time": 12.983405590057373, "allreduce_time": 200.38683580973043}, "28": {"doc_len": 8823, "attn_time": 228.05030523757097, "mlp_time": 504.8561096191406, "allgather_time": 13.604820370674133, "allreduce_time": 201.04736514460106}, "29": {"doc_len": 29953, "attn_time": 1630.1871254847852, "mlp_time": 1713.9244079589844, "allgather_time": 46.186692118644714, "allreduce_time": 327.58145312361154}}}, "attnserver_result": {"batch_total_time": 76998.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 9080.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 4, "mlp_cp": 8}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 1, "dp": 8, "ratio": 0.9693383690026577, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 71490, "worker_latencies_us": [71322, 71447, 71453, 71490, 70989, 71456, 71312, 71463], "doc2worker": {"0": 7, "1": 6, "2": 6, "3": 5, "4": 7, "5": 4, "6": 2, "7": 7, "8": 0, "9": 3, "10": 1, "11": 6, "12": 2, "13": 3, "14": 0, "15": 4, "16": 2, "17": 5, "18": 1, "19": 0, "20": 5, "21": 4, "22": 3, "23": 0, "24": 1, "25": 5, "26": 5, "27": 4, "28": 0, "29": 4}, "latency_breakdown": {"max_worker_latency_us": 71490, "worker_latencies_us": [71322, 71447, 71453, 71490, 70989, 71456, 71312, 71463], "solver_status": "OPTIMAL", "solved_time_s": 8.645013809204102, "num_vars": 249, "num_cons": 54}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [8, 14, 19, 23, 28], "total_batch_length": 132146, "total_latency_us": 71322, "mlp_cost_us": 30245.819091796875, "attn_cost_us": 37815.29496973799, "allreduce_cost_us": 3262.9824676460776, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [10, 18, 24], "total_batch_length": 129251, "total_latency_us": 71447, "mlp_cost_us": 29583.206176757812, "attn_cost_us": 39819.5234592002, "allreduce_cost_us": 2046.2232314582711, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [6, 12, 16], "total_batch_length": 134697, "total_latency_us": 71453, "mlp_cost_us": 30829.696655273438, "attn_cost_us": 38513.093975689255, "allreduce_cost_us": 2111.501454028612, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [9, 13, 22], "total_batch_length": 129409, "total_latency_us": 71490, "mlp_cost_us": 29619.369506835938, "attn_cost_us": 39826.14492058952, "allreduce_cost_us": 2046.2446674500611, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [5, 15, 21, 27, 29], "total_batch_length": 134439, "total_latency_us": 70989, "mlp_cost_us": 30770.645141601562, "attn_cost_us": 36928.67278249219, "allreduce_cost_us": 3292.0998847029296, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [3, 17, 20, 25, 26], "total_batch_length": 134463, "total_latency_us": 71456, "mlp_cost_us": 30776.138305664062, "attn_cost_us": 37380.91443403616, "allreduce_cost_us": 3300.8296565489113, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [1, 2, 11], "total_batch_length": 128724, "total_latency_us": 71312, "mlp_cost_us": 29462.58544921875, "attn_cost_us": 39806.57225189458, "allreduce_cost_us": 2044.6937929912183, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [0, 4, 7], "total_batch_length": 125447, "total_latency_us": 71463, "mlp_cost_us": 28712.539672851562, "attn_cost_us": 40700.20082878112, "allreduce_cost_us": 2052.4201135162853, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 7, "attn_time_us": 21362.230059934278, "mlp_time_us": 13910.5224609375, "allgather_time_us": 0, "allreduce_time_us": 708.9052522414017, "total_latency_us": 35981}, {"doc_id": 1, "doc_len": 15258, "worker_id": 6, "attn_time_us": 1426.5500789437074, "mlp_time_us": 3492.279052734375, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 5548}, {"doc_id": 2, "doc_len": 46893, "worker_id": 6, "attn_time_us": 12771.486016212519, "mlp_time_us": 10732.955932617188, "allgather_time_us": 0, "allreduce_time_us": 705.1531381379633, "total_latency_us": 24209}, {"doc_id": 3, "doc_len": 33216, "worker_id": 5, "attn_time_us": 6444.226804195547, "mlp_time_us": 7602.5390625, "allgather_time_us": 0, "allreduce_time_us": 700.1945481616709, "total_latency_us": 14746}, {"doc_id": 4, "doc_len": 7431, "worker_id": 7, "attn_time_us": 370.57878246598585, "mlp_time_us": 1700.8209228515625, "allgather_time_us": 0, "allreduce_time_us": 635.4786613667258, "total_latency_us": 2706}, {"doc_id": 5, "doc_len": 70786, "worker_id": 4, "attn_time_us": 28989.344967202964, "mlp_time_us": 16201.629638671875, "allgather_time_us": 0, "allreduce_time_us": 707.748131837706, "total_latency_us": 45898}, {"doc_id": 6, "doc_len": 64608, "worker_id": 2, "attn_time_us": 24116.840438960546, "mlp_time_us": 14787.59765625, "allgather_time_us": 0, "allreduce_time_us": 709.7928195069591, "total_latency_us": 39614}, {"doc_id": 7, "doc_len": 57240, "worker_id": 7, "attn_time_us": 18967.39198638085, "mlp_time_us": 13101.1962890625, "allgather_time_us": 0, "allreduce_time_us": 708.0361999081579, "total_latency_us": 32776}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 540.6662381562849, "mlp_time_us": 2091.522216796875, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 3262}, {"doc_id": 9, "doc_len": 14084, "worker_id": 3, "attn_time_us": 1225.9757545095392, "mlp_time_us": 3223.57177734375, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 5079}, {"doc_id": 10, "doc_len": 13958, "worker_id": 1, "attn_time_us": 1205.3017896459587, "mlp_time_us": 3194.732666015625, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 5030}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 25608.53615673835, "mlp_time_us": 15237.350463867188, "allgather_time_us": 0, "allreduce_time_us": 709.540654853255, "total_latency_us": 41555}, {"doc_id": 12, "doc_len": 37376, "worker_id": 2, "attn_time_us": 8143.7266792428745, "mlp_time_us": 8554.6875, "allgather_time_us": 0, "allreduce_time_us": 701.8873542534286, "total_latency_us": 17400}, {"doc_id": 13, "doc_len": 60754, "worker_id": 3, "attn_time_us": 21346.8937207326, "mlp_time_us": 13905.487060546875, "allgather_time_us": 0, "allreduce_time_us": 708.8999999541232, "total_latency_us": 35961}, {"doc_id": 14, "doc_len": 16561, "worker_id": 0, "attn_time_us": 1666.752120405233, "mlp_time_us": 3790.5120849609375, "allgather_time_us": 0, "allreduce_time_us": 631.0298301992497, "total_latency_us": 6088}, {"doc_id": 15, "doc_len": 8227, "worker_id": 4, "attn_time_us": 443.2136314011546, "mlp_time_us": 1883.0108642578125, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 2956}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6252.526857485835, "mlp_time_us": 7487.4114990234375, "allgather_time_us": 0, "allreduce_time_us": 699.8212802682243, "total_latency_us": 14439}, {"doc_id": 17, "doc_len": 7902, "worker_id": 5, "attn_time_us": 412.73265051464114, "mlp_time_us": 1808.624267578125, "allgather_time_us": 0, "allreduce_time_us": 632.0197847512702, "total_latency_us": 2853}, {"doc_id": 18, "doc_len": 61207, "worker_id": 1, "attn_time_us": 21663.784446618713, "mlp_time_us": 14009.170532226562, "allgather_time_us": 0, "allreduce_time_us": 709.007775420159, "total_latency_us": 36381}, {"doc_id": 19, "doc_len": 23509, "worker_id": 0, "attn_time_us": 3291.352710496357, "mlp_time_us": 5380.7830810546875, "allgather_time_us": 0, "allreduce_time_us": 665.5440351532947, "total_latency_us": 9337}, {"doc_id": 20, "doc_len": 70502, "worker_id": 5, "attn_time_us": 28754.78744617927, "mlp_time_us": 16136.627197265625, "allgather_time_us": 0, "allreduce_time_us": 707.8654308627424, "total_latency_us": 45599}, {"doc_id": 21, "doc_len": 17053, "worker_id": 4, "attn_time_us": 1764.2689830969184, "mlp_time_us": 3903.1219482421875, "allgather_time_us": 0, "allreduce_time_us": 633.84415939027, "total_latency_us": 6301}, {"doc_id": 22, "doc_len": 54571, "worker_id": 3, "attn_time_us": 17253.275445347383, "mlp_time_us": 12490.310668945312, "allgather_time_us": 0, "allreduce_time_us": 707.3446674959376, "total_latency_us": 30450}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 31810.585905679418, "mlp_time_us": 16963.577270507812, "allgather_time_us": 0, "allreduce_time_us": 706.4086022935329, "total_latency_us": 49480}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 16950.43722293553, "mlp_time_us": 12379.302978515625, "allgather_time_us": 0, "allreduce_time_us": 707.2154560381123, "total_latency_us": 30036}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 429.4483756543683, "mlp_time_us": 1850.0518798828125, "allgather_time_us": 0, "allreduce_time_us": 630.7498927732277, "total_latency_us": 2910}, {"doc_id": 26, "doc_len": 14760, "worker_id": 5, "attn_time_us": 1339.719157492334, "mlp_time_us": 3378.2958984375, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 5348}, {"doc_id": 27, "doc_len": 8420, "worker_id": 4, "attn_time_us": 463.09669247952326, "mlp_time_us": 1927.18505859375, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 3020}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 505.9379950006936, "mlp_time_us": 2019.4244384765625, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 3155}, {"doc_id": 29, "doc_len": 29953, "worker_id": 4, "attn_time_us": 5268.748508311629, "mlp_time_us": 6855.6976318359375, "allgather_time_us": 0, "allreduce_time_us": 690.507593474954, "total_latency_us": 12814}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 21362.230059934278, "mlp_time": 13910.5224609375, "allgather_time": 0, "allreduce_time": 708.9052522414017}, "1": {"doc_len": 15258, "attn_time": 1426.5500789437074, "mlp_time": 3492.279052734375, "allgather_time": 0, "allreduce_time": 630.0}, "2": {"doc_len": 46893, "attn_time": 12771.486016212519, "mlp_time": 10732.955932617188, "allgather_time": 0, "allreduce_time": 705.1531381379633}, "3": {"doc_len": 33216, "attn_time": 6444.226804195547, "mlp_time": 7602.5390625, "allgather_time": 0, "allreduce_time": 700.1945481616709}, "4": {"doc_len": 7431, "attn_time": 370.57878246598585, "mlp_time": 1700.8209228515625, "allgather_time": 0, "allreduce_time": 635.4786613667258}, "5": {"doc_len": 70786, "attn_time": 28989.344967202964, "mlp_time": 16201.629638671875, "allgather_time": 0, "allreduce_time": 707.748131837706}, "6": {"doc_len": 64608, "attn_time": 24116.840438960546, "mlp_time": 14787.59765625, "allgather_time": 0, "allreduce_time": 709.7928195069591}, "7": {"doc_len": 57240, "attn_time": 18967.39198638085, "mlp_time": 13101.1962890625, "allgather_time": 0, "allreduce_time": 708.0361999081579}, "8": {"doc_len": 9138, "attn_time": 540.6662381562849, "mlp_time": 2091.522216796875, "allgather_time": 0, "allreduce_time": 630.0}, "9": {"doc_len": 14084, "attn_time": 1225.9757545095392, "mlp_time": 3223.57177734375, "allgather_time": 0, "allreduce_time": 630.0}, "10": {"doc_len": 13958, "attn_time": 1205.3017896459587, "mlp_time": 3194.732666015625, "allgather_time": 0, "allreduce_time": 630.0}, "11": {"doc_len": 66573, "attn_time": 25608.53615673835, "mlp_time": 15237.350463867188, "allgather_time": 0, "allreduce_time": 709.540654853255}, "12": {"doc_len": 37376, "attn_time": 8143.7266792428745, "mlp_time": 8554.6875, "allgather_time": 0, "allreduce_time": 701.8873542534286}, "13": {"doc_len": 60754, "attn_time": 21346.8937207326, "mlp_time": 13905.487060546875, "allgather_time": 0, "allreduce_time": 708.8999999541232}, "14": {"doc_len": 16561, "attn_time": 1666.752120405233, "mlp_time": 3790.5120849609375, "allgather_time": 0, "allreduce_time": 631.0298301992497}, "15": {"doc_len": 8227, "attn_time": 443.2136314011546, "mlp_time": 1883.0108642578125, "allgather_time": 0, "allreduce_time": 630.0}, "16": {"doc_len": 32713, "attn_time": 6252.526857485835, "mlp_time": 7487.4114990234375, "allgather_time": 0, "allreduce_time": 699.8212802682243}, "17": {"doc_len": 7902, "attn_time": 412.73265051464114, "mlp_time": 1808.624267578125, "allgather_time": 0, "allreduce_time": 632.0197847512702}, "18": {"doc_len": 61207, "attn_time": 21663.784446618713, "mlp_time": 14009.170532226562, "allgather_time": 0, "allreduce_time": 709.007775420159}, "19": {"doc_len": 23509, "attn_time": 3291.352710496357, "mlp_time": 5380.7830810546875, "allgather_time": 0, "allreduce_time": 665.5440351532947}, "20": {"doc_len": 70502, "attn_time": 28754.78744617927, "mlp_time": 16136.627197265625, "allgather_time": 0, "allreduce_time": 707.8654308627424}, "21": {"doc_len": 17053, "attn_time": 1764.2689830969184, "mlp_time": 3903.1219482421875, "allgather_time": 0, "allreduce_time": 633.84415939027}, "22": {"doc_len": 54571, "attn_time": 17253.275445347383, "mlp_time": 12490.310668945312, "allgather_time": 0, "allreduce_time": 707.3446674959376}, "23": {"doc_len": 74115, "attn_time": 31810.585905679418, "mlp_time": 16963.577270507812, "allgather_time": 0, "allreduce_time": 706.4086022935329}, "24": {"doc_len": 54086, "attn_time": 16950.43722293553, "mlp_time": 12379.302978515625, "allgather_time": 0, "allreduce_time": 707.2154560381123}, "25": {"doc_len": 8083, "attn_time": 429.4483756543683, "mlp_time": 1850.0518798828125, "allgather_time": 0, "allreduce_time": 630.7498927732277}, "26": {"doc_len": 14760, "attn_time": 1339.719157492334, "mlp_time": 3378.2958984375, "allgather_time": 0, "allreduce_time": 630.0}, "27": {"doc_len": 8420, "attn_time": 463.09669247952326, "mlp_time": 1927.18505859375, "allgather_time": 0, "allreduce_time": 630.0}, "28": {"doc_len": 8823, "attn_time": 505.9379950006936, "mlp_time": 2019.4244384765625, "allgather_time": 0, "allreduce_time": 630.0}, "29": {"doc_len": 29953, "attn_time": 5268.748508311629, "mlp_time": 6855.6976318359375, "allgather_time": 0, "allreduce_time": 690.507593474954}}}, "attnserver_result": {"batch_total_time": 69298.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 1380.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 8, "mlp_cp": 1}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 2, "dp": 4, "ratio": 0.9328761844011216, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 75249, "worker_latencies_us": [75249, 75249, 75248, 75249], "doc2worker": {"0": 3, "1": 3, "2": 3, "3": 0, "4": 3, "5": 0, "6": 1, "7": 1, "8": 0, "9": 0, "10": 1, "11": 2, "12": 0, "13": 2, "14": 3, "15": 1, "16": 1, "17": 0, "18": 0, "19": 0, "20": 3, "21": 0, "22": 2, "23": 1, "24": 2, "25": 2, "26": 3, "27": 2, "28": 3, "29": 3}, "latency_breakdown": {"max_worker_latency_us": 75249, "worker_latencies_us": [75249, 75249, 75248, 75249], "solver_status": "OPTIMAL", "solved_time_s": 2.891289710998535, "num_vars": 125, "num_cons": 42}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [3, 5, 8, 9, 12, 17, 18, 19, 21], "total_batch_length": 274271, "total_latency_us": 75249, "mlp_cost_us": 31387.82501220703, "attn_cost_us": 37514.84827156425, "allreduce_cost_us": 6010.245788967799, "allgather_cost_us": 339.0539014339447}, {"worker_id": 1, "assigned_docs": [6, 7, 10, 15, 16, 23], "total_batch_length": 250861, "total_latency_us": 75249, "mlp_cost_us": 28708.763122558594, "attn_cost_us": 42148.234492777934, "allreduce_cost_us": 4084.058901976874, "allgather_cost_us": 310.11445164680475}, {"worker_id": 2, "assigned_docs": [11, 13, 22, 24, 25, 27], "total_batch_length": 252487, "total_latency_us": 75248, "mlp_cost_us": 28894.84405517578, "attn_cost_us": 41950.32137188749, "allreduce_cost_us": 4093.7506711146557, "allgather_cost_us": 312.12451338768}, {"worker_id": 3, "assigned_docs": [0, 1, 2, 4, 14, 20, 26, 28, 29], "total_batch_length": 270957, "total_latency_us": 75249, "mlp_cost_us": 31008.567810058594, "attn_cost_us": 37941.69001371902, "allreduce_cost_us": 5968.939906283037, "allgather_cost_us": 334.95713353157043}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 3, "attn_time_us": 10873.086340608235, "mlp_time_us": 6955.26123046875, "allgather_time_us": 75.13131141662598, "allreduce_time_us": 708.9052522414017, "total_latency_us": 18612}, {"doc_id": 1, "doc_len": 15258, "worker_id": 3, "attn_time_us": 828.3643190467537, "mlp_time_us": 1746.1395263671875, "allgather_time_us": 18.861944675445557, "allreduce_time_us": 630.0, "total_latency_us": 3223}, {"doc_id": 2, "doc_len": 46893, "worker_id": 3, "attn_time_us": 6653.380800639396, "mlp_time_us": 5366.477966308594, "allgather_time_us": 57.96914219856262, "allreduce_time_us": 705.1531381379633, "total_latency_us": 12782}, {"doc_id": 3, "doc_len": 33216, "worker_id": 0, "attn_time_us": 3462.542272972649, "mlp_time_us": 3801.26953125, "allgather_time_us": 41.06163024902344, "allreduce_time_us": 700.1945481616709, "total_latency_us": 8005}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 243.71623750651025, "mlp_time_us": 850.4104614257812, "allgather_time_us": 9.186204671859741, "allreduce_time_us": 635.4786613667258, "total_latency_us": 1738}, {"doc_id": 5, "doc_len": 70786, "worker_id": 0, "attn_time_us": 14536.76351872616, "mlp_time_us": 8100.8148193359375, "allgather_time_us": 87.50567674636841, "allreduce_time_us": 707.748131837706, "total_latency_us": 23432}, {"doc_id": 6, "doc_len": 64608, "worker_id": 1, "attn_time_us": 12208.057319083677, "mlp_time_us": 7393.798828125, "allgather_time_us": 79.8684310913086, "allreduce_time_us": 709.7928195069591, "total_latency_us": 20391}, {"doc_id": 7, "doc_len": 57240, "worker_id": 1, "attn_time_us": 9706.154655384984, "mlp_time_us": 6550.59814453125, "allgather_time_us": 70.76010704040526, "allreduce_time_us": 708.0361999081579, "total_latency_us": 17035}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 342.06518009275067, "mlp_time_us": 1045.7611083984375, "allgather_time_us": 11.296398639678955, "allreduce_time_us": 630.0, "total_latency_us": 2029}, {"doc_id": 9, "doc_len": 14084, "worker_id": 0, "attn_time_us": 721.494433496637, "mlp_time_us": 1611.785888671875, "allgather_time_us": 17.410645484924316, "allreduce_time_us": 630.0, "total_latency_us": 2980}, {"doc_id": 10, "doc_len": 13958, "worker_id": 1, "attn_time_us": 710.3948193140337, "mlp_time_us": 1597.3663330078125, "allgather_time_us": 17.254884243011475, "allreduce_time_us": 630.0, "total_latency_us": 2955}, {"doc_id": 11, "doc_len": 66573, "worker_id": 2, "attn_time_us": 12925.109283280679, "mlp_time_us": 7618.675231933594, "allgather_time_us": 82.29756474494933, "allreduce_time_us": 709.540654853255, "total_latency_us": 21335}, {"doc_id": 12, "doc_len": 37376, "worker_id": 0, "attn_time_us": 4329.664368577538, "mlp_time_us": 4277.34375, "allgather_time_us": 46.2042236328125, "allreduce_time_us": 701.8873542534286, "total_latency_us": 9355}, {"doc_id": 13, "doc_len": 60754, "worker_id": 2, "attn_time_us": 10865.632948779294, "mlp_time_us": 6952.7435302734375, "allgather_time_us": 75.10411500930786, "allreduce_time_us": 708.8999999541232, "total_latency_us": 18602}, {"doc_id": 14, "doc_len": 16561, "worker_id": 3, "attn_time_us": 955.428875713972, "mlp_time_us": 1895.2560424804688, "allgather_time_us": 20.47271370887756, "allreduce_time_us": 631.0298301992497, "total_latency_us": 3502}, {"doc_id": 15, "doc_len": 8227, "worker_id": 1, "attn_time_us": 285.3793244048667, "mlp_time_us": 941.5054321289062, "allgather_time_us": 10.170220136642454, "allreduce_time_us": 630.0, "total_latency_us": 1867}, {"doc_id": 16, "doc_len": 32713, "worker_id": 1, "attn_time_us": 3364.1574060623434, "mlp_time_us": 3743.7057495117188, "allgather_time_us": 40.43982148170471, "allreduce_time_us": 699.8212802682243, "total_latency_us": 7848}, {"doc_id": 17, "doc_len": 7902, "worker_id": 0, "attn_time_us": 267.9615103921865, "mlp_time_us": 904.3121337890625, "allgather_time_us": 9.768455028533934, "allreduce_time_us": 632.0197847512702, "total_latency_us": 1814}, {"doc_id": 18, "doc_len": 61207, "worker_id": 0, "attn_time_us": 11019.59152686386, "mlp_time_us": 7004.585266113281, "allgather_time_us": 75.6641137599945, "allreduce_time_us": 709.007775420159, "total_latency_us": 18808}, {"doc_id": 19, "doc_len": 23509, "worker_id": 0, "attn_time_us": 1826.1881885711987, "mlp_time_us": 2690.3915405273438, "allgather_time_us": 29.06183362007141, "allreduce_time_us": 665.5440351532947, "total_latency_us": 5211}, {"doc_id": 20, "doc_len": 70502, "worker_id": 3, "attn_time_us": 14425.279867519443, "mlp_time_us": 8068.3135986328125, "allgather_time_us": 87.1545958518982, "allreduce_time_us": 707.8654308627424, "total_latency_us": 23288}, {"doc_id": 21, "doc_len": 17053, "worker_id": 0, "attn_time_us": 1008.577271871268, "mlp_time_us": 1951.5609741210938, "allgather_time_us": 21.08092427253723, "allreduce_time_us": 633.84415939027, "total_latency_us": 3615}, {"doc_id": 22, "doc_len": 54571, "worker_id": 2, "attn_time_us": 8866.861025222815, "mlp_time_us": 6245.155334472656, "allgather_time_us": 67.46068835258482, "allreduce_time_us": 707.3446674959376, "total_latency_us": 15886}, {"doc_id": 23, "doc_len": 74115, "worker_id": 1, "attn_time_us": 15874.090968528028, "mlp_time_us": 8481.788635253906, "allgather_time_us": 91.62098765373229, "allreduce_time_us": 706.4086022935329, "total_latency_us": 25153}, {"doc_id": 24, "doc_len": 54086, "worker_id": 2, "attn_time_us": 8718.198591231489, "mlp_time_us": 6189.6514892578125, "allgather_time_us": 66.86113119125366, "allreduce_time_us": 707.2154560381123, "total_latency_us": 15681}, {"doc_id": 25, "doc_len": 8083, "worker_id": 2, "attn_time_us": 277.49218511072326, "mlp_time_us": 925.0259399414062, "allgather_time_us": 9.992207288742064, "allreduce_time_us": 630.7498927732277, "total_latency_us": 1843}, {"doc_id": 26, "doc_len": 14760, "worker_id": 3, "attn_time_us": 782.2740172627251, "mlp_time_us": 1689.14794921875, "allgather_time_us": 18.246316909790036, "allreduce_time_us": 630.0, "total_latency_us": 3119}, {"doc_id": 27, "doc_len": 8420, "worker_id": 2, "attn_time_us": 297.0273382624882, "mlp_time_us": 963.592529296875, "allgather_time_us": 10.408806800842285, "allreduce_time_us": 630.0, "total_latency_us": 1901}, {"doc_id": 28, "doc_len": 8823, "worker_id": 3, "attn_time_us": 321.9774583853592, "mlp_time_us": 1009.7122192382812, "allgather_time_us": 10.90699553489685, "allreduce_time_us": 630.0, "total_latency_us": 1972}, {"doc_id": 29, "doc_len": 29953, "worker_id": 3, "attn_time_us": 2858.182097036623, "mlp_time_us": 3427.8488159179688, "allgather_time_us": 37.02790856361389, "allreduce_time_us": 690.507593474954, "total_latency_us": 7013}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 10873.086340608235, "mlp_time": 6955.26123046875, "allgather_time": 75.13131141662598, "allreduce_time": 708.9052522414017}, "1": {"doc_len": 15258, "attn_time": 828.3643190467537, "mlp_time": 1746.1395263671875, "allgather_time": 18.861944675445557, "allreduce_time": 630.0}, "2": {"doc_len": 46893, "attn_time": 6653.380800639396, "mlp_time": 5366.477966308594, "allgather_time": 57.96914219856262, "allreduce_time": 705.1531381379633}, "3": {"doc_len": 33216, "attn_time": 3462.542272972649, "mlp_time": 3801.26953125, "allgather_time": 41.06163024902344, "allreduce_time": 700.1945481616709}, "4": {"doc_len": 7431, "attn_time": 243.71623750651025, "mlp_time": 850.4104614257812, "allgather_time": 9.186204671859741, "allreduce_time": 635.4786613667258}, "5": {"doc_len": 70786, "attn_time": 14536.76351872616, "mlp_time": 8100.8148193359375, "allgather_time": 87.50567674636841, "allreduce_time": 707.748131837706}, "6": {"doc_len": 64608, "attn_time": 12208.057319083677, "mlp_time": 7393.798828125, "allgather_time": 79.8684310913086, "allreduce_time": 709.7928195069591}, "7": {"doc_len": 57240, "attn_time": 9706.154655384984, "mlp_time": 6550.59814453125, "allgather_time": 70.76010704040526, "allreduce_time": 708.0361999081579}, "8": {"doc_len": 9138, "attn_time": 342.06518009275067, "mlp_time": 1045.7611083984375, "allgather_time": 11.296398639678955, "allreduce_time": 630.0}, "9": {"doc_len": 14084, "attn_time": 721.494433496637, "mlp_time": 1611.785888671875, "allgather_time": 17.410645484924316, "allreduce_time": 630.0}, "10": {"doc_len": 13958, "attn_time": 710.3948193140337, "mlp_time": 1597.3663330078125, "allgather_time": 17.254884243011475, "allreduce_time": 630.0}, "11": {"doc_len": 66573, "attn_time": 12925.109283280679, "mlp_time": 7618.675231933594, "allgather_time": 82.29756474494933, "allreduce_time": 709.540654853255}, "12": {"doc_len": 37376, "attn_time": 4329.664368577538, "mlp_time": 4277.34375, "allgather_time": 46.2042236328125, "allreduce_time": 701.8873542534286}, "13": {"doc_len": 60754, "attn_time": 10865.632948779294, "mlp_time": 6952.7435302734375, "allgather_time": 75.10411500930786, "allreduce_time": 708.8999999541232}, "14": {"doc_len": 16561, "attn_time": 955.428875713972, "mlp_time": 1895.2560424804688, "allgather_time": 20.47271370887756, "allreduce_time": 631.0298301992497}, "15": {"doc_len": 8227, "attn_time": 285.3793244048667, "mlp_time": 941.5054321289062, "allgather_time": 10.170220136642454, "allreduce_time": 630.0}, "16": {"doc_len": 32713, "attn_time": 3364.1574060623434, "mlp_time": 3743.7057495117188, "allgather_time": 40.43982148170471, "allreduce_time": 699.8212802682243}, "17": {"doc_len": 7902, "attn_time": 267.9615103921865, "mlp_time": 904.3121337890625, "allgather_time": 9.768455028533934, "allreduce_time": 632.0197847512702}, "18": {"doc_len": 61207, "attn_time": 11019.59152686386, "mlp_time": 7004.585266113281, "allgather_time": 75.6641137599945, "allreduce_time": 709.007775420159}, "19": {"doc_len": 23509, "attn_time": 1826.1881885711987, "mlp_time": 2690.3915405273438, "allgather_time": 29.06183362007141, "allreduce_time": 665.5440351532947}, "20": {"doc_len": 70502, "attn_time": 14425.279867519443, "mlp_time": 8068.3135986328125, "allgather_time": 87.1545958518982, "allreduce_time": 707.8654308627424}, "21": {"doc_len": 17053, "attn_time": 1008.577271871268, "mlp_time": 1951.5609741210938, "allgather_time": 21.08092427253723, "allreduce_time": 633.84415939027}, "22": {"doc_len": 54571, "attn_time": 8866.861025222815, "mlp_time": 6245.155334472656, "allgather_time": 67.46068835258482, "allreduce_time": 707.3446674959376}, "23": {"doc_len": 74115, "attn_time": 15874.090968528028, "mlp_time": 8481.788635253906, "allgather_time": 91.62098765373229, "allreduce_time": 706.4086022935329}, "24": {"doc_len": 54086, "attn_time": 8718.198591231489, "mlp_time": 6189.6514892578125, "allgather_time": 66.86113119125366, "allreduce_time": 707.2154560381123}, "25": {"doc_len": 8083, "attn_time": 277.49218511072326, "mlp_time": 925.0259399414062, "allgather_time": 9.992207288742064, "allreduce_time": 630.7498927732277}, "26": {"doc_len": 14760, "attn_time": 782.2740172627251, "mlp_time": 1689.14794921875, "allgather_time": 18.246316909790036, "allreduce_time": 630.0}, "27": {"doc_len": 8420, "attn_time": 297.0273382624882, "mlp_time": 963.592529296875, "allgather_time": 10.408806800842285, "allreduce_time": 630.0}, "28": {"doc_len": 8823, "attn_time": 321.9774583853592, "mlp_time": 1009.7122192382812, "allgather_time": 10.90699553489685, "allreduce_time": 630.0}, "29": {"doc_len": 29953, "attn_time": 2858.182097036623, "mlp_time": 3427.8488159179688, "allgather_time": 37.02790856361389, "allreduce_time": 690.507593474954}}}, "attnserver_result": {"batch_total_time": 70198.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 2280.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 8, "mlp_cp": 2}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 4, "dp": 2, "ratio": 0.8634145174410259, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 83596, "worker_latencies_us": [83595, 83596], "doc2worker": {"0": 1, "1": 1, "2": 1, "3": 0, "4": 1, "5": 0, "6": 0, "7": 0, "8": 0, "9": 1, "10": 1, "11": 0, "12": 0, "13": 0, "14": 0, "15": 1, "16": 0, "17": 0, "18": 0, "19": 1, "20": 1, "21": 1, "22": 1, "23": 1, "24": 1, "25": 1, "26": 1, "27": 1, "28": 1, "29": 1}, "latency_breakdown": {"max_worker_latency_us": 83596, "worker_latencies_us": [83595, 83596], "solver_status": "OPTIMAL", "solved_time_s": 0.03648948669433594, "num_vars": 63, "num_cons": 36}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [3, 5, 6, 7, 8, 11, 12, 13, 14, 16, 17, 18], "total_batch_length": 518074, "total_latency_us": 83595, "mlp_cost_us": 29644.432067871094, "attn_cost_us": 44993.83576395722, "allreduce_cost_us": 8247.978379114204, "allgather_cost_us": 713.9367389678955}, {"worker_id": 1, "assigned_docs": [0, 1, 2, 4, 9, 10, 15, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "total_batch_length": 530502, "total_latency_us": 83596, "mlp_cost_us": 30355.567932128906, "attn_cost_us": 40608.74654657267, "allreduce_cost_us": 11909.016889228162, "allgather_cost_us": 731.0632610321045}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 1, "attn_time_us": 5820.49435276251, "mlp_time_us": 3477.630615234375, "allgather_time_us": 83.75293731689453, "allreduce_time_us": 708.9052522414017, "total_latency_us": 10090}, {"doc_id": 1, "doc_len": 15258, "worker_id": 1, "attn_time_us": 464.53188578530785, "mlp_time_us": 873.0697631835938, "allgather_time_us": 21.026430130004883, "allreduce_time_us": 630.0, "total_latency_us": 1988}, {"doc_id": 2, "doc_len": 46893, "worker_id": 1, "attn_time_us": 3567.8276517243607, "mlp_time_us": 2683.238983154297, "allgather_time_us": 64.62133884429933, "allreduce_time_us": 705.1531381379633, "total_latency_us": 7020}, {"doc_id": 3, "doc_len": 33216, "worker_id": 0, "attn_time_us": 1861.0575097037029, "mlp_time_us": 1900.634765625, "allgather_time_us": 45.77362060546875, "allreduce_time_us": 700.1945481616709, "total_latency_us": 4507}, {"doc_id": 4, "doc_len": 7431, "worker_id": 1, "attn_time_us": 146.61274530675024, "mlp_time_us": 425.2052307128906, "allgather_time_us": 10.24035930633545, "allreduce_time_us": 635.4786613667258, "total_latency_us": 1217}, {"doc_id": 5, "doc_len": 70786, "worker_id": 0, "attn_time_us": 7750.907601659153, "mlp_time_us": 4050.4074096679688, "allgather_time_us": 97.54731178283691, "allreduce_time_us": 707.748131837706, "total_latency_us": 12606}, {"doc_id": 6, "doc_len": 64608, "worker_id": 0, "attn_time_us": 6532.444264627457, "mlp_time_us": 3696.8994140625, "allgather_time_us": 89.03366088867188, "allreduce_time_us": 709.7928195069591, "total_latency_us": 11028}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 5197.908497094602, "mlp_time_us": 3275.299072265625, "allgather_time_us": 78.88011932373047, "allreduce_time_us": 708.0361999081579, "total_latency_us": 9260}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 200.29370933141428, "mlp_time_us": 522.8805541992188, "allgather_time_us": 12.592706680297852, "allreduce_time_us": 630.0, "total_latency_us": 1365}, {"doc_id": 9, "doc_len": 14084, "worker_id": 1, "attn_time_us": 407.34053192121246, "mlp_time_us": 805.8929443359375, "allgather_time_us": 19.408588409423828, "allreduce_time_us": 630.0, "total_latency_us": 1862}, {"doc_id": 10, "doc_len": 13958, "worker_id": 1, "attn_time_us": 401.3778023975352, "mlp_time_us": 798.6831665039062, "allgather_time_us": 19.234952926635742, "allreduce_time_us": 630.0, "total_latency_us": 1849}, {"doc_id": 11, "doc_len": 66573, "worker_id": 0, "attn_time_us": 6910.599448260966, "mlp_time_us": 3809.337615966797, "allgather_time_us": 91.74154758453369, "allreduce_time_us": 709.540654853255, "total_latency_us": 11521}, {"doc_id": 12, "doc_len": 37376, "worker_id": 0, "attn_time_us": 2325.282138760848, "mlp_time_us": 2138.671875, "allgather_time_us": 51.50634765625, "allreduce_time_us": 701.8873542534286, "total_latency_us": 5217}, {"doc_id": 13, "doc_len": 60754, "worker_id": 0, "attn_time_us": 5816.518569052051, "mlp_time_us": 3476.3717651367188, "allgather_time_us": 83.72262001037598, "allreduce_time_us": 708.8999999541232, "total_latency_us": 10085}, {"doc_id": 14, "doc_len": 16561, "worker_id": 0, "attn_time_us": 532.2819498783049, "mlp_time_us": 947.6280212402344, "allgather_time_us": 22.822041511535645, "allreduce_time_us": 631.0298301992497, "total_latency_us": 2133}, {"doc_id": 15, "doc_len": 8227, "worker_id": 1, "attn_time_us": 168.58730081131978, "mlp_time_us": 470.7527160644531, "allgather_time_us": 11.337294578552248, "allreduce_time_us": 630.0, "total_latency_us": 1280}, {"doc_id": 16, "doc_len": 32713, "worker_id": 0, "attn_time_us": 1808.5010948897252, "mlp_time_us": 1871.8528747558594, "allgather_time_us": 45.08045673370361, "allreduce_time_us": 699.8212802682243, "total_latency_us": 4425}, {"doc_id": 17, "doc_len": 7902, "worker_id": 0, "attn_time_us": 159.39986964651405, "mlp_time_us": 452.15606689453125, "allgather_time_us": 10.889425277709963, "allreduce_time_us": 632.0197847512702, "total_latency_us": 1254}, {"doc_id": 18, "doc_len": 61207, "worker_id": 0, "attn_time_us": 5898.641111052482, "mlp_time_us": 3502.2926330566406, "allgather_time_us": 84.34688091278076, "allreduce_time_us": 709.007775420159, "total_latency_us": 10194}, {"doc_id": 19, "doc_len": 23509, "worker_id": 1, "attn_time_us": 998.8755471751973, "mlp_time_us": 1345.1957702636719, "allgather_time_us": 32.396798133850105, "allreduce_time_us": 665.5440351532947, "total_latency_us": 3042}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 7692.853850859836, "mlp_time_us": 4034.1567993164062, "allgather_time_us": 97.15594291687012, "allreduce_time_us": 707.8654308627424, "total_latency_us": 12532}, {"doc_id": 21, "doc_len": 17053, "worker_id": 1, "attn_time_us": 561.0297748751949, "mlp_time_us": 975.7804870605469, "allgather_time_us": 23.500046730041507, "allreduce_time_us": 633.84415939027, "total_latency_us": 2194}, {"doc_id": 22, "doc_len": 54571, "worker_id": 1, "attn_time_us": 4749.963181447553, "mlp_time_us": 3122.577667236328, "allgather_time_us": 75.2020788192749, "allreduce_time_us": 707.3446674959376, "total_latency_us": 8655}, {"doc_id": 23, "doc_len": 74115, "worker_id": 1, "attn_time_us": 8446.513247862742, "mlp_time_us": 4240.894317626953, "allgather_time_us": 102.13487148284912, "allreduce_time_us": 706.4086022935329, "total_latency_us": 13495}, {"doc_id": 24, "doc_len": 54086, "worker_id": 1, "attn_time_us": 4670.604258494421, "mlp_time_us": 3094.8257446289062, "allgather_time_us": 74.53372001647949, "allreduce_time_us": 707.2154560381123, "total_latency_us": 8547}, {"doc_id": 25, "doc_len": 8083, "worker_id": 1, "attn_time_us": 164.38833837346058, "mlp_time_us": 462.5129699707031, "allgather_time_us": 11.138854026794435, "allreduce_time_us": 630.7498927732277, "total_latency_us": 1268}, {"doc_id": 26, "doc_len": 14760, "worker_id": 1, "attn_time_us": 439.91382374343567, "mlp_time_us": 844.573974609375, "allgather_time_us": 20.34015655517578, "allreduce_time_us": 630.0, "total_latency_us": 1934}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 175.12576336861127, "mlp_time_us": 481.7962646484375, "allgather_time_us": 11.603260040283203, "allreduce_time_us": 630.0, "total_latency_us": 1298}, {"doc_id": 28, "doc_len": 8823, "worker_id": 1, "attn_time_us": 189.08970337690047, "mlp_time_us": 504.8561096191406, "allgather_time_us": 12.158617973327637, "allreduce_time_us": 630.0, "total_latency_us": 1336}, {"doc_id": 29, "doc_len": 29953, "worker_id": 1, "attn_time_us": 1543.6167862863228, "mlp_time_us": 1713.9244079589844, "allgather_time_us": 41.27701282501221, "allreduce_time_us": 690.507593474954, "total_latency_us": 3989}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 5820.49435276251, "mlp_time": 3477.630615234375, "allgather_time": 83.75293731689453, "allreduce_time": 708.9052522414017}, "1": {"doc_len": 15258, "attn_time": 464.53188578530785, "mlp_time": 873.0697631835938, "allgather_time": 21.026430130004883, "allreduce_time": 630.0}, "2": {"doc_len": 46893, "attn_time": 3567.8276517243607, "mlp_time": 2683.238983154297, "allgather_time": 64.62133884429933, "allreduce_time": 705.1531381379633}, "3": {"doc_len": 33216, "attn_time": 1861.0575097037029, "mlp_time": 1900.634765625, "allgather_time": 45.77362060546875, "allreduce_time": 700.1945481616709}, "4": {"doc_len": 7431, "attn_time": 146.61274530675024, "mlp_time": 425.2052307128906, "allgather_time": 10.24035930633545, "allreduce_time": 635.4786613667258}, "5": {"doc_len": 70786, "attn_time": 7750.907601659153, "mlp_time": 4050.4074096679688, "allgather_time": 97.54731178283691, "allreduce_time": 707.748131837706}, "6": {"doc_len": 64608, "attn_time": 6532.444264627457, "mlp_time": 3696.8994140625, "allgather_time": 89.03366088867188, "allreduce_time": 709.7928195069591}, "7": {"doc_len": 57240, "attn_time": 5197.908497094602, "mlp_time": 3275.299072265625, "allgather_time": 78.88011932373047, "allreduce_time": 708.0361999081579}, "8": {"doc_len": 9138, "attn_time": 200.29370933141428, "mlp_time": 522.8805541992188, "allgather_time": 12.592706680297852, "allreduce_time": 630.0}, "9": {"doc_len": 14084, "attn_time": 407.34053192121246, "mlp_time": 805.8929443359375, "allgather_time": 19.408588409423828, "allreduce_time": 630.0}, "10": {"doc_len": 13958, "attn_time": 401.3778023975352, "mlp_time": 798.6831665039062, "allgather_time": 19.234952926635742, "allreduce_time": 630.0}, "11": {"doc_len": 66573, "attn_time": 6910.599448260966, "mlp_time": 3809.337615966797, "allgather_time": 91.74154758453369, "allreduce_time": 709.540654853255}, "12": {"doc_len": 37376, "attn_time": 2325.282138760848, "mlp_time": 2138.671875, "allgather_time": 51.50634765625, "allreduce_time": 701.8873542534286}, "13": {"doc_len": 60754, "attn_time": 5816.518569052051, "mlp_time": 3476.3717651367188, "allgather_time": 83.72262001037598, "allreduce_time": 708.8999999541232}, "14": {"doc_len": 16561, "attn_time": 532.2819498783049, "mlp_time": 947.6280212402344, "allgather_time": 22.822041511535645, "allreduce_time": 631.0298301992497}, "15": {"doc_len": 8227, "attn_time": 168.58730081131978, "mlp_time": 470.7527160644531, "allgather_time": 11.337294578552248, "allreduce_time": 630.0}, "16": {"doc_len": 32713, "attn_time": 1808.5010948897252, "mlp_time": 1871.8528747558594, "allgather_time": 45.08045673370361, "allreduce_time": 699.8212802682243}, "17": {"doc_len": 7902, "attn_time": 159.39986964651405, "mlp_time": 452.15606689453125, "allgather_time": 10.889425277709963, "allreduce_time": 632.0197847512702}, "18": {"doc_len": 61207, "attn_time": 5898.641111052482, "mlp_time": 3502.2926330566406, "allgather_time": 84.34688091278076, "allreduce_time": 709.007775420159}, "19": {"doc_len": 23509, "attn_time": 998.8755471751973, "mlp_time": 1345.1957702636719, "allgather_time": 32.396798133850105, "allreduce_time": 665.5440351532947}, "20": {"doc_len": 70502, "attn_time": 7692.853850859836, "mlp_time": 4034.1567993164062, "allgather_time": 97.15594291687012, "allreduce_time": 707.8654308627424}, "21": {"doc_len": 17053, "attn_time": 561.0297748751949, "mlp_time": 975.7804870605469, "allgather_time": 23.500046730041507, "allreduce_time": 633.84415939027}, "22": {"doc_len": 54571, "attn_time": 4749.963181447553, "mlp_time": 3122.577667236328, "allgather_time": 75.2020788192749, "allreduce_time": 707.3446674959376}, "23": {"doc_len": 74115, "attn_time": 8446.513247862742, "mlp_time": 4240.894317626953, "allgather_time": 102.13487148284912, "allreduce_time": 706.4086022935329}, "24": {"doc_len": 54086, "attn_time": 4670.604258494421, "mlp_time": 3094.8257446289062, "allgather_time": 74.53372001647949, "allreduce_time": 707.2154560381123}, "25": {"doc_len": 8083, "attn_time": 164.38833837346058, "mlp_time": 462.5129699707031, "allgather_time": 11.138854026794435, "allreduce_time": 630.7498927732277}, "26": {"doc_len": 14760, "attn_time": 439.91382374343567, "mlp_time": 844.573974609375, "allgather_time": 20.34015655517578, "allreduce_time": 630.0}, "27": {"doc_len": 8420, "attn_time": 175.12576336861127, "mlp_time": 481.7962646484375, "allgather_time": 11.603260040283203, "allreduce_time": 630.0}, "28": {"doc_len": 8823, "attn_time": 189.08970337690047, "mlp_time": 504.8561096191406, "allgather_time": 12.158617973327637, "allreduce_time": 630.0}, "29": {"doc_len": 29953, "attn_time": 1543.6167862863228, "mlp_time": 1713.9244079589844, "allgather_time": 41.27701282501221, "allreduce_time": 690.507593474954}}}, "attnserver_result": {"batch_total_time": 72178.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 4260.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 8, "mlp_cp": 4}}
{"idx": 0, "input_batch": [60776, 15258, 46893, 33216, 7431, 70786, 64608, 57240, 9138, 14084, 13958, 66573, 37376, 60754, 16561, 8227, 32713, 7902, 61207, 23509, 70502, 17053, 54571, 74115, 54086, 8083, 14760, 8420, 8823, 29953], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 8, "dp": 1, "ratio": 0.7913027202395807, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 96168, "worker_latencies_us": [96168], "doc2worker": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "12": 0, "13": 0, "14": 0, "15": 0, "16": 0, "17": 0, "18": 0, "19": 0, "20": 0, "21": 0, "22": 0, "23": 0, "24": 0, "25": 0, "26": 0, "27": 0, "28": 0, "29": 0}, "latency_breakdown": {"max_worker_latency_us": 96168, "worker_latencies_us": [96168], "solver_status": "OPTIMAL", "solved_time_s": 0.006839752197265625, "num_vars": 32, "num_cons": 33}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "total_batch_length": 1048576, "total_latency_us": 96168, "mlp_cost_us": 30000.0, "attn_cost_us": 44407.38541474918, "allreduce_cost_us": 20156.995268342365, "allgather_cost_us": 1616.875}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 0, "attn_time_us": 2959.750177108982, "mlp_time_us": 1738.8153076171875, "allgather_time_us": 93.71490001678467, "allreduce_time_us": 708.9052522414017, "total_latency_us": 5501}, {"doc_id": 1, "doc_len": 15258, "worker_id": 0, "attn_time_us": 285.175251991034, "mlp_time_us": 436.5348815917969, "allgather_time_us": 23.527411222457886, "allreduce_time_us": 630.0, "total_latency_us": 1375}, {"doc_id": 2, "doc_len": 46893, "worker_id": 0, "attn_time_us": 1881.995129460688, "mlp_time_us": 1341.6194915771484, "allgather_time_us": 72.30770051479341, "allreduce_time_us": 705.1531381379633, "total_latency_us": 4001}, {"doc_id": 3, "doc_len": 33216, "worker_id": 0, "attn_time_us": 1030.725768092577, "mlp_time_us": 950.3173828125, "allgather_time_us": 51.21814727783203, "allreduce_time_us": 700.1945481616709, "total_latency_us": 2732}, {"doc_id": 4, "doc_len": 7431, "worker_id": 0, "attn_time_us": 103.12715651384403, "mlp_time_us": 212.6026153564453, "allgather_time_us": 11.45839512348175, "allreduce_time_us": 635.4786613667258, "total_latency_us": 962}, {"doc_id": 5, "doc_len": 70786, "worker_id": 0, "attn_time_us": 3899.101893612595, "mlp_time_us": 2025.2037048339844, "allgather_time_us": 109.15004134178162, "allreduce_time_us": 707.748131837706, "total_latency_us": 6741}, {"doc_id": 6, "doc_len": 64608, "worker_id": 0, "attn_time_us": 3293.1950597279606, "mlp_time_us": 1848.44970703125, "allgather_time_us": 99.62373733520508, "allreduce_time_us": 709.7928195069591, "total_latency_us": 5951}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 2665.652369513489, "mlp_time_us": 1637.6495361328125, "allgather_time_us": 88.2624864578247, "allreduce_time_us": 708.0361999081579, "total_latency_us": 5099}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 134.6413418673913, "mlp_time_us": 261.4402770996094, "allgather_time_us": 14.09054160118103, "allreduce_time_us": 630.0, "total_latency_us": 1040}, {"doc_id": 9, "doc_len": 14084, "worker_id": 0, "attn_time_us": 253.6351858141579, "mlp_time_us": 402.94647216796875, "allgather_time_us": 21.717135906219482, "allreduce_time_us": 630.0, "total_latency_us": 1308}, {"doc_id": 10, "doc_len": 13958, "worker_id": 0, "attn_time_us": 250.32033862866282, "mlp_time_us": 399.3415832519531, "allgather_time_us": 21.522847414016724, "allreduce_time_us": 630.0, "total_latency_us": 1301}, {"doc_id": 11, "doc_len": 66573, "worker_id": 0, "attn_time_us": 3476.729803150505, "mlp_time_us": 1904.6688079833984, "allgather_time_us": 102.65371263027191, "allreduce_time_us": 709.540654853255, "total_latency_us": 6193}, {"doc_id": 12, "doc_len": 37376, "worker_id": 0, "attn_time_us": 1266.5298570947903, "mlp_time_us": 1069.3359375, "allgather_time_us": 57.63275146484375, "allreduce_time_us": 701.8873542534286, "total_latency_us": 3095}, {"doc_id": 13, "doc_len": 60754, "worker_id": 0, "attn_time_us": 2957.879839815689, "mlp_time_us": 1738.1858825683594, "allgather_time_us": 93.6809766292572, "allreduce_time_us": 708.8999999541232, "total_latency_us": 5498}, {"doc_id": 14, "doc_len": 16561, "worker_id": 0, "attn_time_us": 322.2319050643333, "mlp_time_us": 473.8140106201172, "allgather_time_us": 25.536600947380066, "allreduce_time_us": 631.0298301992497, "total_latency_us": 1452}, {"doc_id": 15, "doc_len": 8227, "worker_id": 0, "attn_time_us": 115.45432279820749, "mlp_time_us": 235.37635803222656, "allgather_time_us": 12.68580496311188, "allreduce_time_us": 630.0, "total_latency_us": 993}, {"doc_id": 16, "doc_len": 32713, "worker_id": 0, "attn_time_us": 1003.7574723942311, "mlp_time_us": 935.9264373779297, "allgather_time_us": 50.442535281181335, "allreduce_time_us": 699.8212802682243, "total_latency_us": 2689}, {"doc_id": 17, "doc_len": 7902, "worker_id": 0, "attn_time_us": 110.29961983541597, "mlp_time_us": 226.07803344726562, "allgather_time_us": 12.184664011001589, "allreduce_time_us": 632.0197847512702, "total_latency_us": 980}, {"doc_id": 18, "doc_len": 61207, "worker_id": 0, "attn_time_us": 2996.493605356284, "mlp_time_us": 1751.1463165283203, "allgather_time_us": 94.37949001789093, "allreduce_time_us": 709.007775420159, "total_latency_us": 5551}, {"doc_id": 19, "doc_len": 23509, "worker_id": 0, "attn_time_us": 578.2654995706013, "mlp_time_us": 672.5978851318359, "allgather_time_us": 36.250223517417915, "allreduce_time_us": 665.5440351532947, "total_latency_us": 1952}, {"doc_id": 20, "doc_len": 70502, "worker_id": 0, "attn_time_us": 3869.923112322769, "mlp_time_us": 2017.0783996582031, "allgather_time_us": 108.71212124824524, "allreduce_time_us": 707.8654308627424, "total_latency_us": 6703}, {"doc_id": 21, "doc_len": 17053, "worker_id": 0, "attn_time_us": 338.3690530666155, "mlp_time_us": 487.89024353027344, "allgather_time_us": 26.295251250267032, "allreduce_time_us": 633.84415939027, "total_latency_us": 1486}, {"doc_id": 22, "doc_len": 54571, "worker_id": 0, "attn_time_us": 2452.4287928241747, "mlp_time_us": 1561.288833618164, "allgather_time_us": 84.14696276187897, "allreduce_time_us": 707.3446674959376, "total_latency_us": 4805}, {"doc_id": 23, "doc_len": 74115, "worker_id": 0, "attn_time_us": 4248.710522452058, "mlp_time_us": 2120.4471588134766, "allgather_time_us": 114.28326666355133, "allreduce_time_us": 706.4086022935329, "total_latency_us": 7189}, {"doc_id": 24, "doc_len": 54086, "worker_id": 0, "attn_time_us": 2414.5002561612955, "mlp_time_us": 1547.4128723144531, "allgather_time_us": 83.39910626411438, "allreduce_time_us": 707.2154560381123, "total_latency_us": 4752}, {"doc_id": 25, "doc_len": 8083, "worker_id": 0, "attn_time_us": 113.06676969448044, "mlp_time_us": 231.25648498535156, "allgather_time_us": 12.463760972023012, "allreduce_time_us": 630.7498927732277, "total_latency_us": 987}, {"doc_id": 26, "doc_len": 14760, "worker_id": 0, "attn_time_us": 271.65338398154023, "mlp_time_us": 422.2869873046875, "allgather_time_us": 22.759509086608887, "allreduce_time_us": 630.0, "total_latency_us": 1346}, {"doc_id": 27, "doc_len": 8420, "worker_id": 0, "attn_time_us": 119.44077091837966, "mlp_time_us": 240.89813232421875, "allgather_time_us": 12.983405590057373, "allreduce_time_us": 630.0, "total_latency_us": 1003}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 127.9016103920998, "mlp_time_us": 252.4280548095703, "allgather_time_us": 13.604820370674133, "allreduce_time_us": 630.0, "total_latency_us": 1023}, {"doc_id": 29, "doc_len": 29953, "worker_id": 0, "attn_time_us": 866.4295455243364, "mlp_time_us": 856.9622039794922, "allgather_time_us": 46.186692118644714, "allreduce_time_us": 690.507593474954, "total_latency_us": 2460}], "document_costs": {"0": {"doc_len": 60776, "attn_time": 2959.750177108982, "mlp_time": 1738.8153076171875, "allgather_time": 93.71490001678467, "allreduce_time": 708.9052522414017}, "1": {"doc_len": 15258, "attn_time": 285.175251991034, "mlp_time": 436.5348815917969, "allgather_time": 23.527411222457886, "allreduce_time": 630.0}, "2": {"doc_len": 46893, "attn_time": 1881.995129460688, "mlp_time": 1341.6194915771484, "allgather_time": 72.30770051479341, "allreduce_time": 705.1531381379633}, "3": {"doc_len": 33216, "attn_time": 1030.725768092577, "mlp_time": 950.3173828125, "allgather_time": 51.21814727783203, "allreduce_time": 700.1945481616709}, "4": {"doc_len": 7431, "attn_time": 103.12715651384403, "mlp_time": 212.6026153564453, "allgather_time": 11.45839512348175, "allreduce_time": 635.4786613667258}, "5": {"doc_len": 70786, "attn_time": 3899.101893612595, "mlp_time": 2025.2037048339844, "allgather_time": 109.15004134178162, "allreduce_time": 707.748131837706}, "6": {"doc_len": 64608, "attn_time": 3293.1950597279606, "mlp_time": 1848.44970703125, "allgather_time": 99.62373733520508, "allreduce_time": 709.7928195069591}, "7": {"doc_len": 57240, "attn_time": 2665.652369513489, "mlp_time": 1637.6495361328125, "allgather_time": 88.2624864578247, "allreduce_time": 708.0361999081579}, "8": {"doc_len": 9138, "attn_time": 134.6413418673913, "mlp_time": 261.4402770996094, "allgather_time": 14.09054160118103, "allreduce_time": 630.0}, "9": {"doc_len": 14084, "attn_time": 253.6351858141579, "mlp_time": 402.94647216796875, "allgather_time": 21.717135906219482, "allreduce_time": 630.0}, "10": {"doc_len": 13958, "attn_time": 250.32033862866282, "mlp_time": 399.3415832519531, "allgather_time": 21.522847414016724, "allreduce_time": 630.0}, "11": {"doc_len": 66573, "attn_time": 3476.729803150505, "mlp_time": 1904.6688079833984, "allgather_time": 102.65371263027191, "allreduce_time": 709.540654853255}, "12": {"doc_len": 37376, "attn_time": 1266.5298570947903, "mlp_time": 1069.3359375, "allgather_time": 57.63275146484375, "allreduce_time": 701.8873542534286}, "13": {"doc_len": 60754, "attn_time": 2957.879839815689, "mlp_time": 1738.1858825683594, "allgather_time": 93.6809766292572, "allreduce_time": 708.8999999541232}, "14": {"doc_len": 16561, "attn_time": 322.2319050643333, "mlp_time": 473.8140106201172, "allgather_time": 25.536600947380066, "allreduce_time": 631.0298301992497}, "15": {"doc_len": 8227, "attn_time": 115.45432279820749, "mlp_time": 235.37635803222656, "allgather_time": 12.68580496311188, "allreduce_time": 630.0}, "16": {"doc_len": 32713, "attn_time": 1003.7574723942311, "mlp_time": 935.9264373779297, "allgather_time": 50.442535281181335, "allreduce_time": 699.8212802682243}, "17": {"doc_len": 7902, "attn_time": 110.29961983541597, "mlp_time": 226.07803344726562, "allgather_time": 12.184664011001589, "allreduce_time": 632.0197847512702}, "18": {"doc_len": 61207, "attn_time": 2996.493605356284, "mlp_time": 1751.1463165283203, "allgather_time": 94.37949001789093, "allreduce_time": 709.007775420159}, "19": {"doc_len": 23509, "attn_time": 578.2654995706013, "mlp_time": 672.5978851318359, "allgather_time": 36.250223517417915, "allreduce_time": 665.5440351532947}, "20": {"doc_len": 70502, "attn_time": 3869.923112322769, "mlp_time": 2017.0783996582031, "allgather_time": 108.71212124824524, "allreduce_time": 707.8654308627424}, "21": {"doc_len": 17053, "attn_time": 338.3690530666155, "mlp_time": 487.89024353027344, "allgather_time": 26.295251250267032, "allreduce_time": 633.84415939027}, "22": {"doc_len": 54571, "attn_time": 2452.4287928241747, "mlp_time": 1561.288833618164, "allgather_time": 84.14696276187897, "allreduce_time": 707.3446674959376}, "23": {"doc_len": 74115, "attn_time": 4248.710522452058, "mlp_time": 2120.4471588134766, "allgather_time": 114.28326666355133, "allreduce_time": 706.4086022935329}, "24": {"doc_len": 54086, "attn_time": 2414.5002561612955, "mlp_time": 1547.4128723144531, "allgather_time": 83.39910626411438, "allreduce_time": 707.2154560381123}, "25": {"doc_len": 8083, "attn_time": 113.06676969448044, "mlp_time": 231.25648498535156, "allgather_time": 12.463760972023012, "allreduce_time": 630.7498927732277}, "26": {"doc_len": 14760, "attn_time": 271.65338398154023, "mlp_time": 422.2869873046875, "allgather_time": 22.759509086608887, "allreduce_time": 630.0}, "27": {"doc_len": 8420, "attn_time": 119.44077091837966, "mlp_time": 240.89813232421875, "allgather_time": 12.983405590057373, "allreduce_time": 630.0}, "28": {"doc_len": 8823, "attn_time": 127.9016103920998, "mlp_time": 252.4280548095703, "allgather_time": 13.604820370674133, "allreduce_time": 630.0}, "29": {"doc_len": 29953, "attn_time": 866.4295455243364, "mlp_time": 856.9622039794922, "allgather_time": 46.186692118644714, "allreduce_time": 690.507593474954}}}, "attnserver_result": {"batch_total_time": 76098.0, "batch_attn_time": 37918, "batch_mlp_time": 30000.0, "batch_allreduce_time": 8180.0, "solver_status": "FEASIBLE", "solved_time_s": 360.13481402397156, "num_vars": 745, "num_cons": 775, "worker_plans": [{"worker_id": 0, "tp": 2, "cp": 2, "latency_us": 37944}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 2, "tp": 4, "cp": 2, "latency_us": 37987}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 37992}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 38025}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 37918}, {"worker_id": 6, "tp": 2, "cp": 8, "latency_us": 38019}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 37943}], "doc_assignments": [{"doc_id": 0, "doc_len": 60776, "worker_id": 6, "attn_time_us": 10853.167937480666}, {"doc_id": 1, "doc_len": 15258, "worker_id": 5, "attn_time_us": 1537.7804242496668}, {"doc_id": 2, "doc_len": 46893, "worker_id": 5, "attn_time_us": 12532.70988866313}, {"doc_id": 3, "doc_len": 33216, "worker_id": 7, "attn_time_us": 12456.16498464768}, {"doc_id": 4, "doc_len": 7431, "worker_id": 3, "attn_time_us": 442.1353481280947}, {"doc_id": 5, "doc_len": 70786, "worker_id": 6, "attn_time_us": 14380.950014534516}, {"doc_id": 6, "doc_len": 64608, "worker_id": 5, "attn_time_us": 23344.22425843067}, {"doc_id": 7, "doc_len": 57240, "worker_id": 0, "attn_time_us": 35649.54816212674}, {"doc_id": 8, "doc_len": 9138, "worker_id": 0, "attn_time_us": 1183.1934200424412}, {"doc_id": 9, "doc_len": 14084, "worker_id": 7, "attn_time_us": 2315.7857428373727}, {"doc_id": 10, "doc_len": 13958, "worker_id": 2, "attn_time_us": 1315.3676886638589}, {"doc_id": 11, "doc_len": 66573, "worker_id": 6, "attn_time_us": 12786.941420601148}, {"doc_id": 12, "doc_len": 37376, "worker_id": 1, "attn_time_us": 8069.274303227303}, {"doc_id": 13, "doc_len": 60754, "worker_id": 4, "attn_time_us": 20717.369422177857}, {"doc_id": 14, "doc_len": 16561, "worker_id": 1, "attn_time_us": 1777.2241522200052}, {"doc_id": 15, "doc_len": 8227, "worker_id": 7, "attn_time_us": 822.6482024584512}, {"doc_id": 16, "doc_len": 32713, "worker_id": 2, "attn_time_us": 6231.318322348397}, {"doc_id": 17, "doc_len": 7902, "worker_id": 4, "attn_time_us": 487.63265598040385}, {"doc_id": 18, "doc_len": 61207, "worker_id": 3, "attn_time_us": 21018.245068857104}, {"doc_id": 19, "doc_len": 23509, "worker_id": 7, "attn_time_us": 6306.3528600002655}, {"doc_id": 20, "doc_len": 70502, "worker_id": 1, "attn_time_us": 27638.630568300454}, {"doc_id": 21, "doc_len": 17053, "worker_id": 7, "attn_time_us": 3352.5270974851105}, {"doc_id": 22, "doc_len": 54571, "worker_id": 4, "attn_time_us": 16821.409731364707}, {"doc_id": 23, "doc_len": 74115, "worker_id": 2, "attn_time_us": 30441.798818474155}, {"doc_id": 24, "doc_len": 54086, "worker_id": 3, "attn_time_us": 16532.45438907205}, {"doc_id": 25, "doc_len": 8083, "worker_id": 5, "attn_time_us": 505.55506445529664}, {"doc_id": 26, "doc_len": 14760, "worker_id": 7, "attn_time_us": 2534.5119625075217}, {"doc_id": 27, "doc_len": 8420, "worker_id": 1, "attn_time_us": 541.9450681084887}, {"doc_id": 28, "doc_len": 8823, "worker_id": 0, "attn_time_us": 1112.5809654504883}, {"doc_id": 29, "doc_len": 29953, "worker_id": 7, "attn_time_us": 10158.389211218013}], "mlp_tp": 8, "mlp_cp": 8}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 1, "dp": 64, "ratio": 0.14193697982043285, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 448523, "worker_latencies_us": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 113533, 316995, 114655, 42685, 110380, 14254, 19406, 119367, 49498, 279739, 117070, 143614, 255635, 19353, 14539, 17095, 100664, 38702, 54144, 0, 0, 35667, 81413, 448523, 51171, 152342, 21150, 442353, 15484, 15591, 46481, 46146, 42403, 318576, 271808, 108970], "doc2worker": {"0": 63, "1": 63, "2": 62, "3": 60, "4": 59, "5": 58, "6": 57, "7": 56, "8": 55, "9": 54, "10": 53, "11": 52, "12": 51, "13": 50, "14": 49, "15": 55, "16": 61, "17": 46, "18": 45, "19": 44, "20": 43, "21": 42, "22": 41, "23": 40, "24": 39, "25": 38, "26": 37, "27": 36, "28": 35, "29": 34, "30": 33, "31": 32, "32": 31, "33": 30, "34": 29, "35": 28}, "latency_breakdown": {"max_worker_latency_us": 448523, "worker_latencies_us": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 113533, 316995, 114655, 42685, 110380, 14254, 19406, 119367, 49498, 279739, 117070, 143614, 255635, 19353, 14539, 17095, 100664, 38702, 54144, 0, 0, 35667, 81413, 448523, 51171, 152342, 21150, 442353, 15484, 15591, 46481, 46146, 42403, 318576, 271808, 108970], "solver_status": "OPTIMAL", "solved_time_s": 0.041190147399902344, "num_vars": 2369, "num_cons": 228}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 8, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 9, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 10, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 11, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 12, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 13, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 14, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 15, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 16, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 17, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 18, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 19, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 20, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 21, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 22, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 23, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 24, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 25, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 26, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 27, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 28, "assigned_docs": [35], "total_batch_length": 33889, "total_latency_us": 113533, "mlp_cost_us": 62052.6123046875, "attn_cost_us": 51481.22690183873, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 29, "assigned_docs": [34], "total_batch_length": 66136, "total_latency_us": 316995, "mlp_cost_us": 121098.6328125, "attn_cost_us": 195896.74395842027, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 30, "assigned_docs": [33], "total_batch_length": 34119, "total_latency_us": 114655, "mlp_cost_us": 62473.7548828125, "attn_cost_us": 52181.625060605606, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 31, "assigned_docs": [32], "total_batch_length": 16523, "total_latency_us": 42685, "mlp_cost_us": 30254.5166015625, "attn_cost_us": 12430.809778655346, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 32, "assigned_docs": [31], "total_batch_length": 33237, "total_latency_us": 110380, "mlp_cost_us": 60858.7646484375, "attn_cost_us": 49521.44474681755, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 33, "assigned_docs": [30], "total_batch_length": 6624, "total_latency_us": 14254, "mlp_cost_us": 12128.90625, "attn_cost_us": 2125.4298672584223, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 34, "assigned_docs": [29], "total_batch_length": 8666, "total_latency_us": 19406, "mlp_cost_us": 15867.919921875, "attn_cost_us": 3538.300045188211, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 35, "assigned_docs": [28], "total_batch_length": 35075, "total_latency_us": 119367, "mlp_cost_us": 64224.2431640625, "attn_cost_us": 55143.503153732825, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 36, "assigned_docs": [27], "total_batch_length": 18523, "total_latency_us": 49498, "mlp_cost_us": 33916.6259765625, "attn_cost_us": 15581.75697846518, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 37, "assigned_docs": [26], "total_batch_length": 61200, "total_latency_us": 279739, "mlp_cost_us": 112060.546875, "attn_cost_us": 167678.62837886447, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 38, "assigned_docs": [25], "total_batch_length": 34611, "total_latency_us": 117070, "mlp_cost_us": 63374.6337890625, "attn_cost_us": 53695.73933478396, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 39, "assigned_docs": [24], "total_batch_length": 39755, "total_latency_us": 143614, "mlp_cost_us": 72793.5791015625, "attn_cost_us": 70821.412082339, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 40, "assigned_docs": [23], "total_batch_length": 57831, "total_latency_us": 255635, "mlp_cost_us": 105891.7236328125, "attn_cost_us": 149744.05366708437, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 41, "assigned_docs": [22], "total_batch_length": 8646, "total_latency_us": 19353, "mlp_cost_us": 15831.298828125, "attn_cost_us": 3522.4210620170466, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 42, "assigned_docs": [21], "total_batch_length": 6741, "total_latency_us": 14539, "mlp_cost_us": 12343.1396484375, "attn_cost_us": 2196.692180255907, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 43, "assigned_docs": [20], "total_batch_length": 7769, "total_latency_us": 17095, "mlp_cost_us": 14225.4638671875, "attn_cost_us": 2869.9342482594743, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 44, "assigned_docs": [19], "total_batch_length": 31167, "total_latency_us": 100664, "mlp_cost_us": 57068.4814453125, "attn_cost_us": 43596.08707192562, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 45, "assigned_docs": [18], "total_batch_length": 15296, "total_latency_us": 38702, "mlp_cost_us": 28007.8125, "attn_cost_us": 10694.299804824514, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 46, "assigned_docs": [17], "total_batch_length": 19831, "total_latency_us": 54144, "mlp_cost_us": 36311.6455078125, "attn_cost_us": 17832.387087974592, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 47, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 48, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 49, "assigned_docs": [14], "total_batch_length": 14333, "total_latency_us": 35667, "mlp_cost_us": 26244.5068359375, "attn_cost_us": 9422.735567952639, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 50, "assigned_docs": [13], "total_batch_length": 26799, "total_latency_us": 81413, "mlp_cost_us": 49070.4345703125, "attn_cost_us": 32343.36027657651, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 51, "assigned_docs": [12], "total_batch_length": 81288, "total_latency_us": 448523, "mlp_cost_us": 148842.7734375, "attn_cost_us": 299680.263614243, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 52, "assigned_docs": [11], "total_batch_length": 18999, "total_latency_us": 51171, "mlp_cost_us": 34788.2080078125, "attn_cost_us": 16383.429026930326, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 53, "assigned_docs": [10], "total_batch_length": 41353, "total_latency_us": 152342, "mlp_cost_us": 75719.6044921875, "attn_cost_us": 76622.79730291959, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 54, "assigned_docs": [9], "total_batch_length": 9323, "total_latency_us": 21150, "mlp_cost_us": 17070.9228515625, "attn_cost_us": 4079.209329109582, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 55, "assigned_docs": [8, 15], "total_batch_length": 94333, "total_latency_us": 442353, "mlp_cost_us": 172728.8818359375, "attn_cost_us": 269625.3041832984, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 56, "assigned_docs": [7], "total_batch_length": 7125, "total_latency_us": 15484, "mlp_cost_us": 13046.2646484375, "attn_cost_us": 2438.3055908087563, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 57, "assigned_docs": [6], "total_batch_length": 7168, "total_latency_us": 15591, "mlp_cost_us": 13125.0, "attn_cost_us": 2466.0964543716436, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 58, "assigned_docs": [5], "total_batch_length": 17650, "total_latency_us": 46481, "mlp_cost_us": 32318.115234375, "attn_cost_us": 14163.145989489638, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 59, "assigned_docs": [4], "total_batch_length": 17552, "total_latency_us": 46146, "mlp_cost_us": 32138.671875, "attn_cost_us": 14008.076101702993, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 60, "assigned_docs": [3], "total_batch_length": 16438, "total_latency_us": 42403, "mlp_cost_us": 30098.876953125, "attn_cost_us": 12304.684351991054, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 61, "assigned_docs": [16], "total_batch_length": 66335, "total_latency_us": 318576, "mlp_cost_us": 121463.0126953125, "attn_cost_us": 197113.45411484735, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 62, "assigned_docs": [2], "total_batch_length": 60107, "total_latency_us": 271808, "mlp_cost_us": 110059.2041015625, "attn_cost_us": 161749.12538081716, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 63, "assigned_docs": [0, 1], "total_batch_length": 34134, "total_latency_us": 108970, "mlp_cost_us": 62501.220703125, "attn_cost_us": 46470.473803181485, "allreduce_cost_us": 0, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 63, "attn_time_us": 253.32256943089865, "mlp_time_us": 3722.5341796875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 3975}, {"doc_id": 1, "doc_len": 32101, "worker_id": 63, "attn_time_us": 46217.151233750585, "mlp_time_us": 58778.6865234375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 104995}, {"doc_id": 2, "doc_len": 60107, "worker_id": 62, "attn_time_us": 161749.12538081716, "mlp_time_us": 110059.2041015625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 271808}, {"doc_id": 3, "doc_len": 16438, "worker_id": 60, "attn_time_us": 12304.684351991054, "mlp_time_us": 30098.876953125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 42403}, {"doc_id": 4, "doc_len": 17552, "worker_id": 59, "attn_time_us": 14008.076101702993, "mlp_time_us": 32138.671875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 46146}, {"doc_id": 5, "doc_len": 17650, "worker_id": 58, "attn_time_us": 14163.145989489638, "mlp_time_us": 32318.115234375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 46481}, {"doc_id": 6, "doc_len": 7168, "worker_id": 57, "attn_time_us": 2466.0964543716436, "mlp_time_us": 13125.0, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 15591}, {"doc_id": 7, "doc_len": 7125, "worker_id": 56, "attn_time_us": 2438.3055908087563, "mlp_time_us": 13046.2646484375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 15484}, {"doc_id": 8, "doc_len": 19562, "worker_id": 55, "attn_time_us": 17357.27617395289, "mlp_time_us": 35819.091796875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 53176}, {"doc_id": 9, "doc_len": 9323, "worker_id": 54, "attn_time_us": 4079.209329109582, "mlp_time_us": 17070.9228515625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 21150}, {"doc_id": 10, "doc_len": 41353, "worker_id": 53, "attn_time_us": 76622.79730291959, "mlp_time_us": 75719.6044921875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 152342}, {"doc_id": 11, "doc_len": 18999, "worker_id": 52, "attn_time_us": 16383.429026930326, "mlp_time_us": 34788.2080078125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 51171}, {"doc_id": 12, "doc_len": 81288, "worker_id": 51, "attn_time_us": 299680.263614243, "mlp_time_us": 148842.7734375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 448523}, {"doc_id": 13, "doc_len": 26799, "worker_id": 50, "attn_time_us": 32343.36027657651, "mlp_time_us": 49070.4345703125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 81413}, {"doc_id": 14, "doc_len": 14333, "worker_id": 49, "attn_time_us": 9422.735567952639, "mlp_time_us": 26244.5068359375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 35667}, {"doc_id": 15, "doc_len": 74771, "worker_id": 55, "attn_time_us": 252268.02800934546, "mlp_time_us": 136909.7900390625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 389177}, {"doc_id": 16, "doc_len": 66335, "worker_id": 61, "attn_time_us": 197113.45411484735, "mlp_time_us": 121463.0126953125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 318576}, {"doc_id": 17, "doc_len": 19831, "worker_id": 46, "attn_time_us": 17832.387087974592, "mlp_time_us": 36311.6455078125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 54144}, {"doc_id": 18, "doc_len": 15296, "worker_id": 45, "attn_time_us": 10694.299804824514, "mlp_time_us": 28007.8125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 38702}, {"doc_id": 19, "doc_len": 31167, "worker_id": 44, "attn_time_us": 43596.08707192562, "mlp_time_us": 57068.4814453125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 100664}, {"doc_id": 20, "doc_len": 7769, "worker_id": 43, "attn_time_us": 2869.9342482594743, "mlp_time_us": 14225.4638671875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 17095}, {"doc_id": 21, "doc_len": 6741, "worker_id": 42, "attn_time_us": 2196.692180255907, "mlp_time_us": 12343.1396484375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 14539}, {"doc_id": 22, "doc_len": 8646, "worker_id": 41, "attn_time_us": 3522.4210620170466, "mlp_time_us": 15831.298828125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 19353}, {"doc_id": 23, "doc_len": 57831, "worker_id": 40, "attn_time_us": 149744.05366708437, "mlp_time_us": 105891.7236328125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 255635}, {"doc_id": 24, "doc_len": 39755, "worker_id": 39, "attn_time_us": 70821.412082339, "mlp_time_us": 72793.5791015625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 143614}, {"doc_id": 25, "doc_len": 34611, "worker_id": 38, "attn_time_us": 53695.73933478396, "mlp_time_us": 63374.6337890625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 117070}, {"doc_id": 26, "doc_len": 61200, "worker_id": 37, "attn_time_us": 167678.62837886447, "mlp_time_us": 112060.546875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 279739}, {"doc_id": 27, "doc_len": 18523, "worker_id": 36, "attn_time_us": 15581.75697846518, "mlp_time_us": 33916.6259765625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 49498}, {"doc_id": 28, "doc_len": 35075, "worker_id": 35, "attn_time_us": 55143.503153732825, "mlp_time_us": 64224.2431640625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 119367}, {"doc_id": 29, "doc_len": 8666, "worker_id": 34, "attn_time_us": 3538.300045188211, "mlp_time_us": 15867.919921875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 19406}, {"doc_id": 30, "doc_len": 6624, "worker_id": 33, "attn_time_us": 2125.4298672584223, "mlp_time_us": 12128.90625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 14254}, {"doc_id": 31, "doc_len": 33237, "worker_id": 32, "attn_time_us": 49521.44474681755, "mlp_time_us": 60858.7646484375, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 110380}, {"doc_id": 32, "doc_len": 16523, "worker_id": 31, "attn_time_us": 12430.809778655346, "mlp_time_us": 30254.5166015625, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 42685}, {"doc_id": 33, "doc_len": 34119, "worker_id": 30, "attn_time_us": 52181.625060605606, "mlp_time_us": 62473.7548828125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 114655}, {"doc_id": 34, "doc_len": 66136, "worker_id": 29, "attn_time_us": 195896.74395842027, "mlp_time_us": 121098.6328125, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 316995}, {"doc_id": 35, "doc_len": 33889, "worker_id": 28, "attn_time_us": 51481.22690183873, "mlp_time_us": 62052.6123046875, "allgather_time_us": 0, "allreduce_time_us": 0, "total_latency_us": 113533}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 253.32256943089865, "mlp_time": 3722.5341796875, "allgather_time": 0, "allreduce_time": 0}, "1": {"doc_len": 32101, "attn_time": 46217.151233750585, "mlp_time": 58778.6865234375, "allgather_time": 0, "allreduce_time": 0}, "2": {"doc_len": 60107, "attn_time": 161749.12538081716, "mlp_time": 110059.2041015625, "allgather_time": 0, "allreduce_time": 0}, "3": {"doc_len": 16438, "attn_time": 12304.684351991054, "mlp_time": 30098.876953125, "allgather_time": 0, "allreduce_time": 0}, "4": {"doc_len": 17552, "attn_time": 14008.076101702993, "mlp_time": 32138.671875, "allgather_time": 0, "allreduce_time": 0}, "5": {"doc_len": 17650, "attn_time": 14163.145989489638, "mlp_time": 32318.115234375, "allgather_time": 0, "allreduce_time": 0}, "6": {"doc_len": 7168, "attn_time": 2466.0964543716436, "mlp_time": 13125.0, "allgather_time": 0, "allreduce_time": 0}, "7": {"doc_len": 7125, "attn_time": 2438.3055908087563, "mlp_time": 13046.2646484375, "allgather_time": 0, "allreduce_time": 0}, "8": {"doc_len": 19562, "attn_time": 17357.27617395289, "mlp_time": 35819.091796875, "allgather_time": 0, "allreduce_time": 0}, "9": {"doc_len": 9323, "attn_time": 4079.209329109582, "mlp_time": 17070.9228515625, "allgather_time": 0, "allreduce_time": 0}, "10": {"doc_len": 41353, "attn_time": 76622.79730291959, "mlp_time": 75719.6044921875, "allgather_time": 0, "allreduce_time": 0}, "11": {"doc_len": 18999, "attn_time": 16383.429026930326, "mlp_time": 34788.2080078125, "allgather_time": 0, "allreduce_time": 0}, "12": {"doc_len": 81288, "attn_time": 299680.263614243, "mlp_time": 148842.7734375, "allgather_time": 0, "allreduce_time": 0}, "13": {"doc_len": 26799, "attn_time": 32343.36027657651, "mlp_time": 49070.4345703125, "allgather_time": 0, "allreduce_time": 0}, "14": {"doc_len": 14333, "attn_time": 9422.735567952639, "mlp_time": 26244.5068359375, "allgather_time": 0, "allreduce_time": 0}, "15": {"doc_len": 74771, "attn_time": 252268.02800934546, "mlp_time": 136909.7900390625, "allgather_time": 0, "allreduce_time": 0}, "16": {"doc_len": 66335, "attn_time": 197113.45411484735, "mlp_time": 121463.0126953125, "allgather_time": 0, "allreduce_time": 0}, "17": {"doc_len": 19831, "attn_time": 17832.387087974592, "mlp_time": 36311.6455078125, "allgather_time": 0, "allreduce_time": 0}, "18": {"doc_len": 15296, "attn_time": 10694.299804824514, "mlp_time": 28007.8125, "allgather_time": 0, "allreduce_time": 0}, "19": {"doc_len": 31167, "attn_time": 43596.08707192562, "mlp_time": 57068.4814453125, "allgather_time": 0, "allreduce_time": 0}, "20": {"doc_len": 7769, "attn_time": 2869.9342482594743, "mlp_time": 14225.4638671875, "allgather_time": 0, "allreduce_time": 0}, "21": {"doc_len": 6741, "attn_time": 2196.692180255907, "mlp_time": 12343.1396484375, "allgather_time": 0, "allreduce_time": 0}, "22": {"doc_len": 8646, "attn_time": 3522.4210620170466, "mlp_time": 15831.298828125, "allgather_time": 0, "allreduce_time": 0}, "23": {"doc_len": 57831, "attn_time": 149744.05366708437, "mlp_time": 105891.7236328125, "allgather_time": 0, "allreduce_time": 0}, "24": {"doc_len": 39755, "attn_time": 70821.412082339, "mlp_time": 72793.5791015625, "allgather_time": 0, "allreduce_time": 0}, "25": {"doc_len": 34611, "attn_time": 53695.73933478396, "mlp_time": 63374.6337890625, "allgather_time": 0, "allreduce_time": 0}, "26": {"doc_len": 61200, "attn_time": 167678.62837886447, "mlp_time": 112060.546875, "allgather_time": 0, "allreduce_time": 0}, "27": {"doc_len": 18523, "attn_time": 15581.75697846518, "mlp_time": 33916.6259765625, "allgather_time": 0, "allreduce_time": 0}, "28": {"doc_len": 35075, "attn_time": 55143.503153732825, "mlp_time": 64224.2431640625, "allgather_time": 0, "allreduce_time": 0}, "29": {"doc_len": 8666, "attn_time": 3538.300045188211, "mlp_time": 15867.919921875, "allgather_time": 0, "allreduce_time": 0}, "30": {"doc_len": 6624, "attn_time": 2125.4298672584223, "mlp_time": 12128.90625, "allgather_time": 0, "allreduce_time": 0}, "31": {"doc_len": 33237, "attn_time": 49521.44474681755, "mlp_time": 60858.7646484375, "allgather_time": 0, "allreduce_time": 0}, "32": {"doc_len": 16523, "attn_time": 12430.809778655346, "mlp_time": 30254.5166015625, "allgather_time": 0, "allreduce_time": 0}, "33": {"doc_len": 34119, "attn_time": 52181.625060605606, "mlp_time": 62473.7548828125, "allgather_time": 0, "allreduce_time": 0}, "34": {"doc_len": 66136, "attn_time": 195896.74395842027, "mlp_time": 121098.6328125, "allgather_time": 0, "allreduce_time": 0}, "35": {"doc_len": 33889, "attn_time": 51481.22690183873, "mlp_time": 62052.6123046875, "allgather_time": 0, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 63662.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 1, "mlp_cp": 1}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 2, "dp": 32, "ratio": 0.29765845630178234, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 213876, "worker_latencies_us": [210381, 141876, 10059, 59669, 25214, 136145, 58550, 71428, 124815, 10032, 7578, 8879, 50543, 19807, 27544, 154288, 186802, 18294, 41091, 213876, 26054, 75640, 10953, 27059, 8060, 8115, 23698, 23530, 21644, 132422, 0, 54751], "doc2worker": {"0": 31, "1": 31, "2": 29, "3": 28, "4": 27, "5": 26, "6": 25, "7": 24, "8": 23, "9": 22, "10": 21, "11": 20, "12": 19, "13": 18, "14": 17, "15": 16, "16": 15, "17": 14, "18": 13, "19": 12, "20": 11, "21": 10, "22": 9, "23": 8, "24": 7, "25": 6, "26": 5, "27": 4, "28": 3, "29": 2, "30": 1, "31": 1, "32": 1, "33": 1, "34": 0, "35": 0}, "latency_breakdown": {"max_worker_latency_us": 213876, "worker_latencies_us": [210381, 141876, 10059, 59669, 25214, 136145, 58550, 71428, 124815, 10032, 7578, 8879, 50543, 19807, 27544, 154288, 186802, 18294, 41091, 213876, 26054, 75640, 10953, 27059, 8060, 8115, 23698, 23530, 21644, 132422, 0, 54751], "solver_status": "OPTIMAL", "solved_time_s": 0.040169715881347656, "num_vars": 1185, "num_cons": 132}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [34, 35], "total_batch_length": 100025, "total_latency_us": 210381, "mlp_cost_us": 91575.62255859375, "attn_cost_us": 118312.04878419863, "allreduce_cost_us": 0, "allgather_cost_us": 494.6037530899048}, {"worker_id": 1, "assigned_docs": [30, 31, 32, 33], "total_batch_length": 90503, "total_latency_us": 141876, "mlp_cost_us": 82857.97119140625, "attn_cost_us": 58572.562434687454, "allreduce_cost_us": 0, "allgather_cost_us": 447.5193548202514}, {"worker_id": 2, "assigned_docs": [29], "total_batch_length": 8666, "total_latency_us": 10059, "mlp_cost_us": 7933.9599609375, "attn_cost_us": 2082.3264460628784, "allreduce_cost_us": 0, "allgather_cost_us": 42.85164833068848}, {"worker_id": 3, "assigned_docs": [28], "total_batch_length": 35075, "total_latency_us": 59669, "mlp_cost_us": 32112.12158203125, "attn_cost_us": 27383.658263123114, "allreduce_cost_us": 0, "allgather_cost_us": 173.4389066696167}, {"worker_id": 4, "assigned_docs": [27], "total_batch_length": 18523, "total_latency_us": 25214, "mlp_cost_us": 16958.31298828125, "attn_cost_us": 8165.01932511218, "allreduce_cost_us": 0, "allgather_cost_us": 91.59255504608153}, {"worker_id": 5, "assigned_docs": [26], "total_batch_length": 61200, "total_latency_us": 136145, "mlp_cost_us": 56030.2734375, "attn_cost_us": 79812.7480259069, "allreduce_cost_us": 0, "allgather_cost_us": 302.62184143066406}, {"worker_id": 6, "assigned_docs": [25], "total_batch_length": 34611, "total_latency_us": 58550, "mlp_cost_us": 31687.31689453125, "attn_cost_us": 26691.758651853317, "allreduce_cost_us": 0, "allgather_cost_us": 171.14451885223386}, {"worker_id": 7, "assigned_docs": [24], "total_batch_length": 39755, "total_latency_us": 71428, "mlp_cost_us": 36396.78955078125, "attn_cost_us": 34835.42859336094, "allreduce_cost_us": 0, "allgather_cost_us": 196.58057689666748}, {"worker_id": 8, "assigned_docs": [23], "total_batch_length": 57831, "total_latency_us": 124815, "mlp_cost_us": 52945.86181640625, "attn_cost_us": 71584.00782032158, "allreduce_cost_us": 0, "allgather_cost_us": 285.96280574798584}, {"worker_id": 9, "assigned_docs": [22], "total_batch_length": 8646, "total_latency_us": 10032, "mlp_cost_us": 7915.6494140625, "attn_cost_us": 2073.7760471252377, "allreduce_cost_us": 0, "allgather_cost_us": 42.75275230407714}, {"worker_id": 10, "assigned_docs": [21], "total_batch_length": 6741, "total_latency_us": 7578, "mlp_cost_us": 6171.56982421875, "attn_cost_us": 1373.2747285850926, "allreduce_cost_us": 0, "allgather_cost_us": 33.332905769348145}, {"worker_id": 11, "assigned_docs": [20], "total_batch_length": 7769, "total_latency_us": 8879, "mlp_cost_us": 7112.73193359375, "attn_cost_us": 1728.6626520314417, "allreduce_cost_us": 0, "allgather_cost_us": 38.41616153717041}, {"worker_id": 12, "assigned_docs": [19], "total_batch_length": 31167, "total_latency_us": 50543, "mlp_cost_us": 28534.24072265625, "attn_cost_us": 21854.769142382695, "allreduce_cost_us": 0, "allgather_cost_us": 154.11462306976318}, {"worker_id": 13, "assigned_docs": [18], "total_batch_length": 15296, "total_latency_us": 19807, "mlp_cost_us": 14003.90625, "attn_cost_us": 5727.699981681471, "allreduce_cost_us": 0, "allgather_cost_us": 75.63568115234375}, {"worker_id": 14, "assigned_docs": [17], "total_batch_length": 19831, "total_latency_us": 27544, "mlp_cost_us": 18155.82275390625, "attn_cost_us": 9290.242605843745, "allreduce_cost_us": 0, "allgather_cost_us": 98.06035518646239}, {"worker_id": 15, "assigned_docs": [16], "total_batch_length": 66335, "total_latency_us": 154288, "mlp_cost_us": 60731.50634765625, "attn_cost_us": 93229.26069177261, "allreduce_cost_us": 0, "allgather_cost_us": 328.01339626312256}, {"worker_id": 16, "assigned_docs": [15], "total_batch_length": 74771, "total_latency_us": 186802, "mlp_cost_us": 68454.89501953125, "attn_cost_us": 117978.29090151131, "allreduce_cost_us": 0, "allgather_cost_us": 369.7277402877807}, {"worker_id": 17, "assigned_docs": [14], "total_batch_length": 14333, "total_latency_us": 18294, "mlp_cost_us": 13122.25341796875, "attn_cost_us": 5101.393027007595, "allreduce_cost_us": 0, "allgather_cost_us": 70.8738374710083}, {"worker_id": 18, "assigned_docs": [13], "total_batch_length": 26799, "total_latency_us": 41091, "mlp_cost_us": 24535.21728515625, "attn_cost_us": 16423.569654734274, "allreduce_cost_us": 0, "allgather_cost_us": 132.51573085784912}, {"worker_id": 19, "assigned_docs": [12], "total_batch_length": 81288, "total_latency_us": 213876, "mlp_cost_us": 74421.38671875, "attn_cost_us": 139052.94633139973, "allreduce_cost_us": 0, "allgather_cost_us": 401.953010559082}, {"worker_id": 20, "assigned_docs": [11], "total_batch_length": 18999, "total_latency_us": 26054, "mlp_cost_us": 17394.10400390625, "attn_cost_us": 8566.576791258423, "allreduce_cost_us": 0, "allgather_cost_us": 93.94628047943114}, {"worker_id": 21, "assigned_docs": [10], "total_batch_length": 41353, "total_latency_us": 75640, "mlp_cost_us": 37859.80224609375, "attn_cost_us": 37576.10377301116, "allreduce_cost_us": 0, "allgather_cost_us": 204.4823694229126}, {"worker_id": 22, "assigned_docs": [9], "total_batch_length": 9323, "total_latency_us": 10953, "mlp_cost_us": 8535.46142578125, "attn_cost_us": 2371.7363421086025, "allreduce_cost_us": 0, "allgather_cost_us": 46.100382804870605}, {"worker_id": 23, "assigned_docs": [8], "total_batch_length": 19562, "total_latency_us": 27059, "mlp_cost_us": 17909.5458984375, "attn_cost_us": 9053.243262945314, "allreduce_cost_us": 0, "allgather_cost_us": 96.73020362854002}, {"worker_id": 24, "assigned_docs": [7], "total_batch_length": 7125, "total_latency_us": 8060, "mlp_cost_us": 6523.13232421875, "attn_cost_us": 1502.354712042882, "allreduce_cost_us": 0, "allgather_cost_us": 35.231709480285645}, {"worker_id": 25, "assigned_docs": [6], "total_batch_length": 7168, "total_latency_us": 8115, "mlp_cost_us": 6562.5, "attn_cost_us": 1517.084484735053, "allreduce_cost_us": 0, "allgather_cost_us": 35.44433593749999}, {"worker_id": 26, "assigned_docs": [5], "total_batch_length": 17650, "total_latency_us": 23698, "mlp_cost_us": 16159.0576171875, "attn_cost_us": 7452.2220961931735, "allreduce_cost_us": 0, "allgather_cost_us": 87.27574348449707}, {"worker_id": 27, "assigned_docs": [4], "total_batch_length": 17552, "total_latency_us": 23530, "mlp_cost_us": 16069.3359375, "attn_cost_us": 7374.124179968006, "allreduce_cost_us": 0, "allgather_cost_us": 86.79115295410156}, {"worker_id": 28, "assigned_docs": [3], "total_batch_length": 16438, "total_latency_us": 21644, "mlp_cost_us": 15049.4384765625, "attn_cost_us": 6513.692432089497, "allreduce_cost_us": 0, "allgather_cost_us": 81.28264427185059}, {"worker_id": 29, "assigned_docs": [2], "total_batch_length": 60107, "total_latency_us": 132422, "mlp_cost_us": 55029.60205078125, "attn_cost_us": 77096.0707258817, "allreduce_cost_us": 0, "allgather_cost_us": 297.217173576355}, {"worker_id": 30, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 31, "assigned_docs": [0, 1], "total_batch_length": 34134, "total_latency_us": 54751, "mlp_cost_us": 31250.6103515625, "attn_cost_us": 23332.399104221295, "allreduce_cost_us": 0, "allgather_cost_us": 168.7858486175537}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 31, "attn_time_us": 221.86498003748065, "mlp_time_us": 1861.26708984375, "allgather_time_us": 10.052781105041504, "allreduce_time_us": 0, "total_latency_us": 2093}, {"doc_id": 1, "doc_len": 32101, "worker_id": 31, "attn_time_us": 23110.534124183814, "mlp_time_us": 29389.34326171875, "allgather_time_us": 158.7330675125122, "allreduce_time_us": 0, "total_latency_us": 52658}, {"doc_id": 2, "doc_len": 60107, "worker_id": 29, "attn_time_us": 77096.0707258817, "mlp_time_us": 55029.60205078125, "allgather_time_us": 297.217173576355, "allreduce_time_us": 0, "total_latency_us": 132422}, {"doc_id": 3, "doc_len": 16438, "worker_id": 28, "attn_time_us": 6513.692432089497, "mlp_time_us": 15049.4384765625, "allgather_time_us": 81.28264427185059, "allreduce_time_us": 0, "total_latency_us": 21644}, {"doc_id": 4, "doc_len": 17552, "worker_id": 27, "attn_time_us": 7374.124179968006, "mlp_time_us": 16069.3359375, "allgather_time_us": 86.79115295410156, "allreduce_time_us": 0, "total_latency_us": 23530}, {"doc_id": 5, "doc_len": 17650, "worker_id": 26, "attn_time_us": 7452.2220961931735, "mlp_time_us": 16159.0576171875, "allgather_time_us": 87.27574348449707, "allreduce_time_us": 0, "total_latency_us": 23698}, {"doc_id": 6, "doc_len": 7168, "worker_id": 25, "attn_time_us": 1517.084484735053, "mlp_time_us": 6562.5, "allgather_time_us": 35.44433593749999, "allreduce_time_us": 0, "total_latency_us": 8115}, {"doc_id": 7, "doc_len": 7125, "worker_id": 24, "attn_time_us": 1502.354712042882, "mlp_time_us": 6523.13232421875, "allgather_time_us": 35.231709480285645, "allreduce_time_us": 0, "total_latency_us": 8060}, {"doc_id": 8, "doc_len": 19562, "worker_id": 23, "attn_time_us": 9053.243262945314, "mlp_time_us": 17909.5458984375, "allgather_time_us": 96.73020362854002, "allreduce_time_us": 0, "total_latency_us": 27059}, {"doc_id": 9, "doc_len": 9323, "worker_id": 22, "attn_time_us": 2371.7363421086025, "mlp_time_us": 8535.46142578125, "allgather_time_us": 46.100382804870605, "allreduce_time_us": 0, "total_latency_us": 10953}, {"doc_id": 10, "doc_len": 41353, "worker_id": 21, "attn_time_us": 37576.10377301116, "mlp_time_us": 37859.80224609375, "allgather_time_us": 204.4823694229126, "allreduce_time_us": 0, "total_latency_us": 75640}, {"doc_id": 11, "doc_len": 18999, "worker_id": 20, "attn_time_us": 8566.576791258423, "mlp_time_us": 17394.10400390625, "allgather_time_us": 93.94628047943114, "allreduce_time_us": 0, "total_latency_us": 26054}, {"doc_id": 12, "doc_len": 81288, "worker_id": 19, "attn_time_us": 139052.94633139973, "mlp_time_us": 74421.38671875, "allgather_time_us": 401.953010559082, "allreduce_time_us": 0, "total_latency_us": 213876}, {"doc_id": 13, "doc_len": 26799, "worker_id": 18, "attn_time_us": 16423.569654734274, "mlp_time_us": 24535.21728515625, "allgather_time_us": 132.51573085784912, "allreduce_time_us": 0, "total_latency_us": 41091}, {"doc_id": 14, "doc_len": 14333, "worker_id": 17, "attn_time_us": 5101.393027007595, "mlp_time_us": 13122.25341796875, "allgather_time_us": 70.8738374710083, "allreduce_time_us": 0, "total_latency_us": 18294}, {"doc_id": 15, "doc_len": 74771, "worker_id": 16, "attn_time_us": 117978.29090151131, "mlp_time_us": 68454.89501953125, "allgather_time_us": 369.7277402877807, "allreduce_time_us": 0, "total_latency_us": 186802}, {"doc_id": 16, "doc_len": 66335, "worker_id": 15, "attn_time_us": 93229.26069177261, "mlp_time_us": 60731.50634765625, "allgather_time_us": 328.01339626312256, "allreduce_time_us": 0, "total_latency_us": 154288}, {"doc_id": 17, "doc_len": 19831, "worker_id": 14, "attn_time_us": 9290.242605843745, "mlp_time_us": 18155.82275390625, "allgather_time_us": 98.06035518646239, "allreduce_time_us": 0, "total_latency_us": 27544}, {"doc_id": 18, "doc_len": 15296, "worker_id": 13, "attn_time_us": 5727.699981681471, "mlp_time_us": 14003.90625, "allgather_time_us": 75.63568115234375, "allreduce_time_us": 0, "total_latency_us": 19807}, {"doc_id": 19, "doc_len": 31167, "worker_id": 12, "attn_time_us": 21854.769142382695, "mlp_time_us": 28534.24072265625, "allgather_time_us": 154.11462306976318, "allreduce_time_us": 0, "total_latency_us": 50543}, {"doc_id": 20, "doc_len": 7769, "worker_id": 11, "attn_time_us": 1728.6626520314417, "mlp_time_us": 7112.73193359375, "allgather_time_us": 38.41616153717041, "allreduce_time_us": 0, "total_latency_us": 8879}, {"doc_id": 21, "doc_len": 6741, "worker_id": 10, "attn_time_us": 1373.2747285850926, "mlp_time_us": 6171.56982421875, "allgather_time_us": 33.332905769348145, "allreduce_time_us": 0, "total_latency_us": 7578}, {"doc_id": 22, "doc_len": 8646, "worker_id": 9, "attn_time_us": 2073.7760471252377, "mlp_time_us": 7915.6494140625, "allgather_time_us": 42.75275230407714, "allreduce_time_us": 0, "total_latency_us": 10032}, {"doc_id": 23, "doc_len": 57831, "worker_id": 8, "attn_time_us": 71584.00782032158, "mlp_time_us": 52945.86181640625, "allgather_time_us": 285.96280574798584, "allreduce_time_us": 0, "total_latency_us": 124815}, {"doc_id": 24, "doc_len": 39755, "worker_id": 7, "attn_time_us": 34835.42859336094, "mlp_time_us": 36396.78955078125, "allgather_time_us": 196.58057689666748, "allreduce_time_us": 0, "total_latency_us": 71428}, {"doc_id": 25, "doc_len": 34611, "worker_id": 6, "attn_time_us": 26691.758651853317, "mlp_time_us": 31687.31689453125, "allgather_time_us": 171.14451885223386, "allreduce_time_us": 0, "total_latency_us": 58550}, {"doc_id": 26, "doc_len": 61200, "worker_id": 5, "attn_time_us": 79812.7480259069, "mlp_time_us": 56030.2734375, "allgather_time_us": 302.62184143066406, "allreduce_time_us": 0, "total_latency_us": 136145}, {"doc_id": 27, "doc_len": 18523, "worker_id": 4, "attn_time_us": 8165.01932511218, "mlp_time_us": 16958.31298828125, "allgather_time_us": 91.59255504608153, "allreduce_time_us": 0, "total_latency_us": 25214}, {"doc_id": 28, "doc_len": 35075, "worker_id": 3, "attn_time_us": 27383.658263123114, "mlp_time_us": 32112.12158203125, "allgather_time_us": 173.4389066696167, "allreduce_time_us": 0, "total_latency_us": 59669}, {"doc_id": 29, "doc_len": 8666, "worker_id": 2, "attn_time_us": 2082.3264460628784, "mlp_time_us": 7933.9599609375, "allgather_time_us": 42.85164833068848, "allreduce_time_us": 0, "total_latency_us": 10059}, {"doc_id": 30, "doc_len": 6624, "worker_id": 1, "attn_time_us": 1334.8339879477269, "mlp_time_us": 6064.453125, "allgather_time_us": 32.75436401367187, "allreduce_time_us": 0, "total_latency_us": 7432}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 24692.770316236856, "mlp_time_us": 30429.38232421875, "allgather_time_us": 164.35036182403564, "allreduce_time_us": 0, "total_latency_us": 55286}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 6577.569805519399, "mlp_time_us": 15127.25830078125, "allgather_time_us": 81.70295238494872, "allreduce_time_us": 0, "total_latency_us": 21786}, {"doc_id": 33, "doc_len": 34119, "worker_id": 1, "attn_time_us": 25967.388324983465, "mlp_time_us": 31236.87744140625, "allgather_time_us": 168.7116765975952, "allreduce_time_us": 0, "total_latency_us": 57372}, {"doc_id": 34, "doc_len": 66136, "worker_id": 0, "attn_time_us": 92680.00891631459, "mlp_time_us": 60549.31640625, "allgather_time_us": 327.02938079833984, "allreduce_time_us": 0, "total_latency_us": 153556}, {"doc_id": 35, "doc_len": 33889, "worker_id": 0, "attn_time_us": 25632.03986788404, "mlp_time_us": 31026.30615234375, "allgather_time_us": 167.57437229156494, "allreduce_time_us": 0, "total_latency_us": 56825}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 221.86498003748065, "mlp_time": 1861.26708984375, "allgather_time": 10.052781105041504, "allreduce_time": 0}, "1": {"doc_len": 32101, "attn_time": 23110.534124183814, "mlp_time": 29389.34326171875, "allgather_time": 158.7330675125122, "allreduce_time": 0}, "2": {"doc_len": 60107, "attn_time": 77096.0707258817, "mlp_time": 55029.60205078125, "allgather_time": 297.217173576355, "allreduce_time": 0}, "3": {"doc_len": 16438, "attn_time": 6513.692432089497, "mlp_time": 15049.4384765625, "allgather_time": 81.28264427185059, "allreduce_time": 0}, "4": {"doc_len": 17552, "attn_time": 7374.124179968006, "mlp_time": 16069.3359375, "allgather_time": 86.79115295410156, "allreduce_time": 0}, "5": {"doc_len": 17650, "attn_time": 7452.2220961931735, "mlp_time": 16159.0576171875, "allgather_time": 87.27574348449707, "allreduce_time": 0}, "6": {"doc_len": 7168, "attn_time": 1517.084484735053, "mlp_time": 6562.5, "allgather_time": 35.44433593749999, "allreduce_time": 0}, "7": {"doc_len": 7125, "attn_time": 1502.354712042882, "mlp_time": 6523.13232421875, "allgather_time": 35.231709480285645, "allreduce_time": 0}, "8": {"doc_len": 19562, "attn_time": 9053.243262945314, "mlp_time": 17909.5458984375, "allgather_time": 96.73020362854002, "allreduce_time": 0}, "9": {"doc_len": 9323, "attn_time": 2371.7363421086025, "mlp_time": 8535.46142578125, "allgather_time": 46.100382804870605, "allreduce_time": 0}, "10": {"doc_len": 41353, "attn_time": 37576.10377301116, "mlp_time": 37859.80224609375, "allgather_time": 204.4823694229126, "allreduce_time": 0}, "11": {"doc_len": 18999, "attn_time": 8566.576791258423, "mlp_time": 17394.10400390625, "allgather_time": 93.94628047943114, "allreduce_time": 0}, "12": {"doc_len": 81288, "attn_time": 139052.94633139973, "mlp_time": 74421.38671875, "allgather_time": 401.953010559082, "allreduce_time": 0}, "13": {"doc_len": 26799, "attn_time": 16423.569654734274, "mlp_time": 24535.21728515625, "allgather_time": 132.51573085784912, "allreduce_time": 0}, "14": {"doc_len": 14333, "attn_time": 5101.393027007595, "mlp_time": 13122.25341796875, "allgather_time": 70.8738374710083, "allreduce_time": 0}, "15": {"doc_len": 74771, "attn_time": 117978.29090151131, "mlp_time": 68454.89501953125, "allgather_time": 369.7277402877807, "allreduce_time": 0}, "16": {"doc_len": 66335, "attn_time": 93229.26069177261, "mlp_time": 60731.50634765625, "allgather_time": 328.01339626312256, "allreduce_time": 0}, "17": {"doc_len": 19831, "attn_time": 9290.242605843745, "mlp_time": 18155.82275390625, "allgather_time": 98.06035518646239, "allreduce_time": 0}, "18": {"doc_len": 15296, "attn_time": 5727.699981681471, "mlp_time": 14003.90625, "allgather_time": 75.63568115234375, "allreduce_time": 0}, "19": {"doc_len": 31167, "attn_time": 21854.769142382695, "mlp_time": 28534.24072265625, "allgather_time": 154.11462306976318, "allreduce_time": 0}, "20": {"doc_len": 7769, "attn_time": 1728.6626520314417, "mlp_time": 7112.73193359375, "allgather_time": 38.41616153717041, "allreduce_time": 0}, "21": {"doc_len": 6741, "attn_time": 1373.2747285850926, "mlp_time": 6171.56982421875, "allgather_time": 33.332905769348145, "allreduce_time": 0}, "22": {"doc_len": 8646, "attn_time": 2073.7760471252377, "mlp_time": 7915.6494140625, "allgather_time": 42.75275230407714, "allreduce_time": 0}, "23": {"doc_len": 57831, "attn_time": 71584.00782032158, "mlp_time": 52945.86181640625, "allgather_time": 285.96280574798584, "allreduce_time": 0}, "24": {"doc_len": 39755, "attn_time": 34835.42859336094, "mlp_time": 36396.78955078125, "allgather_time": 196.58057689666748, "allreduce_time": 0}, "25": {"doc_len": 34611, "attn_time": 26691.758651853317, "mlp_time": 31687.31689453125, "allgather_time": 171.14451885223386, "allreduce_time": 0}, "26": {"doc_len": 61200, "attn_time": 79812.7480259069, "mlp_time": 56030.2734375, "allgather_time": 302.62184143066406, "allreduce_time": 0}, "27": {"doc_len": 18523, "attn_time": 8165.01932511218, "mlp_time": 16958.31298828125, "allgather_time": 91.59255504608153, "allreduce_time": 0}, "28": {"doc_len": 35075, "attn_time": 27383.658263123114, "mlp_time": 32112.12158203125, "allgather_time": 173.4389066696167, "allreduce_time": 0}, "29": {"doc_len": 8666, "attn_time": 2082.3264460628784, "mlp_time": 7933.9599609375, "allgather_time": 42.85164833068848, "allreduce_time": 0}, "30": {"doc_len": 6624, "attn_time": 1334.8339879477269, "mlp_time": 6064.453125, "allgather_time": 32.75436401367187, "allreduce_time": 0}, "31": {"doc_len": 33237, "attn_time": 24692.770316236856, "mlp_time": 30429.38232421875, "allgather_time": 164.35036182403564, "allreduce_time": 0}, "32": {"doc_len": 16523, "attn_time": 6577.569805519399, "mlp_time": 15127.25830078125, "allgather_time": 81.70295238494872, "allreduce_time": 0}, "33": {"doc_len": 34119, "attn_time": 25967.388324983465, "mlp_time": 31236.87744140625, "allgather_time": 168.7116765975952, "allreduce_time": 0}, "34": {"doc_len": 66136, "attn_time": 92680.00891631459, "mlp_time": 60549.31640625, "allgather_time": 327.02938079833984, "allreduce_time": 0}, "35": {"doc_len": 33889, "attn_time": 25632.03986788404, "mlp_time": 31026.30615234375, "allgather_time": 167.57437229156494, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 63662.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 1, "mlp_cp": 2}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 4, "dp": 16, "ratio": 0.581043216355588, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 109565, "worker_latencies_us": [106041, 107549, 107852, 109565, 107986, 109020, 80288, 43709, 82976, 4206, 12291, 12203, 11224, 68061, 31176, 30481], "doc2worker": {"0": 15, "1": 14, "2": 13, "3": 12, "4": 11, "5": 10, "6": 9, "7": 8, "8": 7, "9": 6, "10": 5, "11": 4, "12": 3, "13": 2, "14": 1, "15": 0, "16": 1, "17": 1, "18": 0, "19": 2, "20": 1, "21": 14, "22": 2, "23": 4, "24": 2, "25": 4, "26": 5, "27": 2, "28": 6, "29": 2, "30": 6, "31": 6, "32": 6, "33": 7, "34": 8, "35": 15}, "latency_breakdown": {"max_worker_latency_us": 109565, "worker_latencies_us": [106041, 107549, 107852, 109565, 107986, 109020, 80288, 43709, 82976, 4206, 12291, 12203, 11224, 68061, 31176, 30481], "solver_status": "OPTIMAL", "solved_time_s": 0.030124664306640625, "num_vars": 593, "num_cons": 84}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [15, 18], "total_batch_length": 90067, "total_latency_us": 106041, "mlp_cost_us": 41229.400634765625, "attn_cost_us": 64316.618010262464, "allreduce_cost_us": 0, "allgather_cost_us": 496.47069931030273}, {"worker_id": 1, "assigned_docs": [14, 16, 17, 20], "total_batch_length": 108268, "total_latency_us": 107549, "mlp_cost_us": 49561.1572265625, "attn_cost_us": 57394.676461156734, "allreduce_cost_us": 0, "allgather_cost_us": 596.7989349365234}, {"worker_id": 2, "assigned_docs": [13, 19, 22, 24, 27, 29], "total_batch_length": 133556, "total_latency_us": 107852, "mlp_cost_us": 61137.0849609375, "attn_cost_us": 45979.77760591747, "allreduce_cost_us": 0, "allgather_cost_us": 736.1923980712891}, {"worker_id": 3, "assigned_docs": [12], "total_batch_length": 81288, "total_latency_us": 109565, "mlp_cost_us": 37210.693359375, "attn_cost_us": 71907.16242223006, "allreduce_cost_us": 0, "allgather_cost_us": 448.0787658691406}, {"worker_id": 4, "assigned_docs": [11, 23, 25], "total_batch_length": 111441, "total_latency_us": 107986, "mlp_cost_us": 51013.641357421875, "attn_cost_us": 56359.82698413051, "allreduce_cost_us": 0, "allgather_cost_us": 614.2892646789551}, {"worker_id": 5, "assigned_docs": [10, 26], "total_batch_length": 102553, "total_latency_us": 109020, "mlp_cost_us": 46945.037841796875, "attn_cost_us": 61510.114111703006, "allreduce_cost_us": 0, "allgather_cost_us": 565.2964973449707}, {"worker_id": 6, "assigned_docs": [9, 28, 30, 31, 32], "total_batch_length": 100782, "total_latency_us": 80288, "mlp_cost_us": 46134.33837890625, "attn_cost_us": 33600.40767538861, "allreduce_cost_us": 0, "allgather_cost_us": 555.5343246459961}, {"worker_id": 7, "assigned_docs": [8, 33], "total_batch_length": 53681, "total_latency_us": 43709, "mlp_cost_us": 24573.211669921875, "attn_cost_us": 18841.555933952397, "allreduce_cost_us": 0, "allgather_cost_us": 295.9024238586426}, {"worker_id": 8, "assigned_docs": [7, 34], "total_batch_length": 73261, "total_latency_us": 82976, "mlp_cost_us": 33536.224365234375, "attn_cost_us": 49037.08040297613, "allreduce_cost_us": 0, "allgather_cost_us": 403.83203506469727}, {"worker_id": 9, "assigned_docs": [6], "total_batch_length": 7168, "total_latency_us": 4206, "mlp_cost_us": 3281.25, "attn_cost_us": 885.7884689081329, "allreduce_cost_us": 0, "allgather_cost_us": 39.51171875}, {"worker_id": 10, "assigned_docs": [5], "total_batch_length": 17650, "total_latency_us": 12291, "mlp_cost_us": 8079.52880859375, "attn_cost_us": 4114.280831759087, "allreduce_cost_us": 0, "allgather_cost_us": 97.2909927368164}, {"worker_id": 11, "assigned_docs": [4], "total_batch_length": 17552, "total_latency_us": 12203, "mlp_cost_us": 8034.66796875, "attn_cost_us": 4072.3152182899194, "allreduce_cost_us": 0, "allgather_cost_us": 96.75079345703125}, {"worker_id": 12, "assigned_docs": [3], "total_batch_length": 16438, "total_latency_us": 11224, "mlp_cost_us": 7524.71923828125, "attn_cost_us": 3609.1452425831194, "allreduce_cost_us": 0, "allgather_cost_us": 90.61016082763672}, {"worker_id": 13, "assigned_docs": [2], "total_batch_length": 60107, "total_latency_us": 68061, "mlp_cost_us": 27514.801025390625, "attn_cost_us": 40215.175167369685, "allreduce_cost_us": 0, "allgather_cost_us": 331.3240623474121}, {"worker_id": 14, "assigned_docs": [1, 21], "total_batch_length": 38842, "total_latency_us": 31176, "mlp_cost_us": 17780.45654296875, "attn_cost_us": 13182.5242153802, "allreduce_cost_us": 0, "allgather_cost_us": 214.10633087158203}, {"worker_id": 15, "assigned_docs": [0, 35], "total_batch_length": 35922, "total_latency_us": 30481, "mlp_cost_us": 16443.78662109375, "attn_cost_us": 13839.49369503524, "allreduce_cost_us": 0, "allgather_cost_us": 198.0105972290039}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 15, "attn_time_us": 145.32883274523422, "mlp_time_us": 930.633544921875, "allgather_time_us": 11.206378936767578, "allreduce_time_us": 0, "total_latency_us": 1087}, {"doc_id": 1, "doc_len": 32101, "worker_id": 14, "attn_time_us": 12377.305380577742, "mlp_time_us": 14694.671630859375, "allgather_time_us": 176.94833755493164, "allreduce_time_us": 0, "total_latency_us": 27248}, {"doc_id": 2, "doc_len": 60107, "worker_id": 13, "attn_time_us": 40215.175167369685, "mlp_time_us": 27514.801025390625, "allgather_time_us": 331.3240623474121, "allreduce_time_us": 0, "total_latency_us": 68061}, {"doc_id": 3, "doc_len": 16438, "worker_id": 12, "attn_time_us": 3609.1452425831194, "mlp_time_us": 7524.71923828125, "allgather_time_us": 90.61016082763672, "allreduce_time_us": 0, "total_latency_us": 11224}, {"doc_id": 4, "doc_len": 17552, "worker_id": 11, "attn_time_us": 4072.3152182899194, "mlp_time_us": 8034.66796875, "allgather_time_us": 96.75079345703125, "allreduce_time_us": 0, "total_latency_us": 12203}, {"doc_id": 5, "doc_len": 17650, "worker_id": 10, "attn_time_us": 4114.280831759087, "mlp_time_us": 8079.52880859375, "allgather_time_us": 97.2909927368164, "allreduce_time_us": 0, "total_latency_us": 12291}, {"doc_id": 6, "doc_len": 7168, "worker_id": 9, "attn_time_us": 885.7884689081329, "mlp_time_us": 3281.25, "allgather_time_us": 39.51171875, "allreduce_time_us": 0, "total_latency_us": 4206}, {"doc_id": 7, "doc_len": 7125, "worker_id": 8, "attn_time_us": 877.5515330986616, "mlp_time_us": 3261.566162109375, "allgather_time_us": 39.27469253540039, "allreduce_time_us": 0, "total_latency_us": 4178}, {"doc_id": 8, "doc_len": 19562, "worker_id": 7, "attn_time_us": 4972.1468094758975, "mlp_time_us": 8954.77294921875, "allgather_time_us": 107.83039093017578, "allreduce_time_us": 0, "total_latency_us": 14034}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1361.1608908315181, "mlp_time_us": 4267.730712890625, "allgather_time_us": 51.39059066772461, "allreduce_time_us": 0, "total_latency_us": 5680}, {"doc_id": 10, "doc_len": 41353, "worker_id": 5, "attn_time_us": 19909.179054302134, "mlp_time_us": 18929.901123046875, "allgather_time_us": 227.94755935668945, "allreduce_time_us": 0, "total_latency_us": 39067}, {"doc_id": 11, "doc_len": 18999, "worker_id": 4, "attn_time_us": 4711.846325687134, "mlp_time_us": 8697.052001953125, "allgather_time_us": 104.72700119018555, "allreduce_time_us": 0, "total_latency_us": 13513}, {"doc_id": 12, "doc_len": 81288, "worker_id": 3, "attn_time_us": 71907.16242223006, "mlp_time_us": 37210.693359375, "allgather_time_us": 448.0787658691406, "allreduce_time_us": 0, "total_latency_us": 109565}, {"doc_id": 13, "doc_len": 26799, "worker_id": 2, "attn_time_us": 8876.975943800357, "mlp_time_us": 12267.608642578125, "allgather_time_us": 147.72245407104492, "allreduce_time_us": 0, "total_latency_us": 21292}, {"doc_id": 14, "doc_len": 14333, "worker_id": 1, "attn_time_us": 2850.6401553950586, "mlp_time_us": 6561.126708984375, "allgather_time_us": 79.00690078735352, "allreduce_time_us": 0, "total_latency_us": 9490}, {"doc_id": 15, "doc_len": 74771, "worker_id": 0, "attn_time_us": 61128.88758029419, "mlp_time_us": 34227.447509765625, "allgather_time_us": 412.15551376342773, "allreduce_time_us": 0, "total_latency_us": 95768}, {"doc_id": 16, "doc_len": 66335, "worker_id": 1, "attn_time_us": 48441.5193788022, "mlp_time_us": 30365.753173828125, "allgather_time_us": 365.6542778015137, "allreduce_time_us": 0, "total_latency_us": 79172}, {"doc_id": 17, "doc_len": 19831, "worker_id": 1, "attn_time_us": 5098.772067815579, "mlp_time_us": 9077.911376953125, "allgather_time_us": 109.31318283081056, "allreduce_time_us": 0, "total_latency_us": 14285}, {"doc_id": 18, "doc_len": 15296, "worker_id": 0, "attn_time_us": 3187.7304299682737, "mlp_time_us": 7001.953125, "allgather_time_us": 84.315185546875, "allreduce_time_us": 0, "total_latency_us": 10273}, {"doc_id": 19, "doc_len": 31167, "worker_id": 2, "attn_time_us": 11722.31970436031, "mlp_time_us": 14267.120361328125, "allgather_time_us": 171.79990768432617, "allreduce_time_us": 0, "total_latency_us": 26161}, {"doc_id": 20, "doc_len": 7769, "worker_id": 1, "attn_time_us": 1003.7448591438962, "mlp_time_us": 3556.365966796875, "allgather_time_us": 42.8245735168457, "allreduce_time_us": 0, "total_latency_us": 4602}, {"doc_id": 21, "doc_len": 6741, "worker_id": 14, "attn_time_us": 805.2188348024574, "mlp_time_us": 3085.784912109375, "allgather_time_us": 37.15799331665039, "allreduce_time_us": 0, "total_latency_us": 3928}, {"doc_id": 22, "doc_len": 8646, "worker_id": 2, "attn_time_us": 1195.7389940808503, "mlp_time_us": 3957.82470703125, "allgather_time_us": 47.658805847167976, "allreduce_time_us": 0, "total_latency_us": 5201}, {"doc_id": 23, "doc_len": 57831, "worker_id": 4, "attn_time_us": 37400.20171492321, "mlp_time_us": 26472.930908203125, "allgather_time_us": 318.7782096862793, "allreduce_time_us": 0, "total_latency_us": 64191}, {"doc_id": 24, "doc_len": 39755, "worker_id": 2, "attn_time_us": 18487.476519007858, "mlp_time_us": 18198.394775390625, "allgather_time_us": 219.13900375366214, "allreduce_time_us": 0, "total_latency_us": 36905}, {"doc_id": 25, "doc_len": 34611, "worker_id": 4, "attn_time_us": 14247.778943520165, "mlp_time_us": 15843.658447265625, "allgather_time_us": 190.78405380249026, "allreduce_time_us": 0, "total_latency_us": 30282}, {"doc_id": 26, "doc_len": 61200, "worker_id": 5, "attn_time_us": 41600.93505740087, "mlp_time_us": 28015.13671875, "allgather_time_us": 337.34893798828125, "allreduce_time_us": 0, "total_latency_us": 69953}, {"doc_id": 27, "doc_len": 18523, "worker_id": 2, "attn_time_us": 4496.769412723571, "mlp_time_us": 8479.156494140625, "allgather_time_us": 102.10317611694336, "allreduce_time_us": 0, "total_latency_us": 13078}, {"doc_id": 28, "doc_len": 35075, "worker_id": 6, "attn_time_us": 14608.979461510693, "mlp_time_us": 16056.060791015625, "allgather_time_us": 193.34173202514648, "allreduce_time_us": 0, "total_latency_us": 30858}, {"doc_id": 29, "doc_len": 8666, "worker_id": 2, "attn_time_us": 1200.497031944521, "mlp_time_us": 3966.97998046875, "allgather_time_us": 47.76905059814453, "allreduce_time_us": 0, "total_latency_us": 5215}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 783.6230821928286, "mlp_time_us": 3032.2265625, "allgather_time_us": 36.5130615234375, "allreduce_time_us": 0, "total_latency_us": 3852}, {"doc_id": 31, "doc_len": 33237, "worker_id": 6, "attn_time_us": 13203.059890584293, "mlp_time_us": 15214.691162109375, "allgather_time_us": 183.21023941040042, "allreduce_time_us": 0, "total_latency_us": 28600}, {"doc_id": 32, "doc_len": 16523, "worker_id": 6, "attn_time_us": 3643.584350269281, "mlp_time_us": 7563.629150390625, "allgather_time_us": 91.07870101928711, "allreduce_time_us": 0, "total_latency_us": 11298}, {"doc_id": 33, "doc_len": 34119, "worker_id": 7, "attn_time_us": 13869.4091244765, "mlp_time_us": 15618.438720703125, "allgather_time_us": 188.0720329284668, "allreduce_time_us": 0, "total_latency_us": 29675}, {"doc_id": 34, "doc_len": 66136, "worker_id": 8, "attn_time_us": 48159.52886987747, "mlp_time_us": 30274.658203125, "allgather_time_us": 364.5573425292969, "allreduce_time_us": 0, "total_latency_us": 78798}, {"doc_id": 35, "doc_len": 33889, "worker_id": 15, "attn_time_us": 13694.164862290007, "mlp_time_us": 15513.153076171875, "allgather_time_us": 186.80421829223633, "allreduce_time_us": 0, "total_latency_us": 29394}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 145.32883274523422, "mlp_time": 930.633544921875, "allgather_time": 11.206378936767578, "allreduce_time": 0}, "1": {"doc_len": 32101, "attn_time": 12377.305380577742, "mlp_time": 14694.671630859375, "allgather_time": 176.94833755493164, "allreduce_time": 0}, "2": {"doc_len": 60107, "attn_time": 40215.175167369685, "mlp_time": 27514.801025390625, "allgather_time": 331.3240623474121, "allreduce_time": 0}, "3": {"doc_len": 16438, "attn_time": 3609.1452425831194, "mlp_time": 7524.71923828125, "allgather_time": 90.61016082763672, "allreduce_time": 0}, "4": {"doc_len": 17552, "attn_time": 4072.3152182899194, "mlp_time": 8034.66796875, "allgather_time": 96.75079345703125, "allreduce_time": 0}, "5": {"doc_len": 17650, "attn_time": 4114.280831759087, "mlp_time": 8079.52880859375, "allgather_time": 97.2909927368164, "allreduce_time": 0}, "6": {"doc_len": 7168, "attn_time": 885.7884689081329, "mlp_time": 3281.25, "allgather_time": 39.51171875, "allreduce_time": 0}, "7": {"doc_len": 7125, "attn_time": 877.5515330986616, "mlp_time": 3261.566162109375, "allgather_time": 39.27469253540039, "allreduce_time": 0}, "8": {"doc_len": 19562, "attn_time": 4972.1468094758975, "mlp_time": 8954.77294921875, "allgather_time": 107.83039093017578, "allreduce_time": 0}, "9": {"doc_len": 9323, "attn_time": 1361.1608908315181, "mlp_time": 4267.730712890625, "allgather_time": 51.39059066772461, "allreduce_time": 0}, "10": {"doc_len": 41353, "attn_time": 19909.179054302134, "mlp_time": 18929.901123046875, "allgather_time": 227.94755935668945, "allreduce_time": 0}, "11": {"doc_len": 18999, "attn_time": 4711.846325687134, "mlp_time": 8697.052001953125, "allgather_time": 104.72700119018555, "allreduce_time": 0}, "12": {"doc_len": 81288, "attn_time": 71907.16242223006, "mlp_time": 37210.693359375, "allgather_time": 448.0787658691406, "allreduce_time": 0}, "13": {"doc_len": 26799, "attn_time": 8876.975943800357, "mlp_time": 12267.608642578125, "allgather_time": 147.72245407104492, "allreduce_time": 0}, "14": {"doc_len": 14333, "attn_time": 2850.6401553950586, "mlp_time": 6561.126708984375, "allgather_time": 79.00690078735352, "allreduce_time": 0}, "15": {"doc_len": 74771, "attn_time": 61128.88758029419, "mlp_time": 34227.447509765625, "allgather_time": 412.15551376342773, "allreduce_time": 0}, "16": {"doc_len": 66335, "attn_time": 48441.5193788022, "mlp_time": 30365.753173828125, "allgather_time": 365.6542778015137, "allreduce_time": 0}, "17": {"doc_len": 19831, "attn_time": 5098.772067815579, "mlp_time": 9077.911376953125, "allgather_time": 109.31318283081056, "allreduce_time": 0}, "18": {"doc_len": 15296, "attn_time": 3187.7304299682737, "mlp_time": 7001.953125, "allgather_time": 84.315185546875, "allreduce_time": 0}, "19": {"doc_len": 31167, "attn_time": 11722.31970436031, "mlp_time": 14267.120361328125, "allgather_time": 171.79990768432617, "allreduce_time": 0}, "20": {"doc_len": 7769, "attn_time": 1003.7448591438962, "mlp_time": 3556.365966796875, "allgather_time": 42.8245735168457, "allreduce_time": 0}, "21": {"doc_len": 6741, "attn_time": 805.2188348024574, "mlp_time": 3085.784912109375, "allgather_time": 37.15799331665039, "allreduce_time": 0}, "22": {"doc_len": 8646, "attn_time": 1195.7389940808503, "mlp_time": 3957.82470703125, "allgather_time": 47.658805847167976, "allreduce_time": 0}, "23": {"doc_len": 57831, "attn_time": 37400.20171492321, "mlp_time": 26472.930908203125, "allgather_time": 318.7782096862793, "allreduce_time": 0}, "24": {"doc_len": 39755, "attn_time": 18487.476519007858, "mlp_time": 18198.394775390625, "allgather_time": 219.13900375366214, "allreduce_time": 0}, "25": {"doc_len": 34611, "attn_time": 14247.778943520165, "mlp_time": 15843.658447265625, "allgather_time": 190.78405380249026, "allreduce_time": 0}, "26": {"doc_len": 61200, "attn_time": 41600.93505740087, "mlp_time": 28015.13671875, "allgather_time": 337.34893798828125, "allreduce_time": 0}, "27": {"doc_len": 18523, "attn_time": 4496.769412723571, "mlp_time": 8479.156494140625, "allgather_time": 102.10317611694336, "allreduce_time": 0}, "28": {"doc_len": 35075, "attn_time": 14608.979461510693, "mlp_time": 16056.060791015625, "allgather_time": 193.34173202514648, "allreduce_time": 0}, "29": {"doc_len": 8666, "attn_time": 1200.497031944521, "mlp_time": 3966.97998046875, "allgather_time": 47.76905059814453, "allreduce_time": 0}, "30": {"doc_len": 6624, "attn_time": 783.6230821928286, "mlp_time": 3032.2265625, "allgather_time": 36.5130615234375, "allreduce_time": 0}, "31": {"doc_len": 33237, "attn_time": 13203.059890584293, "mlp_time": 15214.691162109375, "allgather_time": 183.21023941040042, "allreduce_time": 0}, "32": {"doc_len": 16523, "attn_time": 3643.584350269281, "mlp_time": 7563.629150390625, "allgather_time": 91.07870101928711, "allreduce_time": 0}, "33": {"doc_len": 34119, "attn_time": 13869.4091244765, "mlp_time": 15618.438720703125, "allgather_time": 188.0720329284668, "allreduce_time": 0}, "34": {"doc_len": 66136, "attn_time": 48159.52886987747, "mlp_time": 30274.658203125, "allgather_time": 364.5573425292969, "allreduce_time": 0}, "35": {"doc_len": 33889, "attn_time": 13694.164862290007, "mlp_time": 15513.153076171875, "allgather_time": 186.80421829223633, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 63662.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 1, "mlp_cp": 4}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 1, "cp": 8, "dp": 8, "ratio": 0.9567909584141154, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 66537, "worker_latencies_us": [66531, 66530, 66470, 66536, 66508, 66537, 66529, 66519], "doc2worker": {"0": 7, "1": 7, "2": 6, "3": 7, "4": 6, "5": 4, "6": 3, "7": 3, "8": 3, "9": 1, "10": 3, "11": 0, "12": 5, "13": 6, "14": 7, "15": 0, "16": 7, "17": 4, "18": 0, "19": 6, "20": 5, "21": 5, "22": 0, "23": 4, "24": 4, "25": 3, "26": 2, "27": 1, "28": 1, "29": 3, "30": 0, "31": 2, "32": 5, "33": 2, "34": 1, "35": 3}, "latency_breakdown": {"max_worker_latency_us": 66537, "worker_latencies_us": [66531, 66530, 66470, 66536, 66508, 66537, 66529, 66519], "solver_status": "FEASIBLE", "solved_time_s": 360.1601085662842, "num_vars": 297, "num_cons": 60}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [11, 15, 18, 22, 30], "total_batch_length": 124336, "total_latency_us": 66531, "mlp_cost_us": 28458.251953125, "attn_cost_us": 37307.26130226581, "allreduce_cost_us": 0, "allgather_cost_us": 766.8906021118164}, {"worker_id": 1, "assigned_docs": [9, 27, 28, 34], "total_batch_length": 129057, "total_latency_us": 66530, "mlp_cost_us": 29538.803100585938, "attn_cost_us": 36197.11263079013, "allreduce_cost_us": 0, "allgather_cost_us": 796.0092043876648}, {"worker_id": 2, "assigned_docs": [26, 31, 33], "total_batch_length": 128556, "total_latency_us": 66470, "mlp_cost_us": 29424.13330078125, "attn_cost_us": 36254.430204223616, "allreduce_cost_us": 0, "allgather_cost_us": 792.9190921783447}, {"worker_id": 3, "assigned_docs": [6, 7, 8, 10, 25, 29, 35], "total_batch_length": 152374, "total_latency_us": 66536, "mlp_cost_us": 34875.640869140625, "attn_cost_us": 30723.7568163297, "allreduce_cost_us": 0, "allgather_cost_us": 939.8258638381958}, {"worker_id": 4, "assigned_docs": [5, 17, 23, 24], "total_batch_length": 135067, "total_latency_us": 66508, "mlp_cost_us": 30914.382934570312, "attn_cost_us": 34763.17246039329, "allreduce_cost_us": 0, "allgather_cost_us": 833.0782151222229}, {"worker_id": 5, "assigned_docs": [12, 20, 21, 32], "total_batch_length": 112321, "total_latency_us": 66537, "mlp_cost_us": 25708.236694335938, "attn_cost_us": 40137.381456940726, "allreduce_cost_us": 0, "allgather_cost_us": 692.783420085907}, {"worker_id": 6, "assigned_docs": [2, 4, 13, 19], "total_batch_length": 135625, "total_latency_us": 66529, "mlp_cost_us": 31042.098999023438, "attn_cost_us": 34652.90311769428, "allreduce_cost_us": 0, "allgather_cost_us": 836.5198969841003}, {"worker_id": 7, "assigned_docs": [0, 1, 3, 14, 16], "total_batch_length": 131240, "total_latency_us": 66519, "mlp_cost_us": 30038.4521484375, "attn_cost_us": 35674.471954152774, "allreduce_cost_us": 0, "allgather_cost_us": 809.473705291748}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 120.99515113494935, "mlp_time_us": 465.3167724609375, "allgather_time_us": 12.539317607879639, "allreduce_time_us": 0, "total_latency_us": 598}, {"doc_id": 1, "doc_len": 32101, "worker_id": 7, "attn_time_us": 6776.606378456838, "mlp_time_us": 7347.3358154296875, "allgather_time_us": 197.9953932762146, "allreduce_time_us": 0, "total_latency_us": 14321}, {"doc_id": 2, "doc_len": 60107, "worker_id": 6, "attn_time_us": 20823.750404330007, "mlp_time_us": 13757.400512695312, "allgather_time_us": 370.73328256607056, "allreduce_time_us": 0, "total_latency_us": 34951}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 2155.2243573740857, "mlp_time_us": 3762.359619140625, "allgather_time_us": 101.3877534866333, "allreduce_time_us": 0, "total_latency_us": 6018}, {"doc_id": 4, "doc_len": 17552, "worker_id": 6, "attn_time_us": 2411.2140000174886, "mlp_time_us": 4017.333984375, "allgather_time_us": 108.25878143310547, "allreduce_time_us": 0, "total_latency_us": 6536}, {"doc_id": 5, "doc_len": 17650, "worker_id": 4, "attn_time_us": 2434.3031242043717, "mlp_time_us": 4039.764404296875, "allgather_time_us": 108.8632345199585, "allreduce_time_us": 0, "total_latency_us": 6582}, {"doc_id": 6, "doc_len": 7168, "worker_id": 3, "attn_time_us": 595.7372214311654, "mlp_time_us": 1640.625, "allgather_time_us": 44.21142578125, "allreduce_time_us": 0, "total_latency_us": 2280}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 590.7767934909443, "mlp_time_us": 1630.7830810546875, "allgather_time_us": 43.94620656967163, "allreduce_time_us": 0, "total_latency_us": 2265}, {"doc_id": 8, "doc_len": 19562, "worker_id": 3, "attn_time_us": 2902.891676801327, "mlp_time_us": 4477.386474609375, "allgather_time_us": 120.65623760223389, "allreduce_time_us": 0, "total_latency_us": 7500}, {"doc_id": 9, "doc_len": 9323, "worker_id": 1, "attn_time_us": 879.7167120428657, "mlp_time_us": 2133.8653564453125, "allgather_time_us": 57.503225803375244, "allreduce_time_us": 0, "total_latency_us": 3071}, {"doc_id": 10, "doc_len": 41353, "worker_id": 3, "attn_time_us": 10652.137661006782, "mlp_time_us": 9464.950561523438, "allgather_time_us": 255.0606989860535, "allreduce_time_us": 0, "total_latency_us": 20372}, {"doc_id": 11, "doc_len": 18999, "worker_id": 0, "attn_time_us": 2761.359934376034, "mlp_time_us": 4348.5260009765625, "allgather_time_us": 117.18371629714966, "allreduce_time_us": 0, "total_latency_us": 7227}, {"doc_id": 12, "doc_len": 81288, "worker_id": 5, "attn_time_us": 36749.78170476509, "mlp_time_us": 18605.3466796875, "allgather_time_us": 501.3753318786621, "allreduce_time_us": 0, "total_latency_us": 55856}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 4975.311162826327, "mlp_time_us": 6133.8043212890625, "allgather_time_us": 165.29324769973755, "allreduce_time_us": 0, "total_latency_us": 11274}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 1735.0770049814312, "mlp_time_us": 3280.5633544921875, "allgather_time_us": 88.40434789657593, "allreduce_time_us": 0, "total_latency_us": 5104}, {"doc_id": 15, "doc_len": 74771, "worker_id": 0, "attn_time_us": 31308.34433813291, "mlp_time_us": 17113.723754882812, "allgather_time_us": 461.1792016029358, "allreduce_time_us": 0, "total_latency_us": 48883}, {"doc_id": 16, "doc_len": 66335, "worker_id": 7, "attn_time_us": 24886.569062205468, "mlp_time_us": 15182.876586914062, "allgather_time_us": 409.1468930244446, "allreduce_time_us": 0, "total_latency_us": 40478}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2971.5506968668337, "mlp_time_us": 4538.9556884765625, "allgather_time_us": 122.31539964675905, "allreduce_time_us": 0, "total_latency_us": 7632}, {"doc_id": 18, "doc_len": 15296, "worker_id": 0, "attn_time_us": 1922.7295551709851, "mlp_time_us": 3500.9765625, "allgather_time_us": 94.34402465820312, "allreduce_time_us": 0, "total_latency_us": 5518}, {"doc_id": 19, "doc_len": 31167, "worker_id": 6, "attn_time_us": 6442.627550520461, "mlp_time_us": 7133.5601806640625, "allgather_time_us": 192.23458528518677, "allreduce_time_us": 0, "total_latency_us": 13768}, {"doc_id": 20, "doc_len": 7769, "worker_id": 5, "attn_time_us": 666.2641792899022, "mlp_time_us": 1778.1829833984375, "allgather_time_us": 47.91832685470581, "allreduce_time_us": 0, "total_latency_us": 2492}, {"doc_id": 21, "doc_len": 6741, "worker_id": 5, "attn_time_us": 547.0007562856913, "mlp_time_us": 1542.8924560546875, "allgather_time_us": 41.57773733139038, "allreduce_time_us": 0, "total_latency_us": 2131}, {"doc_id": 22, "doc_len": 8646, "worker_id": 0, "attn_time_us": 780.9752011381959, "mlp_time_us": 1978.912353515625, "allgather_time_us": 53.32756519317628, "allreduce_time_us": 0, "total_latency_us": 2813}, {"doc_id": 23, "doc_len": 57831, "worker_id": 4, "attn_time_us": 19431.66903349636, "mlp_time_us": 13236.465454101562, "allgather_time_us": 356.69516801834106, "allreduce_time_us": 0, "total_latency_us": 33024}, {"doc_id": 24, "doc_len": 39755, "worker_id": 4, "attn_time_us": 9925.649605825723, "mlp_time_us": 9099.197387695312, "allgather_time_us": 245.20441293716434, "allreduce_time_us": 0, "total_latency_us": 19270}, {"doc_id": 25, "doc_len": 34611, "worker_id": 3, "attn_time_us": 7742.747051358323, "mlp_time_us": 7921.8292236328125, "allgather_time_us": 213.47679376602176, "allreduce_time_us": 0, "total_latency_us": 15878}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 21507.361371482224, "mlp_time_us": 14007.568359375, "allgather_time_us": 377.4747848510742, "allreduce_time_us": 0, "total_latency_us": 35892}, {"doc_id": 27, "doc_len": 18523, "worker_id": 1, "attn_time_us": 2644.0022391277535, "mlp_time_us": 4239.5782470703125, "allgather_time_us": 114.24780130386353, "allreduce_time_us": 0, "total_latency_us": 6997}, {"doc_id": 28, "doc_len": 35075, "worker_id": 1, "attn_time_us": 7929.7888054663135, "mlp_time_us": 8028.0303955078125, "allgather_time_us": 216.33869409561157, "allreduce_time_us": 0, "total_latency_us": 16174}, {"doc_id": 29, "doc_len": 8666, "worker_id": 3, "attn_time_us": 783.8301324806403, "mlp_time_us": 1983.489990234375, "allgather_time_us": 53.45092296600342, "allreduce_time_us": 0, "total_latency_us": 2820}, {"doc_id": 30, "doc_len": 6624, "worker_id": 0, "attn_time_us": 533.8522734476951, "mlp_time_us": 1516.11328125, "allgather_time_us": 40.85609436035156, "allreduce_time_us": 0, "total_latency_us": 2090}, {"doc_id": 31, "doc_len": 33237, "worker_id": 2, "attn_time_us": 7200.491376147886, "mlp_time_us": 7607.3455810546875, "allgather_time_us": 205.00211477279666, "allreduce_time_us": 0, "total_latency_us": 15012}, {"doc_id": 32, "doc_len": 16523, "worker_id": 5, "attn_time_us": 2174.3348166000405, "mlp_time_us": 3781.8145751953125, "allgather_time_us": 101.91202402114868, "allreduce_time_us": 0, "total_latency_us": 6058}, {"doc_id": 33, "doc_len": 34119, "worker_id": 2, "attn_time_us": 7546.577456593507, "mlp_time_us": 7809.2193603515625, "allgather_time_us": 210.44219255447388, "allreduce_time_us": 0, "total_latency_us": 15566}, {"doc_id": 34, "doc_len": 66136, "worker_id": 1, "attn_time_us": 24743.604874153196, "mlp_time_us": 15137.3291015625, "allgather_time_us": 407.91948318481445, "allreduce_time_us": 0, "total_latency_us": 40288}, {"doc_id": 35, "doc_len": 33889, "worker_id": 3, "attn_time_us": 7455.636279760517, "mlp_time_us": 7756.5765380859375, "allgather_time_us": 209.02357816696167, "allreduce_time_us": 0, "total_latency_us": 15421}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 120.99515113494935, "mlp_time": 465.3167724609375, "allgather_time": 12.539317607879639, "allreduce_time": 0}, "1": {"doc_len": 32101, "attn_time": 6776.606378456838, "mlp_time": 7347.3358154296875, "allgather_time": 197.9953932762146, "allreduce_time": 0}, "2": {"doc_len": 60107, "attn_time": 20823.750404330007, "mlp_time": 13757.400512695312, "allgather_time": 370.73328256607056, "allreduce_time": 0}, "3": {"doc_len": 16438, "attn_time": 2155.2243573740857, "mlp_time": 3762.359619140625, "allgather_time": 101.3877534866333, "allreduce_time": 0}, "4": {"doc_len": 17552, "attn_time": 2411.2140000174886, "mlp_time": 4017.333984375, "allgather_time": 108.25878143310547, "allreduce_time": 0}, "5": {"doc_len": 17650, "attn_time": 2434.3031242043717, "mlp_time": 4039.764404296875, "allgather_time": 108.8632345199585, "allreduce_time": 0}, "6": {"doc_len": 7168, "attn_time": 595.7372214311654, "mlp_time": 1640.625, "allgather_time": 44.21142578125, "allreduce_time": 0}, "7": {"doc_len": 7125, "attn_time": 590.7767934909443, "mlp_time": 1630.7830810546875, "allgather_time": 43.94620656967163, "allreduce_time": 0}, "8": {"doc_len": 19562, "attn_time": 2902.891676801327, "mlp_time": 4477.386474609375, "allgather_time": 120.65623760223389, "allreduce_time": 0}, "9": {"doc_len": 9323, "attn_time": 879.7167120428657, "mlp_time": 2133.8653564453125, "allgather_time": 57.503225803375244, "allreduce_time": 0}, "10": {"doc_len": 41353, "attn_time": 10652.137661006782, "mlp_time": 9464.950561523438, "allgather_time": 255.0606989860535, "allreduce_time": 0}, "11": {"doc_len": 18999, "attn_time": 2761.359934376034, "mlp_time": 4348.5260009765625, "allgather_time": 117.18371629714966, "allreduce_time": 0}, "12": {"doc_len": 81288, "attn_time": 36749.78170476509, "mlp_time": 18605.3466796875, "allgather_time": 501.3753318786621, "allreduce_time": 0}, "13": {"doc_len": 26799, "attn_time": 4975.311162826327, "mlp_time": 6133.8043212890625, "allgather_time": 165.29324769973755, "allreduce_time": 0}, "14": {"doc_len": 14333, "attn_time": 1735.0770049814312, "mlp_time": 3280.5633544921875, "allgather_time": 88.40434789657593, "allreduce_time": 0}, "15": {"doc_len": 74771, "attn_time": 31308.34433813291, "mlp_time": 17113.723754882812, "allgather_time": 461.1792016029358, "allreduce_time": 0}, "16": {"doc_len": 66335, "attn_time": 24886.569062205468, "mlp_time": 15182.876586914062, "allgather_time": 409.1468930244446, "allreduce_time": 0}, "17": {"doc_len": 19831, "attn_time": 2971.5506968668337, "mlp_time": 4538.9556884765625, "allgather_time": 122.31539964675905, "allreduce_time": 0}, "18": {"doc_len": 15296, "attn_time": 1922.7295551709851, "mlp_time": 3500.9765625, "allgather_time": 94.34402465820312, "allreduce_time": 0}, "19": {"doc_len": 31167, "attn_time": 6442.627550520461, "mlp_time": 7133.5601806640625, "allgather_time": 192.23458528518677, "allreduce_time": 0}, "20": {"doc_len": 7769, "attn_time": 666.2641792899022, "mlp_time": 1778.1829833984375, "allgather_time": 47.91832685470581, "allreduce_time": 0}, "21": {"doc_len": 6741, "attn_time": 547.0007562856913, "mlp_time": 1542.8924560546875, "allgather_time": 41.57773733139038, "allreduce_time": 0}, "22": {"doc_len": 8646, "attn_time": 780.9752011381959, "mlp_time": 1978.912353515625, "allgather_time": 53.32756519317628, "allreduce_time": 0}, "23": {"doc_len": 57831, "attn_time": 19431.66903349636, "mlp_time": 13236.465454101562, "allgather_time": 356.69516801834106, "allreduce_time": 0}, "24": {"doc_len": 39755, "attn_time": 9925.649605825723, "mlp_time": 9099.197387695312, "allgather_time": 245.20441293716434, "allreduce_time": 0}, "25": {"doc_len": 34611, "attn_time": 7742.747051358323, "mlp_time": 7921.8292236328125, "allgather_time": 213.47679376602176, "allreduce_time": 0}, "26": {"doc_len": 61200, "attn_time": 21507.361371482224, "mlp_time": 14007.568359375, "allgather_time": 377.4747848510742, "allreduce_time": 0}, "27": {"doc_len": 18523, "attn_time": 2644.0022391277535, "mlp_time": 4239.5782470703125, "allgather_time": 114.24780130386353, "allreduce_time": 0}, "28": {"doc_len": 35075, "attn_time": 7929.7888054663135, "mlp_time": 8028.0303955078125, "allgather_time": 216.33869409561157, "allreduce_time": 0}, "29": {"doc_len": 8666, "attn_time": 783.8301324806403, "mlp_time": 1983.489990234375, "allgather_time": 53.45092296600342, "allreduce_time": 0}, "30": {"doc_len": 6624, "attn_time": 533.8522734476951, "mlp_time": 1516.11328125, "allgather_time": 40.85609436035156, "allreduce_time": 0}, "31": {"doc_len": 33237, "attn_time": 7200.491376147886, "mlp_time": 7607.3455810546875, "allgather_time": 205.00211477279666, "allreduce_time": 0}, "32": {"doc_len": 16523, "attn_time": 2174.3348166000405, "mlp_time": 3781.8145751953125, "allgather_time": 101.91202402114868, "allreduce_time": 0}, "33": {"doc_len": 34119, "attn_time": 7546.577456593507, "mlp_time": 7809.2193603515625, "allgather_time": 210.44219255447388, "allreduce_time": 0}, "34": {"doc_len": 66136, "attn_time": 24743.604874153196, "mlp_time": 15137.3291015625, "allgather_time": 407.91948318481445, "allreduce_time": 0}, "35": {"doc_len": 33889, "attn_time": 7455.636279760517, "mlp_time": 7756.5765380859375, "allgather_time": 209.02357816696167, "allreduce_time": 0}}}, "attnserver_result": {"batch_total_time": 63662.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 1, "mlp_cp": 8}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 1, "dp": 32, "ratio": 0.28708724712988254, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 225165, "worker_latencies_us": [216486, 142473, 9882, 60241, 25024, 140550, 59088, 72410, 128501, 9856, 7425, 8716, 50829, 19591, 27366, 159967, 195387, 18068, 41117, 225165, 25868, 76787, 10763, 26878, 7902, 7956, 23503, 23335, 21448, 136586, 0, 55080], "doc2worker": {"0": 31, "1": 31, "2": 29, "3": 28, "4": 27, "5": 26, "6": 25, "7": 24, "8": 23, "9": 22, "10": 21, "11": 20, "12": 19, "13": 18, "14": 17, "15": 16, "16": 15, "17": 14, "18": 13, "19": 12, "20": 11, "21": 10, "22": 9, "23": 8, "24": 7, "25": 6, "26": 5, "27": 4, "28": 3, "29": 2, "30": 1, "31": 1, "32": 1, "33": 1, "34": 0, "35": 0}, "latency_breakdown": {"max_worker_latency_us": 225165, "worker_latencies_us": [216486, 142473, 9882, 60241, 25024, 140550, 59088, 72410, 128501, 9856, 7425, 8716, 50829, 19591, 27366, 159967, 195387, 18068, 41117, 225165, 25868, 76787, 10763, 26878, 7902, 7956, 23503, 23335, 21448, 136586, 0, 55080], "solver_status": "OPTIMAL", "solved_time_s": 0.03386068344116211, "num_vars": 1185, "num_cons": 132}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [34, 35], "total_batch_length": 100025, "total_latency_us": 216486, "mlp_cost_us": 91575.62255859375, "attn_cost_us": 123488.25326315888, "allreduce_cost_us": 1422.5225946402106, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [30, 31, 32, 33], "total_batch_length": 90503, "total_latency_us": 142473, "mlp_cost_us": 82857.97119140625, "attn_cost_us": 58185.94691773342, "allreduce_cost_us": 1430.6600357967093, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [29], "total_batch_length": 8666, "total_latency_us": 9882, "mlp_cost_us": 7933.9599609375, "attn_cost_us": 1771.9864246461489, "allreduce_cost_us": 177.02515308297293, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [28], "total_batch_length": 35075, "total_latency_us": 60241, "mlp_cost_us": 32112.12158203125, "attn_cost_us": 27609.114078920364, "allreduce_cost_us": 520.696575719956, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [27], "total_batch_length": 18523, "total_latency_us": 25024, "mlp_cost_us": 16958.31298828125, "attn_cost_us": 7757.344090194271, "allreduce_cost_us": 309.1598552503861, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [26], "total_batch_length": 61200, "total_latency_us": 140550, "mlp_cost_us": 56030.2734375, "attn_cost_us": 83664.28635769592, "allreduce_cost_us": 856.0345894352561, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [25], "total_batch_length": 34611, "total_latency_us": 59088, "mlp_cost_us": 31687.31689453125, "attn_cost_us": 26886.466380440826, "allreduce_cost_us": 514.5404675442439, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [24], "total_batch_length": 39755, "total_latency_us": 72410, "mlp_cost_us": 36396.78955078125, "attn_cost_us": 35431.2248892226, "allreduce_cost_us": 582.3220640749761, "allgather_cost_us": 0}, {"worker_id": 8, "assigned_docs": [23], "total_batch_length": 57831, "total_latency_us": 128501, "mlp_cost_us": 52945.86181640625, "attn_cost_us": 74741.89858423901, "allreduce_cost_us": 813.8225420191098, "allgather_cost_us": 0}, {"worker_id": 9, "assigned_docs": [22], "total_batch_length": 8646, "total_latency_us": 9856, "mlp_cost_us": 7915.6494140625, "attn_cost_us": 1764.0804435729494, "allreduce_cost_us": 176.73094528683725, "allgather_cost_us": 0}, {"worker_id": 10, "assigned_docs": [21], "total_batch_length": 6741, "total_latency_us": 7425, "mlp_cost_us": 6171.56982421875, "attn_cost_us": 1107.0389397180363, "allreduce_cost_us": 146.4314794158378, "allgather_cost_us": 0}, {"worker_id": 11, "assigned_docs": [20], "total_batch_length": 7769, "total_latency_us": 8716, "mlp_cost_us": 7112.73193359375, "attn_cost_us": 1440.3940396992687, "allreduce_cost_us": 163.23850924043458, "allgather_cost_us": 0}, {"worker_id": 12, "assigned_docs": [19], "total_batch_length": 31167, "total_latency_us": 50829, "mlp_cost_us": 28534.24072265625, "attn_cost_us": 21825.09958364952, "allreduce_cost_us": 470.57854979376003, "allgather_cost_us": 0}, {"worker_id": 13, "assigned_docs": [18], "total_batch_length": 15296, "total_latency_us": 19591, "mlp_cost_us": 14003.90625, "attn_cost_us": 5321.311843516945, "allreduce_cost_us": 266.4863482146812, "allgather_cost_us": 0}, {"worker_id": 14, "assigned_docs": [17], "total_batch_length": 19831, "total_latency_us": 27366, "mlp_cost_us": 18155.82275390625, "attn_cost_us": 8884.283536116996, "allreduce_cost_us": 326.66881420420884, "allgather_cost_us": 0}, {"worker_id": 15, "assigned_docs": [16], "total_batch_length": 66335, "total_latency_us": 159967, "mlp_cost_us": 60731.50634765625, "attn_cost_us": 98315.71259001312, "allreduce_cost_us": 920.0911374716885, "allgather_cost_us": 0}, {"worker_id": 16, "assigned_docs": [15], "total_batch_length": 74771, "total_latency_us": 195387, "mlp_cost_us": 68454.89501953125, "attn_cost_us": 125906.28161752503, "allreduce_cost_us": 1025.9948267015664, "allgather_cost_us": 0}, {"worker_id": 17, "assigned_docs": [14], "total_batch_length": 14333, "total_latency_us": 18068, "mlp_cost_us": 13122.25341796875, "attn_cost_us": 4692.061961222295, "allreduce_cost_us": 254.29900208492646, "allgather_cost_us": 0}, {"worker_id": 18, "assigned_docs": [13], "total_batch_length": 26799, "total_latency_us": 41117, "mlp_cost_us": 24535.21728515625, "attn_cost_us": 16165.677660106778, "allreduce_cost_us": 416.57066903753, "allgather_cost_us": 0}, {"worker_id": 19, "assigned_docs": [12], "total_batch_length": 81288, "total_latency_us": 225165, "mlp_cost_us": 74421.38671875, "attn_cost_us": 149636.5745234409, "allreduce_cost_us": 1107.0675685466078, "allgather_cost_us": 0}, {"worker_id": 20, "assigned_docs": [11], "total_batch_length": 18999, "total_latency_us": 25868, "mlp_cost_us": 17394.10400390625, "attn_cost_us": 8158.664073916434, "allreduce_cost_us": 315.55834891481015, "allgather_cost_us": 0}, {"worker_id": 21, "assigned_docs": [10], "total_batch_length": 41353, "total_latency_us": 76787, "mlp_cost_us": 37859.80224609375, "attn_cost_us": 38324.25280146708, "allreduce_cost_us": 603.1823535044257, "allgather_cost_us": 0}, {"worker_id": 22, "assigned_docs": [9], "total_batch_length": 9323, "total_latency_us": 10763, "mlp_cost_us": 8535.46142578125, "attn_cost_us": 2041.181774895663, "allreduce_cost_us": 186.58734851770646, "allgather_cost_us": 0}, {"worker_id": 23, "assigned_docs": [8], "total_batch_length": 19562, "total_latency_us": 26878, "mlp_cost_us": 17909.5458984375, "attn_cost_us": 8646.317741704843, "allreduce_cost_us": 323.0866129032291, "allgather_cost_us": 0}, {"worker_id": 24, "assigned_docs": [7], "total_batch_length": 7125, "total_latency_us": 7902, "mlp_cost_us": 6523.13232421875, "attn_cost_us": 1226.8327021419832, "allreduce_cost_us": 152.77547078634439, "allgather_cost_us": 0}, {"worker_id": 25, "assigned_docs": [6], "total_batch_length": 7168, "total_latency_us": 7956, "mlp_cost_us": 6562.5, "attn_cost_us": 1240.5995681792554, "allreduce_cost_us": 153.4808059082835, "allgather_cost_us": 0}, {"worker_id": 26, "assigned_docs": [5], "total_batch_length": 17650, "total_latency_us": 23503, "mlp_cost_us": 16159.0576171875, "attn_cost_us": 7047.459170573273, "allreduce_cost_us": 297.3415450962168, "allgather_cost_us": 0}, {"worker_id": 27, "assigned_docs": [4], "total_batch_length": 17552, "total_latency_us": 23335, "mlp_cost_us": 16069.3359375, "attn_cost_us": 6969.883499536529, "allreduce_cost_us": 296.00791871083493, "allgather_cost_us": 0}, {"worker_id": 28, "assigned_docs": [3], "total_batch_length": 16438, "total_latency_us": 21448, "mlp_cost_us": 15049.4384765625, "attn_cost_us": 6118.057307935284, "allreduce_cost_us": 280.74483252422374, "allgather_cost_us": 0}, {"worker_id": 29, "assigned_docs": [2], "total_batch_length": 60107, "total_latency_us": 136586, "mlp_cost_us": 55029.60205078125, "attn_cost_us": 80714.72298957057, "allreduce_cost_us": 842.3676918899671, "allgather_cost_us": 0}, {"worker_id": 30, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 31, "assigned_docs": [0, 1], "total_batch_length": 34134, "total_latency_us": 55080, "mlp_cost_us": 31250.6103515625, "attn_cost_us": 23279.158110254808, "allreduce_cost_us": 551.8171301720664, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 31, "attn_time_us": 134.6065337393175, "mlp_time_us": 1861.26708984375, "allgather_time_us": 0, "allreduce_time_us": 69.8856543400674, "total_latency_us": 2065}, {"doc_id": 1, "doc_len": 32101, "worker_id": 31, "attn_time_us": 23144.55157651549, "mlp_time_us": 29389.34326171875, "allgather_time_us": 0, "allreduce_time_us": 481.93147583199897, "total_latency_us": 53015}, {"doc_id": 2, "doc_len": 60107, "worker_id": 29, "attn_time_us": 80714.72298957057, "mlp_time_us": 55029.60205078125, "allgather_time_us": 0, "allreduce_time_us": 842.3676918899671, "total_latency_us": 136586}, {"doc_id": 3, "doc_len": 16438, "worker_id": 28, "attn_time_us": 6118.057307935284, "mlp_time_us": 15049.4384765625, "allgather_time_us": 0, "allreduce_time_us": 280.74483252422374, "total_latency_us": 21448}, {"doc_id": 4, "doc_len": 17552, "worker_id": 27, "attn_time_us": 6969.883499536529, "mlp_time_us": 16069.3359375, "allgather_time_us": 0, "allreduce_time_us": 296.00791871083493, "total_latency_us": 23335}, {"doc_id": 5, "doc_len": 17650, "worker_id": 26, "attn_time_us": 7047.459170573273, "mlp_time_us": 16159.0576171875, "allgather_time_us": 0, "allreduce_time_us": 297.3415450962168, "total_latency_us": 23503}, {"doc_id": 6, "doc_len": 7168, "worker_id": 25, "attn_time_us": 1240.5995681792554, "mlp_time_us": 6562.5, "allgather_time_us": 0, "allreduce_time_us": 153.4808059082835, "total_latency_us": 7956}, {"doc_id": 7, "doc_len": 7125, "worker_id": 24, "attn_time_us": 1226.8327021419832, "mlp_time_us": 6523.13232421875, "allgather_time_us": 0, "allreduce_time_us": 152.77547078634439, "total_latency_us": 7902}, {"doc_id": 8, "doc_len": 19562, "worker_id": 23, "attn_time_us": 8646.317741704843, "mlp_time_us": 17909.5458984375, "allgather_time_us": 0, "allreduce_time_us": 323.0866129032291, "total_latency_us": 26878}, {"doc_id": 9, "doc_len": 9323, "worker_id": 22, "attn_time_us": 2041.181774895663, "mlp_time_us": 8535.46142578125, "allgather_time_us": 0, "allreduce_time_us": 186.58734851770646, "total_latency_us": 10763}, {"doc_id": 10, "doc_len": 41353, "worker_id": 21, "attn_time_us": 38324.25280146708, "mlp_time_us": 37859.80224609375, "allgather_time_us": 0, "allreduce_time_us": 603.1823535044257, "total_latency_us": 76787}, {"doc_id": 11, "doc_len": 18999, "worker_id": 20, "attn_time_us": 8158.664073916434, "mlp_time_us": 17394.10400390625, "allgather_time_us": 0, "allreduce_time_us": 315.55834891481015, "total_latency_us": 25868}, {"doc_id": 12, "doc_len": 81288, "worker_id": 19, "attn_time_us": 149636.5745234409, "mlp_time_us": 74421.38671875, "allgather_time_us": 0, "allreduce_time_us": 1107.0675685466078, "total_latency_us": 225165}, {"doc_id": 13, "doc_len": 26799, "worker_id": 18, "attn_time_us": 16165.677660106778, "mlp_time_us": 24535.21728515625, "allgather_time_us": 0, "allreduce_time_us": 416.57066903753, "total_latency_us": 41117}, {"doc_id": 14, "doc_len": 14333, "worker_id": 17, "attn_time_us": 4692.061961222295, "mlp_time_us": 13122.25341796875, "allgather_time_us": 0, "allreduce_time_us": 254.29900208492646, "total_latency_us": 18068}, {"doc_id": 15, "doc_len": 74771, "worker_id": 16, "attn_time_us": 125906.28161752503, "mlp_time_us": 68454.89501953125, "allgather_time_us": 0, "allreduce_time_us": 1025.9948267015664, "total_latency_us": 195387}, {"doc_id": 16, "doc_len": 66335, "worker_id": 15, "attn_time_us": 98315.71259001312, "mlp_time_us": 60731.50634765625, "allgather_time_us": 0, "allreduce_time_us": 920.0911374716885, "total_latency_us": 159967}, {"doc_id": 17, "doc_len": 19831, "worker_id": 14, "attn_time_us": 8884.283536116996, "mlp_time_us": 18155.82275390625, "allgather_time_us": 0, "allreduce_time_us": 326.66881420420884, "total_latency_us": 27366}, {"doc_id": 18, "doc_len": 15296, "worker_id": 13, "attn_time_us": 5321.311843516945, "mlp_time_us": 14003.90625, "allgather_time_us": 0, "allreduce_time_us": 266.4863482146812, "total_latency_us": 19591}, {"doc_id": 19, "doc_len": 31167, "worker_id": 12, "attn_time_us": 21825.09958364952, "mlp_time_us": 28534.24072265625, "allgather_time_us": 0, "allreduce_time_us": 470.57854979376003, "total_latency_us": 50829}, {"doc_id": 20, "doc_len": 7769, "worker_id": 11, "attn_time_us": 1440.3940396992687, "mlp_time_us": 7112.73193359375, "allgather_time_us": 0, "allreduce_time_us": 163.23850924043458, "total_latency_us": 8716}, {"doc_id": 21, "doc_len": 6741, "worker_id": 10, "attn_time_us": 1107.0389397180363, "mlp_time_us": 6171.56982421875, "allgather_time_us": 0, "allreduce_time_us": 146.4314794158378, "total_latency_us": 7425}, {"doc_id": 22, "doc_len": 8646, "worker_id": 9, "attn_time_us": 1764.0804435729494, "mlp_time_us": 7915.6494140625, "allgather_time_us": 0, "allreduce_time_us": 176.73094528683725, "total_latency_us": 9856}, {"doc_id": 23, "doc_len": 57831, "worker_id": 8, "attn_time_us": 74741.89858423901, "mlp_time_us": 52945.86181640625, "allgather_time_us": 0, "allreduce_time_us": 813.8225420191098, "total_latency_us": 128501}, {"doc_id": 24, "doc_len": 39755, "worker_id": 7, "attn_time_us": 35431.2248892226, "mlp_time_us": 36396.78955078125, "allgather_time_us": 0, "allreduce_time_us": 582.3220640749761, "total_latency_us": 72410}, {"doc_id": 25, "doc_len": 34611, "worker_id": 6, "attn_time_us": 26886.466380440826, "mlp_time_us": 31687.31689453125, "allgather_time_us": 0, "allreduce_time_us": 514.5404675442439, "total_latency_us": 59088}, {"doc_id": 26, "doc_len": 61200, "worker_id": 5, "attn_time_us": 83664.28635769592, "mlp_time_us": 56030.2734375, "allgather_time_us": 0, "allreduce_time_us": 856.0345894352561, "total_latency_us": 140550}, {"doc_id": 27, "doc_len": 18523, "worker_id": 4, "attn_time_us": 7757.344090194271, "mlp_time_us": 16958.31298828125, "allgather_time_us": 0, "allreduce_time_us": 309.1598552503861, "total_latency_us": 25024}, {"doc_id": 28, "doc_len": 35075, "worker_id": 3, "attn_time_us": 27609.114078920364, "mlp_time_us": 32112.12158203125, "allgather_time_us": 0, "allreduce_time_us": 520.696575719956, "total_latency_us": 60241}, {"doc_id": 29, "doc_len": 8666, "worker_id": 2, "attn_time_us": 1771.9864246461489, "mlp_time_us": 7933.9599609375, "allgather_time_us": 0, "allreduce_time_us": 177.02515308297293, "total_latency_us": 9882}, {"doc_id": 30, "doc_len": 6624, "worker_id": 1, "attn_time_us": 1071.6687986871568, "mlp_time_us": 6064.453125, "allgather_time_us": 0, "allreduce_time_us": 144.4818591389492, "total_latency_us": 7280}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 24802.53382733603, "mlp_time_us": 30429.38232421875, "allgather_time_us": 0, "allreduce_time_us": 496.2586549675635, "total_latency_us": 55728}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 6181.108862578307, "mlp_time_us": 15127.25830078125, "allgather_time_us": 0, "allreduce_time_us": 281.91630016084656, "total_latency_us": 21590}, {"doc_id": 33, "doc_len": 34119, "worker_id": 1, "attn_time_us": 26130.635429131922, "mlp_time_us": 31236.87744140625, "allgather_time_us": 0, "allreduce_time_us": 508.00322152934996, "total_latency_us": 57875}, {"doc_id": 34, "doc_len": 66136, "worker_id": 0, "attn_time_us": 97707.27256390669, "mlp_time_us": 60549.31640625, "allgather_time_us": 0, "allreduce_time_us": 917.5788527746496, "total_latency_us": 159174}, {"doc_id": 35, "doc_len": 33889, "worker_id": 0, "attn_time_us": 25780.980699252195, "mlp_time_us": 31026.30615234375, "allgather_time_us": 0, "allreduce_time_us": 504.94374186556115, "total_latency_us": 57312}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 134.6065337393175, "mlp_time": 1861.26708984375, "allgather_time": 0, "allreduce_time": 69.8856543400674}, "1": {"doc_len": 32101, "attn_time": 23144.55157651549, "mlp_time": 29389.34326171875, "allgather_time": 0, "allreduce_time": 481.93147583199897}, "2": {"doc_len": 60107, "attn_time": 80714.72298957057, "mlp_time": 55029.60205078125, "allgather_time": 0, "allreduce_time": 842.3676918899671}, "3": {"doc_len": 16438, "attn_time": 6118.057307935284, "mlp_time": 15049.4384765625, "allgather_time": 0, "allreduce_time": 280.74483252422374}, "4": {"doc_len": 17552, "attn_time": 6969.883499536529, "mlp_time": 16069.3359375, "allgather_time": 0, "allreduce_time": 296.00791871083493}, "5": {"doc_len": 17650, "attn_time": 7047.459170573273, "mlp_time": 16159.0576171875, "allgather_time": 0, "allreduce_time": 297.3415450962168}, "6": {"doc_len": 7168, "attn_time": 1240.5995681792554, "mlp_time": 6562.5, "allgather_time": 0, "allreduce_time": 153.4808059082835}, "7": {"doc_len": 7125, "attn_time": 1226.8327021419832, "mlp_time": 6523.13232421875, "allgather_time": 0, "allreduce_time": 152.77547078634439}, "8": {"doc_len": 19562, "attn_time": 8646.317741704843, "mlp_time": 17909.5458984375, "allgather_time": 0, "allreduce_time": 323.0866129032291}, "9": {"doc_len": 9323, "attn_time": 2041.181774895663, "mlp_time": 8535.46142578125, "allgather_time": 0, "allreduce_time": 186.58734851770646}, "10": {"doc_len": 41353, "attn_time": 38324.25280146708, "mlp_time": 37859.80224609375, "allgather_time": 0, "allreduce_time": 603.1823535044257}, "11": {"doc_len": 18999, "attn_time": 8158.664073916434, "mlp_time": 17394.10400390625, "allgather_time": 0, "allreduce_time": 315.55834891481015}, "12": {"doc_len": 81288, "attn_time": 149636.5745234409, "mlp_time": 74421.38671875, "allgather_time": 0, "allreduce_time": 1107.0675685466078}, "13": {"doc_len": 26799, "attn_time": 16165.677660106778, "mlp_time": 24535.21728515625, "allgather_time": 0, "allreduce_time": 416.57066903753}, "14": {"doc_len": 14333, "attn_time": 4692.061961222295, "mlp_time": 13122.25341796875, "allgather_time": 0, "allreduce_time": 254.29900208492646}, "15": {"doc_len": 74771, "attn_time": 125906.28161752503, "mlp_time": 68454.89501953125, "allgather_time": 0, "allreduce_time": 1025.9948267015664}, "16": {"doc_len": 66335, "attn_time": 98315.71259001312, "mlp_time": 60731.50634765625, "allgather_time": 0, "allreduce_time": 920.0911374716885}, "17": {"doc_len": 19831, "attn_time": 8884.283536116996, "mlp_time": 18155.82275390625, "allgather_time": 0, "allreduce_time": 326.66881420420884}, "18": {"doc_len": 15296, "attn_time": 5321.311843516945, "mlp_time": 14003.90625, "allgather_time": 0, "allreduce_time": 266.4863482146812}, "19": {"doc_len": 31167, "attn_time": 21825.09958364952, "mlp_time": 28534.24072265625, "allgather_time": 0, "allreduce_time": 470.57854979376003}, "20": {"doc_len": 7769, "attn_time": 1440.3940396992687, "mlp_time": 7112.73193359375, "allgather_time": 0, "allreduce_time": 163.23850924043458}, "21": {"doc_len": 6741, "attn_time": 1107.0389397180363, "mlp_time": 6171.56982421875, "allgather_time": 0, "allreduce_time": 146.4314794158378}, "22": {"doc_len": 8646, "attn_time": 1764.0804435729494, "mlp_time": 7915.6494140625, "allgather_time": 0, "allreduce_time": 176.73094528683725}, "23": {"doc_len": 57831, "attn_time": 74741.89858423901, "mlp_time": 52945.86181640625, "allgather_time": 0, "allreduce_time": 813.8225420191098}, "24": {"doc_len": 39755, "attn_time": 35431.2248892226, "mlp_time": 36396.78955078125, "allgather_time": 0, "allreduce_time": 582.3220640749761}, "25": {"doc_len": 34611, "attn_time": 26886.466380440826, "mlp_time": 31687.31689453125, "allgather_time": 0, "allreduce_time": 514.5404675442439}, "26": {"doc_len": 61200, "attn_time": 83664.28635769592, "mlp_time": 56030.2734375, "allgather_time": 0, "allreduce_time": 856.0345894352561}, "27": {"doc_len": 18523, "attn_time": 7757.344090194271, "mlp_time": 16958.31298828125, "allgather_time": 0, "allreduce_time": 309.1598552503861}, "28": {"doc_len": 35075, "attn_time": 27609.114078920364, "mlp_time": 32112.12158203125, "allgather_time": 0, "allreduce_time": 520.696575719956}, "29": {"doc_len": 8666, "attn_time": 1771.9864246461489, "mlp_time": 7933.9599609375, "allgather_time": 0, "allreduce_time": 177.02515308297293}, "30": {"doc_len": 6624, "attn_time": 1071.6687986871568, "mlp_time": 6064.453125, "allgather_time": 0, "allreduce_time": 144.4818591389492}, "31": {"doc_len": 33237, "attn_time": 24802.53382733603, "mlp_time": 30429.38232421875, "allgather_time": 0, "allreduce_time": 496.2586549675635}, "32": {"doc_len": 16523, "attn_time": 6181.108862578307, "mlp_time": 15127.25830078125, "allgather_time": 0, "allreduce_time": 281.91630016084656}, "33": {"doc_len": 34119, "attn_time": 26130.635429131922, "mlp_time": 31236.87744140625, "allgather_time": 0, "allreduce_time": 508.00322152934996}, "34": {"doc_len": 66136, "attn_time": 97707.27256390669, "mlp_time": 60549.31640625, "allgather_time": 0, "allreduce_time": 917.5788527746496}, "35": {"doc_len": 33889, "attn_time": 25780.980699252195, "mlp_time": 31026.30615234375, "allgather_time": 0, "allreduce_time": 504.94374186556115}}}, "attnserver_result": {"batch_total_time": 64642.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 980.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 2, "mlp_cp": 1}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 2, "dp": 16, "ratio": 0.6003392161356864, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 109075, "worker_latencies_us": [107826, 106025, 109003, 109075, 100338, 84797, 84527, 95338, 56836, 4238, 12212, 41219, 11161, 67673, 0, 28093], "doc2worker": {"0": 15, "1": 15, "2": 13, "3": 12, "4": 11, "5": 10, "6": 9, "7": 8, "8": 8, "9": 6, "10": 8, "11": 5, "12": 3, "13": 5, "14": 2, "15": 7, "16": 6, "17": 5, "18": 5, "19": 5, "20": 1, "21": 1, "22": 1, "23": 4, "24": 4, "25": 2, "26": 2, "27": 1, "28": 1, "29": 1, "30": 1, "31": 1, "32": 1, "33": 0, "34": 0, "35": 11}, "latency_breakdown": {"max_worker_latency_us": 109075, "worker_latencies_us": [107826, 106025, 109003, 109075, 100338, 84797, 84527, 95338, 56836, 4238, 12212, 41219, 11161, 67673, 0, 28093], "solver_status": "OPTIMAL", "solved_time_s": 0.025413990020751953, "num_vars": 593, "num_cons": 84}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [33, 34], "total_batch_length": 100255, "total_latency_us": 107826, "mlp_cost_us": 45893.096923828125, "attn_cost_us": 60260.653816593935, "allreduce_cost_us": 1425.5820743039994, "allgather_cost_us": 247.87052869796753}, {"worker_id": 1, "assigned_docs": [20, 21, 22, 27, 28, 29, 30, 31, 32], "total_batch_length": 141804, "total_latency_us": 106025, "mlp_cost_us": 64912.7197265625, "attn_cost_us": 38350.003012244204, "allreduce_cost_us": 2415.9393322637843, "allgather_cost_us": 350.59630393981934}, {"worker_id": 2, "assigned_docs": [14, 25, 26], "total_batch_length": 110144, "total_latency_us": 109003, "mlp_cost_us": 50419.921875, "attn_cost_us": 56687.39399111836, "allreduce_cost_us": 1624.8740590644265, "allgather_cost_us": 272.3200988769531}, {"worker_id": 3, "assigned_docs": [12], "total_batch_length": 81288, "total_latency_us": 109075, "mlp_cost_us": 37210.693359375, "attn_cost_us": 70557.10197368039, "allreduce_cost_us": 1107.0675685466078, "allgather_cost_us": 200.976505279541}, {"worker_id": 4, "assigned_docs": [23, 24], "total_batch_length": 97586, "total_latency_us": 100338, "mlp_cost_us": 44671.32568359375, "attn_cost_us": 54030.42268531943, "allreduce_cost_us": 1396.144606094086, "allgather_cost_us": 241.27169132232666}, {"worker_id": 5, "assigned_docs": [11, 13, 17, 18, 19], "total_batch_length": 112092, "total_latency_us": 84797, "mlp_cost_us": 51311.6455078125, "attn_cost_us": 31414.468678862308, "allreduce_cost_us": 1795.8627301649901, "allgather_cost_us": 277.1363353729248}, {"worker_id": 6, "assigned_docs": [9, 16], "total_batch_length": 75658, "total_latency_us": 84527, "mlp_cost_us": 34633.48388671875, "attn_cost_us": 48601.47057803389, "allreduce_cost_us": 1106.678485989395, "allgather_cost_us": 187.05688953399658}, {"worker_id": 7, "assigned_docs": [15], "total_batch_length": 74771, "total_latency_us": 95338, "mlp_cost_us": 34227.447509765625, "attn_cost_us": 59900.13712905783, "allreduce_cost_us": 1025.9948267015664, "allgather_cost_us": 184.86387014389035}, {"worker_id": 8, "assigned_docs": [7, 8, 10], "total_batch_length": 68040, "total_latency_us": 56836, "mlp_cost_us": 31146.240234375, "attn_cost_us": 24443.611711139656, "allreduce_cost_us": 1079.044437193999, "allgather_cost_us": 168.22214126586914}, {"worker_id": 9, "assigned_docs": [6], "total_batch_length": 7168, "total_latency_us": 4238, "mlp_cost_us": 3281.25, "attn_cost_us": 786.3950870461508, "allreduce_cost_us": 153.4808059082835, "allgather_cost_us": 17.722167968749996}, {"worker_id": 10, "assigned_docs": [5], "total_batch_length": 17650, "total_latency_us": 12212, "mlp_cost_us": 8079.52880859375, "attn_cost_us": 3791.508349117613, "allreduce_cost_us": 297.3415450962168, "allgather_cost_us": 43.637871742248535}, {"worker_id": 11, "assigned_docs": [4, 35], "total_batch_length": 51441, "total_latency_us": 41219, "mlp_cost_us": 23547.821044921875, "attn_cost_us": 16744.36127577066, "allreduce_cost_us": 800.9516605763961, "allgather_cost_us": 127.18276262283325}, {"worker_id": 12, "assigned_docs": [3], "total_batch_length": 16438, "total_latency_us": 11161, "mlp_cost_us": 7524.71923828125, "attn_cost_us": 3315.4782794913426, "allreduce_cost_us": 280.74483252422374, "allgather_cost_us": 40.64132213592529}, {"worker_id": 13, "assigned_docs": [2], "total_batch_length": 60107, "total_latency_us": 67673, "mlp_cost_us": 27514.801025390625, "attn_cost_us": 39167.63443588108, "allreduce_cost_us": 842.3676918899671, "allgather_cost_us": 148.6085867881775}, {"worker_id": 14, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 15, "assigned_docs": [0, 1], "total_batch_length": 34134, "total_latency_us": 28093, "mlp_cost_us": 15625.30517578125, "attn_cost_us": 11832.338079202658, "allreduce_cost_us": 551.8171301720664, "allgather_cost_us": 84.39292430877686}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 15, "attn_time_us": 118.05078022496694, "mlp_time_us": 930.633544921875, "allgather_time_us": 5.026390552520752, "allreduce_time_us": 69.8856543400674, "total_latency_us": 1123}, {"doc_id": 1, "doc_len": 32101, "worker_id": 15, "attn_time_us": 11714.287298977692, "mlp_time_us": 14694.671630859375, "allgather_time_us": 79.3665337562561, "allreduce_time_us": 481.93147583199897, "total_latency_us": 26970}, {"doc_id": 2, "doc_len": 60107, "worker_id": 13, "attn_time_us": 39167.63443588108, "mlp_time_us": 27514.801025390625, "allgather_time_us": 148.6085867881775, "allreduce_time_us": 842.3676918899671, "total_latency_us": 67673}, {"doc_id": 3, "doc_len": 16438, "worker_id": 12, "attn_time_us": 3315.4782794913426, "mlp_time_us": 7524.71923828125, "allgather_time_us": 40.64132213592529, "allreduce_time_us": 280.74483252422374, "total_latency_us": 11161}, {"doc_id": 4, "doc_len": 17552, "worker_id": 11, "attn_time_us": 3751.9043393462443, "mlp_time_us": 8034.66796875, "allgather_time_us": 43.39557647705078, "allreduce_time_us": 296.00791871083493, "total_latency_us": 12125}, {"doc_id": 5, "doc_len": 17650, "worker_id": 10, "attn_time_us": 3791.508349117613, "mlp_time_us": 8079.52880859375, "allgather_time_us": 43.637871742248535, "allreduce_time_us": 297.3415450962168, "total_latency_us": 12212}, {"doc_id": 6, "doc_len": 7168, "worker_id": 9, "attn_time_us": 786.3950870461508, "mlp_time_us": 3281.25, "allgather_time_us": 17.722167968749996, "allreduce_time_us": 153.4808059082835, "total_latency_us": 4238}, {"doc_id": 7, "doc_len": 7125, "worker_id": 8, "attn_time_us": 778.749653005774, "mlp_time_us": 3261.566162109375, "allgather_time_us": 17.615854740142822, "allreduce_time_us": 152.77547078634439, "total_latency_us": 4210}, {"doc_id": 8, "doc_len": 19562, "worker_id": 8, "attn_time_us": 4603.114705729316, "mlp_time_us": 8954.77294921875, "allgather_time_us": 48.36510181427001, "allreduce_time_us": 323.0866129032291, "total_latency_us": 13929}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1225.532184242513, "mlp_time_us": 4267.730712890625, "allgather_time_us": 23.050191402435303, "allreduce_time_us": 186.58734851770646, "total_latency_us": 5702}, {"doc_id": 10, "doc_len": 41353, "worker_id": 8, "attn_time_us": 19061.747352404567, "mlp_time_us": 18929.901123046875, "allgather_time_us": 102.2411847114563, "allreduce_time_us": 603.1823535044257, "total_latency_us": 38697}, {"doc_id": 11, "doc_len": 18999, "worker_id": 5, "attn_time_us": 4356.462966918867, "mlp_time_us": 8697.052001953125, "allgather_time_us": 46.97314023971557, "allreduce_time_us": 315.55834891481015, "total_latency_us": 13416}, {"doc_id": 12, "doc_len": 81288, "worker_id": 3, "attn_time_us": 70557.10197368039, "mlp_time_us": 37210.693359375, "allgather_time_us": 200.976505279541, "allreduce_time_us": 1107.0675685466078, "total_latency_us": 109075}, {"doc_id": 13, "doc_len": 26799, "worker_id": 5, "attn_time_us": 8334.172105336203, "mlp_time_us": 12267.608642578125, "allgather_time_us": 66.25786542892456, "allreduce_time_us": 416.57066903753, "total_latency_us": 21084}, {"doc_id": 14, "doc_len": 14333, "worker_id": 2, "attn_time_us": 2605.947665949098, "mlp_time_us": 6561.126708984375, "allgather_time_us": 35.43691873550415, "allreduce_time_us": 254.29900208492646, "total_latency_us": 9456}, {"doc_id": 15, "doc_len": 74771, "worker_id": 7, "attn_time_us": 59900.13712905783, "mlp_time_us": 34227.447509765625, "allgather_time_us": 184.86387014389035, "allreduce_time_us": 1025.9948267015664, "total_latency_us": 95338}, {"doc_id": 16, "doc_len": 66335, "worker_id": 6, "attn_time_us": 47375.93839379138, "mlp_time_us": 30365.753173828125, "allgather_time_us": 164.00669813156128, "allreduce_time_us": 920.0911374716885, "total_latency_us": 78825}, {"doc_id": 17, "doc_len": 19831, "worker_id": 5, "attn_time_us": 4723.214462639636, "mlp_time_us": 9077.911376953125, "allgather_time_us": 49.030177593231194, "allreduce_time_us": 326.66881420420884, "total_latency_us": 14176}, {"doc_id": 18, "doc_len": 15296, "worker_id": 5, "attn_time_us": 2920.8146186310973, "mlp_time_us": 7001.953125, "allgather_time_us": 37.817840576171875, "allreduce_time_us": 266.4863482146812, "total_latency_us": 10227}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 11079.8045253365, "mlp_time_us": 14267.120361328125, "allgather_time_us": 77.05731153488159, "allreduce_time_us": 470.57854979376003, "total_latency_us": 25894}, {"doc_id": 20, "doc_len": 7769, "worker_id": 1, "attn_time_us": 896.2244183255924, "mlp_time_us": 3556.365966796875, "allgather_time_us": 19.208080768585205, "allreduce_time_us": 163.23850924043458, "total_latency_us": 4635}, {"doc_id": 21, "doc_len": 6741, "worker_id": 1, "attn_time_us": 711.7555478506564, "mlp_time_us": 3085.784912109375, "allgather_time_us": 16.666452884674072, "allreduce_time_us": 146.4314794158378, "total_latency_us": 3960}, {"doc_id": 22, "doc_len": 8646, "worker_id": 1, "attn_time_us": 1073.725692168193, "mlp_time_us": 3957.82470703125, "allgather_time_us": 21.37637615203857, "allreduce_time_us": 176.73094528683725, "total_latency_us": 5229}, {"doc_id": 23, "doc_len": 57831, "worker_id": 4, "attn_time_us": 36361.737080272935, "mlp_time_us": 26472.930908203125, "allgather_time_us": 142.98140287399292, "allreduce_time_us": 813.8225420191098, "total_latency_us": 63791}, {"doc_id": 24, "doc_len": 39755, "worker_id": 4, "attn_time_us": 17668.685605046496, "mlp_time_us": 18198.394775390625, "allgather_time_us": 98.29028844833374, "allreduce_time_us": 582.3220640749761, "total_latency_us": 36547}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 13530.742055399416, "mlp_time_us": 15843.658447265625, "allgather_time_us": 85.57225942611693, "allreduce_time_us": 514.5404675442439, "total_latency_us": 29974}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 40550.70426976985, "mlp_time_us": 28015.13671875, "allgather_time_us": 151.31092071533203, "allreduce_time_us": 856.0345894352561, "total_latency_us": 69573}, {"doc_id": 27, "doc_len": 18523, "worker_id": 1, "attn_time_us": 4152.911391045368, "mlp_time_us": 8479.156494140625, "allgather_time_us": 45.796277523040764, "allreduce_time_us": 309.1598552503861, "total_latency_us": 12987}, {"doc_id": 28, "doc_len": 35075, "worker_id": 1, "attn_time_us": 13882.217005103214, "mlp_time_us": 16056.060791015625, "allgather_time_us": 86.71945333480835, "allreduce_time_us": 520.696575719956, "total_latency_us": 30545}, {"doc_id": 29, "doc_len": 8666, "worker_id": 1, "attn_time_us": 1078.086342059685, "mlp_time_us": 3966.97998046875, "allgather_time_us": 21.42582416534424, "allreduce_time_us": 177.02515308297293, "total_latency_us": 5243}, {"doc_id": 30, "doc_len": 6624, "worker_id": 1, "attn_time_us": 691.8059152503541, "mlp_time_us": 3032.2265625, "allgather_time_us": 16.377182006835934, "allreduce_time_us": 144.4818591389492, "total_latency_us": 3884}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 12515.392456632379, "mlp_time_us": 15214.691162109375, "allgather_time_us": 82.17518091201782, "allreduce_time_us": 496.2586549675635, "total_latency_us": 28308}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 3347.884243808757, "mlp_time_us": 7563.629150390625, "allgather_time_us": 40.85147619247436, "allreduce_time_us": 281.91630016084656, "total_latency_us": 11234}, {"doc_id": 33, "doc_len": 34119, "worker_id": 0, "attn_time_us": 13162.792610725812, "mlp_time_us": 15618.438720703125, "allgather_time_us": 84.3558382987976, "allreduce_time_us": 508.00322152934996, "total_latency_us": 29373}, {"doc_id": 34, "doc_len": 66136, "worker_id": 0, "attn_time_us": 47097.861205868125, "mlp_time_us": 30274.658203125, "allgather_time_us": 163.51469039916992, "allreduce_time_us": 917.5788527746496, "total_latency_us": 78453}, {"doc_id": 35, "doc_len": 33889, "worker_id": 11, "attn_time_us": 12992.456936424416, "mlp_time_us": 15513.153076171875, "allgather_time_us": 83.78718614578247, "allreduce_time_us": 504.94374186556115, "total_latency_us": 29094}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 118.05078022496694, "mlp_time": 930.633544921875, "allgather_time": 5.026390552520752, "allreduce_time": 69.8856543400674}, "1": {"doc_len": 32101, "attn_time": 11714.287298977692, "mlp_time": 14694.671630859375, "allgather_time": 79.3665337562561, "allreduce_time": 481.93147583199897}, "2": {"doc_len": 60107, "attn_time": 39167.63443588108, "mlp_time": 27514.801025390625, "allgather_time": 148.6085867881775, "allreduce_time": 842.3676918899671}, "3": {"doc_len": 16438, "attn_time": 3315.4782794913426, "mlp_time": 7524.71923828125, "allgather_time": 40.64132213592529, "allreduce_time": 280.74483252422374}, "4": {"doc_len": 17552, "attn_time": 3751.9043393462443, "mlp_time": 8034.66796875, "allgather_time": 43.39557647705078, "allreduce_time": 296.00791871083493}, "5": {"doc_len": 17650, "attn_time": 3791.508349117613, "mlp_time": 8079.52880859375, "allgather_time": 43.637871742248535, "allreduce_time": 297.3415450962168}, "6": {"doc_len": 7168, "attn_time": 786.3950870461508, "mlp_time": 3281.25, "allgather_time": 17.722167968749996, "allreduce_time": 153.4808059082835}, "7": {"doc_len": 7125, "attn_time": 778.749653005774, "mlp_time": 3261.566162109375, "allgather_time": 17.615854740142822, "allreduce_time": 152.77547078634439}, "8": {"doc_len": 19562, "attn_time": 4603.114705729316, "mlp_time": 8954.77294921875, "allgather_time": 48.36510181427001, "allreduce_time": 323.0866129032291}, "9": {"doc_len": 9323, "attn_time": 1225.532184242513, "mlp_time": 4267.730712890625, "allgather_time": 23.050191402435303, "allreduce_time": 186.58734851770646}, "10": {"doc_len": 41353, "attn_time": 19061.747352404567, "mlp_time": 18929.901123046875, "allgather_time": 102.2411847114563, "allreduce_time": 603.1823535044257}, "11": {"doc_len": 18999, "attn_time": 4356.462966918867, "mlp_time": 8697.052001953125, "allgather_time": 46.97314023971557, "allreduce_time": 315.55834891481015}, "12": {"doc_len": 81288, "attn_time": 70557.10197368039, "mlp_time": 37210.693359375, "allgather_time": 200.976505279541, "allreduce_time": 1107.0675685466078}, "13": {"doc_len": 26799, "attn_time": 8334.172105336203, "mlp_time": 12267.608642578125, "allgather_time": 66.25786542892456, "allreduce_time": 416.57066903753}, "14": {"doc_len": 14333, "attn_time": 2605.947665949098, "mlp_time": 6561.126708984375, "allgather_time": 35.43691873550415, "allreduce_time": 254.29900208492646}, "15": {"doc_len": 74771, "attn_time": 59900.13712905783, "mlp_time": 34227.447509765625, "allgather_time": 184.86387014389035, "allreduce_time": 1025.9948267015664}, "16": {"doc_len": 66335, "attn_time": 47375.93839379138, "mlp_time": 30365.753173828125, "allgather_time": 164.00669813156128, "allreduce_time": 920.0911374716885}, "17": {"doc_len": 19831, "attn_time": 4723.214462639636, "mlp_time": 9077.911376953125, "allgather_time": 49.030177593231194, "allreduce_time": 326.66881420420884}, "18": {"doc_len": 15296, "attn_time": 2920.8146186310973, "mlp_time": 7001.953125, "allgather_time": 37.817840576171875, "allreduce_time": 266.4863482146812}, "19": {"doc_len": 31167, "attn_time": 11079.8045253365, "mlp_time": 14267.120361328125, "allgather_time": 77.05731153488159, "allreduce_time": 470.57854979376003}, "20": {"doc_len": 7769, "attn_time": 896.2244183255924, "mlp_time": 3556.365966796875, "allgather_time": 19.208080768585205, "allreduce_time": 163.23850924043458}, "21": {"doc_len": 6741, "attn_time": 711.7555478506564, "mlp_time": 3085.784912109375, "allgather_time": 16.666452884674072, "allreduce_time": 146.4314794158378}, "22": {"doc_len": 8646, "attn_time": 1073.725692168193, "mlp_time": 3957.82470703125, "allgather_time": 21.37637615203857, "allreduce_time": 176.73094528683725}, "23": {"doc_len": 57831, "attn_time": 36361.737080272935, "mlp_time": 26472.930908203125, "allgather_time": 142.98140287399292, "allreduce_time": 813.8225420191098}, "24": {"doc_len": 39755, "attn_time": 17668.685605046496, "mlp_time": 18198.394775390625, "allgather_time": 98.29028844833374, "allreduce_time": 582.3220640749761}, "25": {"doc_len": 34611, "attn_time": 13530.742055399416, "mlp_time": 15843.658447265625, "allgather_time": 85.57225942611693, "allreduce_time": 514.5404675442439}, "26": {"doc_len": 61200, "attn_time": 40550.70426976985, "mlp_time": 28015.13671875, "allgather_time": 151.31092071533203, "allreduce_time": 856.0345894352561}, "27": {"doc_len": 18523, "attn_time": 4152.911391045368, "mlp_time": 8479.156494140625, "allgather_time": 45.796277523040764, "allreduce_time": 309.1598552503861}, "28": {"doc_len": 35075, "attn_time": 13882.217005103214, "mlp_time": 16056.060791015625, "allgather_time": 86.71945333480835, "allreduce_time": 520.696575719956}, "29": {"doc_len": 8666, "attn_time": 1078.086342059685, "mlp_time": 3966.97998046875, "allgather_time": 21.42582416534424, "allreduce_time": 177.02515308297293}, "30": {"doc_len": 6624, "attn_time": 691.8059152503541, "mlp_time": 3032.2265625, "allgather_time": 16.377182006835934, "allreduce_time": 144.4818591389492}, "31": {"doc_len": 33237, "attn_time": 12515.392456632379, "mlp_time": 15214.691162109375, "allgather_time": 82.17518091201782, "allreduce_time": 496.2586549675635}, "32": {"doc_len": 16523, "attn_time": 3347.884243808757, "mlp_time": 7563.629150390625, "allgather_time": 40.85147619247436, "allreduce_time": 281.91630016084656}, "33": {"doc_len": 34119, "attn_time": 13162.792610725812, "mlp_time": 15618.438720703125, "allgather_time": 84.3558382987976, "allreduce_time": 508.00322152934996}, "34": {"doc_len": 66136, "attn_time": 47097.861205868125, "mlp_time": 30274.658203125, "allgather_time": 163.51469039916992, "allreduce_time": 917.5788527746496}, "35": {"doc_len": 33889, "attn_time": 12992.456936424416, "mlp_time": 15513.153076171875, "allgather_time": 83.78718614578247, "allreduce_time": 504.94374186556115}}}, "attnserver_result": {"batch_total_time": 65482.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 1820.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 2, "mlp_cp": 2}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 4, "dp": 8, "ratio": 1.0030503304524656, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 66878, "worker_latencies_us": [66877, 66875, 66878, 66878, 66872, 66862, 66873, 66864], "doc2worker": {"0": 7, "1": 6, "2": 5, "3": 4, "4": 6, "5": 4, "6": 4, "7": 5, "8": 3, "9": 4, "10": 0, "11": 2, "12": 3, "13": 7, "14": 6, "15": 7, "16": 6, "17": 2, "18": 7, "19": 5, "20": 1, "21": 1, "22": 3, "23": 4, "24": 1, "25": 2, "26": 2, "27": 4, "28": 0, "29": 4, "30": 1, "31": 0, "32": 4, "33": 5, "34": 1, "35": 0}, "latency_breakdown": {"max_worker_latency_us": 66878, "worker_latencies_us": [66877, 66875, 66878, 66878, 66872, 66862, 66873, 66864], "solver_status": "FEASIBLE", "solved_time_s": 360.05682611465454, "num_vars": 297, "num_cons": 60}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [10, 28, 31, 35], "total_batch_length": 143554, "total_latency_us": 66877, "mlp_cost_us": 32856.903076171875, "attn_cost_us": 31500.96959045148, "allreduce_cost_us": 2125.081326057506, "allgather_cost_us": 395.6518745422363}, {"worker_id": 1, "assigned_docs": [20, 21, 24, 30, 34], "total_batch_length": 127025, "total_latency_us": 66875, "mlp_cost_us": 29073.715209960938, "attn_cost_us": 35500.9547811824, "allreduce_cost_us": 1954.0527646448472, "allgather_cost_us": 350.0959873199463}, {"worker_id": 2, "assigned_docs": [11, 17, 25, 26], "total_batch_length": 134641, "total_latency_us": 66878, "mlp_cost_us": 30816.879272460938, "attn_cost_us": 33679.12139268809, "allreduce_cost_us": 2012.802220098519, "allgather_cost_us": 371.0865879058838}, {"worker_id": 3, "assigned_docs": [8, 12, 22], "total_batch_length": 109496, "total_latency_us": 66878, "mlp_cost_us": 25061.6455078125, "attn_cost_us": 39910.00911017308, "allreduce_cost_us": 1606.885126736674, "allgather_cost_us": 301.7839813232422}, {"worker_id": 4, "assigned_docs": [3, 5, 6, 9, 23, 27, 29, 32], "total_batch_length": 152122, "total_latency_us": 66872, "mlp_cost_us": 34817.962646484375, "attn_cost_us": 29139.01221021034, "allreduce_cost_us": 2500.078382559746, "allgather_cost_us": 419.266300201416}, {"worker_id": 5, "assigned_docs": [2, 7, 19, 33], "total_batch_length": 132518, "total_latency_us": 66862, "mlp_cost_us": 30330.963134765625, "attn_cost_us": 34193.929182812586, "allreduce_cost_us": 1973.7249339994214, "allgather_cost_us": 365.23534774780273}, {"worker_id": 6, "assigned_docs": [1, 4, 14, 16], "total_batch_length": 130321, "total_latency_us": 66873, "mlp_cost_us": 29828.109741210938, "attn_cost_us": 34735.84048766094, "allreduce_cost_us": 1952.3295340994491, "allgather_cost_us": 359.18015480041504}, {"worker_id": 7, "assigned_docs": [0, 13, 15, 18], "total_batch_length": 118899, "total_latency_us": 66864, "mlp_cost_us": 27213.821411132812, "attn_cost_us": 37546.45957711681, "allreduce_cost_us": 1778.9374982938448, "allgather_cost_us": 327.6997661590576}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 79.97633262847914, "mlp_time_us": 465.3167724609375, "allgather_time_us": 5.603189468383789, "allreduce_time_us": 69.8856543400674, "total_latency_us": 620}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 6351.06278113216, "mlp_time_us": 7347.3358154296875, "allgather_time_us": 88.47416877746582, "allreduce_time_us": 481.93147583199897, "total_latency_us": 14268}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20604.84224625899, "mlp_time_us": 13757.400512695312, "allgather_time_us": 165.66203117370605, "allreduce_time_us": 842.3676918899671, "total_latency_us": 35370}, {"doc_id": 3, "doc_len": 16438, "worker_id": 4, "attn_time_us": 1862.9112236442056, "mlp_time_us": 3762.359619140625, "allgather_time_us": 45.30508041381836, "allreduce_time_us": 280.74483252422374, "total_latency_us": 5951}, {"doc_id": 4, "doc_len": 17552, "worker_id": 6, "attn_time_us": 2100.7658182471014, "mlp_time_us": 4017.333984375, "allgather_time_us": 48.375396728515625, "allreduce_time_us": 296.00791871083493, "total_latency_us": 6462}, {"doc_id": 5, "doc_len": 17650, "worker_id": 4, "attn_time_us": 2122.3100383002998, "mlp_time_us": 4039.764404296875, "allgather_time_us": 48.6454963684082, "allreduce_time_us": 297.3415450962168, "total_latency_us": 6508}, {"doc_id": 6, "doc_len": 7168, "worker_id": 4, "attn_time_us": 461.9506000207943, "mlp_time_us": 1640.625, "allgather_time_us": 19.755859375, "allreduce_time_us": 153.4808059082835, "total_latency_us": 2275}, {"doc_id": 7, "doc_len": 7125, "worker_id": 5, "attn_time_us": 457.75491245736544, "mlp_time_us": 1630.7830810546875, "allgather_time_us": 19.637346267700195, "allreduce_time_us": 152.77547078634439, "total_latency_us": 2260}, {"doc_id": 8, "doc_len": 19562, "worker_id": 3, "attn_time_us": 2562.5023924635566, "mlp_time_us": 4477.386474609375, "allgather_time_us": 53.91519546508789, "allreduce_time_us": 323.0866129032291, "total_latency_us": 7416}, {"doc_id": 9, "doc_len": 9323, "worker_id": 4, "attn_time_us": 705.7148888257445, "mlp_time_us": 2133.8653564453125, "allgather_time_us": 25.695295333862305, "allreduce_time_us": 186.58734851770646, "total_latency_us": 3051}, {"doc_id": 10, "doc_len": 41353, "worker_id": 0, "attn_time_us": 10208.905240827718, "mlp_time_us": 9464.950561523438, "allgather_time_us": 113.97377967834473, "allreduce_time_us": 603.1823535044257, "total_latency_us": 20391}, {"doc_id": 11, "doc_len": 18999, "worker_id": 2, "attn_time_us": 2428.9774294687622, "mlp_time_us": 4348.5260009765625, "allgather_time_us": 52.36350059509277, "allreduce_time_us": 315.55834891481015, "total_latency_us": 7145}, {"doc_id": 12, "doc_len": 81288, "worker_id": 3, "attn_time_us": 36727.19090862357, "mlp_time_us": 18605.3466796875, "allgather_time_us": 224.0393829345703, "allreduce_time_us": 1107.0675685466078, "total_latency_us": 56663}, {"doc_id": 13, "doc_len": 26799, "worker_id": 7, "attn_time_us": 4562.237119081084, "mlp_time_us": 6133.8043212890625, "allgather_time_us": 73.86122703552246, "allreduce_time_us": 416.57066903753, "total_latency_us": 11186}, {"doc_id": 14, "doc_len": 14333, "worker_id": 6, "attn_time_us": 1472.9842717019321, "mlp_time_us": 3280.5633544921875, "allgather_time_us": 39.50345039367676, "allreduce_time_us": 254.29900208492646, "total_latency_us": 5047}, {"doc_id": 15, "doc_len": 74771, "worker_id": 7, "attn_time_us": 31257.919769494267, "mlp_time_us": 17113.723754882812, "allgather_time_us": 206.07775688171387, "allreduce_time_us": 1025.9948267015664, "total_latency_us": 49603}, {"doc_id": 16, "doc_len": 66335, "worker_id": 6, "attn_time_us": 24811.027616579744, "mlp_time_us": 15182.876586914062, "allgather_time_us": 182.82713890075684, "allreduce_time_us": 920.0911374716885, "total_latency_us": 41096}, {"doc_id": 17, "doc_len": 19831, "worker_id": 2, "attn_time_us": 2627.4444460922673, "mlp_time_us": 4538.9556884765625, "allgather_time_us": 54.65659141540528, "allreduce_time_us": 326.66881420420884, "total_latency_us": 7547}, {"doc_id": 18, "doc_len": 15296, "worker_id": 7, "attn_time_us": 1646.3263559129805, "mlp_time_us": 3500.9765625, "allgather_time_us": 42.1575927734375, "allreduce_time_us": 266.4863482146812, "total_latency_us": 5455}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 6016.544490695573, "mlp_time_us": 7133.5601806640625, "allgather_time_us": 85.89995384216309, "allreduce_time_us": 470.57854979376003, "total_latency_us": 13706}, {"doc_id": 20, "doc_len": 7769, "worker_id": 1, "attn_time_us": 521.9385126890671, "mlp_time_us": 1778.1829833984375, "allgather_time_us": 21.41228675842285, "allreduce_time_us": 163.23850924043458, "total_latency_us": 2484}, {"doc_id": 21, "doc_len": 6741, "worker_id": 1, "attn_time_us": 420.86987638633957, "mlp_time_us": 1542.8924560546875, "allgather_time_us": 18.578996658325195, "allreduce_time_us": 146.4314794158378, "total_latency_us": 2128}, {"doc_id": 22, "doc_len": 8646, "worker_id": 3, "attn_time_us": 620.3158090859608, "mlp_time_us": 1978.912353515625, "allgather_time_us": 23.829402923583988, "allreduce_time_us": 176.73094528683725, "total_latency_us": 2799}, {"doc_id": 23, "doc_len": 57831, "worker_id": 4, "attn_time_us": 19164.126880549884, "mlp_time_us": 13236.465454101562, "allgather_time_us": 159.38910484313965, "allreduce_time_us": 813.8225420191098, "total_latency_us": 33373}, {"doc_id": 24, "doc_len": 39755, "worker_id": 1, "attn_time_us": 9480.690478277984, "mlp_time_us": 9099.197387695312, "allgather_time_us": 109.56950187683107, "allreduce_time_us": 582.3220640749761, "total_latency_us": 19271}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 7308.662033499889, "mlp_time_us": 7921.8292236328125, "allgather_time_us": 95.39202690124513, "allreduce_time_us": 514.5404675442439, "total_latency_us": 15840}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 21314.037483627173, "mlp_time_us": 14007.568359375, "allgather_time_us": 168.67446899414062, "allreduce_time_us": 856.0345894352561, "total_latency_us": 36346}, {"doc_id": 27, "doc_len": 18523, "worker_id": 4, "attn_time_us": 2318.6239354787476, "mlp_time_us": 4239.5782470703125, "allgather_time_us": 51.05158805847168, "allreduce_time_us": 309.1598552503861, "total_latency_us": 6918}, {"doc_id": 28, "doc_len": 35075, "worker_id": 0, "attn_time_us": 7493.733629727413, "mlp_time_us": 8028.0303955078125, "allgather_time_us": 96.67086601257324, "allreduce_time_us": 520.696575719956, "total_latency_us": 16139}, {"doc_id": 29, "doc_len": 8666, "worker_id": 4, "attn_time_us": 622.7728661152812, "mlp_time_us": 1983.489990234375, "allgather_time_us": 23.884525299072266, "allreduce_time_us": 177.02515308297293, "total_latency_us": 2807}, {"doc_id": 30, "doc_len": 6624, "worker_id": 1, "attn_time_us": 409.84270154962945, "mlp_time_us": 1516.11328125, "allgather_time_us": 18.25653076171875, "allreduce_time_us": 144.4818591389492, "total_latency_us": 2088}, {"doc_id": 31, "doc_len": 33237, "worker_id": 0, "attn_time_us": 6773.339353678316, "mlp_time_us": 7607.3455810546875, "allgather_time_us": 91.60511970520021, "allreduce_time_us": 496.2586549675635, "total_latency_us": 14968}, {"doc_id": 32, "doc_len": 16523, "worker_id": 4, "attn_time_us": 1880.6017772753858, "mlp_time_us": 3781.8145751953125, "allgather_time_us": 45.539350509643555, "allreduce_time_us": 281.91630016084656, "total_latency_us": 5989}, {"doc_id": 33, "doc_len": 34119, "worker_id": 5, "attn_time_us": 7114.787533400655, "mlp_time_us": 7809.2193603515625, "allgather_time_us": 94.0360164642334, "allreduce_time_us": 508.00322152934996, "total_latency_us": 15526}, {"doc_id": 34, "doc_len": 66136, "worker_id": 1, "attn_time_us": 24667.613212279382, "mlp_time_us": 15137.3291015625, "allgather_time_us": 182.27867126464844, "allreduce_time_us": 917.5788527746496, "total_latency_us": 40904}, {"doc_id": 35, "doc_len": 33889, "worker_id": 0, "attn_time_us": 7024.9913662180315, "mlp_time_us": 7756.5765380859375, "allgather_time_us": 93.40210914611816, "allreduce_time_us": 504.94374186556115, "total_latency_us": 15379}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 79.97633262847914, "mlp_time": 465.3167724609375, "allgather_time": 5.603189468383789, "allreduce_time": 69.8856543400674}, "1": {"doc_len": 32101, "attn_time": 6351.06278113216, "mlp_time": 7347.3358154296875, "allgather_time": 88.47416877746582, "allreduce_time": 481.93147583199897}, "2": {"doc_len": 60107, "attn_time": 20604.84224625899, "mlp_time": 13757.400512695312, "allgather_time": 165.66203117370605, "allreduce_time": 842.3676918899671}, "3": {"doc_len": 16438, "attn_time": 1862.9112236442056, "mlp_time": 3762.359619140625, "allgather_time": 45.30508041381836, "allreduce_time": 280.74483252422374}, "4": {"doc_len": 17552, "attn_time": 2100.7658182471014, "mlp_time": 4017.333984375, "allgather_time": 48.375396728515625, "allreduce_time": 296.00791871083493}, "5": {"doc_len": 17650, "attn_time": 2122.3100383002998, "mlp_time": 4039.764404296875, "allgather_time": 48.6454963684082, "allreduce_time": 297.3415450962168}, "6": {"doc_len": 7168, "attn_time": 461.9506000207943, "mlp_time": 1640.625, "allgather_time": 19.755859375, "allreduce_time": 153.4808059082835}, "7": {"doc_len": 7125, "attn_time": 457.75491245736544, "mlp_time": 1630.7830810546875, "allgather_time": 19.637346267700195, "allreduce_time": 152.77547078634439}, "8": {"doc_len": 19562, "attn_time": 2562.5023924635566, "mlp_time": 4477.386474609375, "allgather_time": 53.91519546508789, "allreduce_time": 323.0866129032291}, "9": {"doc_len": 9323, "attn_time": 705.7148888257445, "mlp_time": 2133.8653564453125, "allgather_time": 25.695295333862305, "allreduce_time": 186.58734851770646}, "10": {"doc_len": 41353, "attn_time": 10208.905240827718, "mlp_time": 9464.950561523438, "allgather_time": 113.97377967834473, "allreduce_time": 603.1823535044257}, "11": {"doc_len": 18999, "attn_time": 2428.9774294687622, "mlp_time": 4348.5260009765625, "allgather_time": 52.36350059509277, "allreduce_time": 315.55834891481015}, "12": {"doc_len": 81288, "attn_time": 36727.19090862357, "mlp_time": 18605.3466796875, "allgather_time": 224.0393829345703, "allreduce_time": 1107.0675685466078}, "13": {"doc_len": 26799, "attn_time": 4562.237119081084, "mlp_time": 6133.8043212890625, "allgather_time": 73.86122703552246, "allreduce_time": 416.57066903753}, "14": {"doc_len": 14333, "attn_time": 1472.9842717019321, "mlp_time": 3280.5633544921875, "allgather_time": 39.50345039367676, "allreduce_time": 254.29900208492646}, "15": {"doc_len": 74771, "attn_time": 31257.919769494267, "mlp_time": 17113.723754882812, "allgather_time": 206.07775688171387, "allreduce_time": 1025.9948267015664}, "16": {"doc_len": 66335, "attn_time": 24811.027616579744, "mlp_time": 15182.876586914062, "allgather_time": 182.82713890075684, "allreduce_time": 920.0911374716885}, "17": {"doc_len": 19831, "attn_time": 2627.4444460922673, "mlp_time": 4538.9556884765625, "allgather_time": 54.65659141540528, "allreduce_time": 326.66881420420884}, "18": {"doc_len": 15296, "attn_time": 1646.3263559129805, "mlp_time": 3500.9765625, "allgather_time": 42.1575927734375, "allreduce_time": 266.4863482146812}, "19": {"doc_len": 31167, "attn_time": 6016.544490695573, "mlp_time": 7133.5601806640625, "allgather_time": 85.89995384216309, "allreduce_time": 470.57854979376003}, "20": {"doc_len": 7769, "attn_time": 521.9385126890671, "mlp_time": 1778.1829833984375, "allgather_time": 21.41228675842285, "allreduce_time": 163.23850924043458}, "21": {"doc_len": 6741, "attn_time": 420.86987638633957, "mlp_time": 1542.8924560546875, "allgather_time": 18.578996658325195, "allreduce_time": 146.4314794158378}, "22": {"doc_len": 8646, "attn_time": 620.3158090859608, "mlp_time": 1978.912353515625, "allgather_time": 23.829402923583988, "allreduce_time": 176.73094528683725}, "23": {"doc_len": 57831, "attn_time": 19164.126880549884, "mlp_time": 13236.465454101562, "allgather_time": 159.38910484313965, "allreduce_time": 813.8225420191098}, "24": {"doc_len": 39755, "attn_time": 9480.690478277984, "mlp_time": 9099.197387695312, "allgather_time": 109.56950187683107, "allreduce_time": 582.3220640749761}, "25": {"doc_len": 34611, "attn_time": 7308.662033499889, "mlp_time": 7921.8292236328125, "allgather_time": 95.39202690124513, "allreduce_time": 514.5404675442439}, "26": {"doc_len": 61200, "attn_time": 21314.037483627173, "mlp_time": 14007.568359375, "allgather_time": 168.67446899414062, "allreduce_time": 856.0345894352561}, "27": {"doc_len": 18523, "attn_time": 2318.6239354787476, "mlp_time": 4239.5782470703125, "allgather_time": 51.05158805847168, "allreduce_time": 309.1598552503861}, "28": {"doc_len": 35075, "attn_time": 7493.733629727413, "mlp_time": 8028.0303955078125, "allgather_time": 96.67086601257324, "allreduce_time": 520.696575719956}, "29": {"doc_len": 8666, "attn_time": 622.7728661152812, "mlp_time": 1983.489990234375, "allgather_time": 23.884525299072266, "allreduce_time": 177.02515308297293}, "30": {"doc_len": 6624, "attn_time": 409.84270154962945, "mlp_time": 1516.11328125, "allgather_time": 18.25653076171875, "allreduce_time": 144.4818591389492}, "31": {"doc_len": 33237, "attn_time": 6773.339353678316, "mlp_time": 7607.3455810546875, "allgather_time": 91.60511970520021, "allreduce_time": 496.2586549675635}, "32": {"doc_len": 16523, "attn_time": 1880.6017772753858, "mlp_time": 3781.8145751953125, "allgather_time": 45.539350509643555, "allreduce_time": 281.91630016084656}, "33": {"doc_len": 34119, "attn_time": 7114.787533400655, "mlp_time": 7809.2193603515625, "allgather_time": 94.0360164642334, "allreduce_time": 508.00322152934996}, "34": {"doc_len": 66136, "attn_time": 24667.613212279382, "mlp_time": 15137.3291015625, "allgather_time": 182.27867126464844, "allreduce_time": 917.5788527746496}, "35": {"doc_len": 33889, "attn_time": 7024.9913662180315, "mlp_time": 7756.5765380859375, "allgather_time": 93.40210914611816, "allreduce_time": 504.94374186556115}}}, "attnserver_result": {"batch_total_time": 67082.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 3420.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 2, "mlp_cp": 4}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 2, "cp": 8, "dp": 4, "ratio": 0.9833590138674885, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 71390, "worker_latencies_us": [71389, 71390, 71389, 71389], "doc2worker": {"0": 3, "1": 2, "2": 1, "3": 0, "4": 1, "5": 3, "6": 3, "7": 3, "8": 1, "9": 1, "10": 2, "11": 2, "12": 2, "13": 2, "14": 0, "15": 3, "16": 0, "17": 3, "18": 0, "19": 3, "20": 1, "21": 2, "22": 0, "23": 0, "24": 3, "25": 3, "26": 1, "27": 2, "28": 0, "29": 1, "30": 0, "31": 2, "32": 0, "33": 3, "34": 1, "35": 0}, "latency_breakdown": {"max_worker_latency_us": 71390, "worker_latencies_us": [71389, 71390, 71389, 71389], "solver_status": "OPTIMAL", "solved_time_s": 0.9132046699523926, "num_vars": 149, "num_cons": 48}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [3, 14, 16, 18, 22, 23, 28, 30, 32, 35], "total_batch_length": 270990, "total_latency_us": 71389, "mlp_cost_us": 31012.344360351562, "attn_cost_us": 35380.80832623179, "allreduce_cost_us": 4164.21328448678, "allgather_cost_us": 835.7180714607239}, {"worker_id": 1, "assigned_docs": [2, 4, 8, 9, 20, 26, 29, 34], "total_batch_length": 250315, "total_latency_us": 71390, "mlp_cost_us": 28646.278381347656, "attn_cost_us": 38213.42212941418, "allreduce_cost_us": 3761.9266765550506, "allgather_cost_us": 771.9575226306915}, {"worker_id": 2, "assigned_docs": [1, 10, 11, 12, 13, 21, 27, 31], "total_batch_length": 259041, "total_latency_us": 71389, "mlp_cost_us": 29644.88983154297, "attn_cost_us": 37074.376757164966, "allreduce_cost_us": 3876.1604054691597, "allgather_cost_us": 798.868020772934}, {"worker_id": 3, "assigned_docs": [0, 5, 6, 7, 15, 17, 19, 24, 25, 33], "total_batch_length": 268230, "total_latency_us": 71389, "mlp_cost_us": 30696.487426757812, "attn_cost_us": 35768.12930444619, "allreduce_cost_us": 4101.591419979017, "allgather_cost_us": 827.2063851356506}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 3, "attn_time_us": 68.47694141439753, "mlp_time_us": 232.65838623046875, "allgather_time_us": 6.269658803939819, "allreduce_time_us": 69.8856543400674, "total_latency_us": 377}, {"doc_id": 1, "doc_len": 32101, "worker_id": 2, "attn_time_us": 3497.888587787786, "mlp_time_us": 3673.6679077148438, "allgather_time_us": 98.9976966381073, "allreduce_time_us": 481.93147583199897, "total_latency_us": 7752}, {"doc_id": 2, "doc_len": 60107, "worker_id": 1, "attn_time_us": 10641.913343868824, "mlp_time_us": 6878.700256347656, "allgather_time_us": 185.36664128303528, "allreduce_time_us": 842.3676918899671, "total_latency_us": 18548}, {"doc_id": 3, "doc_len": 16438, "worker_id": 0, "attn_time_us": 1110.4624079221142, "mlp_time_us": 1881.1798095703125, "allgather_time_us": 50.69387674331665, "allreduce_time_us": 280.74483252422374, "total_latency_us": 3323}, {"doc_id": 4, "doc_len": 17552, "worker_id": 1, "attn_time_us": 1242.5783393361053, "mlp_time_us": 2008.6669921875, "allgather_time_us": 54.129390716552734, "allreduce_time_us": 296.00791871083493, "total_latency_us": 3601}, {"doc_id": 5, "doc_len": 17650, "worker_id": 3, "attn_time_us": 1254.495728520667, "mlp_time_us": 2019.8822021484375, "allgather_time_us": 54.43161725997925, "allreduce_time_us": 297.3415450962168, "total_latency_us": 3626}, {"doc_id": 6, "doc_len": 7168, "worker_id": 3, "attn_time_us": 313.21859427433105, "mlp_time_us": 820.3125, "allgather_time_us": 22.105712890625, "allreduce_time_us": 153.4808059082835, "total_latency_us": 1309}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 310.6789537751772, "mlp_time_us": 815.3915405273438, "allgather_time_us": 21.973103284835815, "allreduce_time_us": 152.77547078634439, "total_latency_us": 1300}, {"doc_id": 8, "doc_len": 19562, "worker_id": 1, "attn_time_us": 1496.3927179944133, "mlp_time_us": 2238.6932373046875, "allgather_time_us": 60.32811880111694, "allreduce_time_us": 323.0866129032291, "total_latency_us": 4118}, {"doc_id": 9, "doc_len": 9323, "worker_id": 1, "attn_time_us": 458.95555392887417, "mlp_time_us": 1066.9326782226562, "allgather_time_us": 28.751612901687622, "allreduce_time_us": 186.58734851770646, "total_latency_us": 1741}, {"doc_id": 10, "doc_len": 41353, "worker_id": 2, "attn_time_us": 5477.512544570098, "mlp_time_us": 4732.475280761719, "allgather_time_us": 127.53034949302675, "allreduce_time_us": 603.1823535044257, "total_latency_us": 10940}, {"doc_id": 11, "doc_len": 18999, "worker_id": 2, "attn_time_us": 1423.3235663170171, "mlp_time_us": 2174.2630004882812, "allgather_time_us": 58.59185814857483, "allreduce_time_us": 315.55834891481015, "total_latency_us": 3971}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18741.78853722026, "mlp_time_us": 9302.67333984375, "allgather_time_us": 250.68766593933105, "allreduce_time_us": 1107.0675685466078, "total_latency_us": 29402}, {"doc_id": 13, "doc_len": 26799, "worker_id": 2, "attn_time_us": 2566.8645132566126, "mlp_time_us": 3066.9021606445312, "allgather_time_us": 82.64662384986877, "allreduce_time_us": 416.57066903753, "total_latency_us": 6132}, {"doc_id": 14, "doc_len": 14333, "worker_id": 0, "attn_time_us": 896.6273679234284, "mlp_time_us": 1640.2816772460938, "allgather_time_us": 44.202173948287964, "allreduce_time_us": 254.29900208492646, "total_latency_us": 2835}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 15970.78814893323, "mlp_time_us": 8556.861877441406, "allgather_time_us": 230.5896008014679, "allreduce_time_us": 1025.9948267015664, "total_latency_us": 25784}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 12699.56421929799, "mlp_time_us": 7591.438293457031, "allgather_time_us": 204.5734465122223, "allreduce_time_us": 920.0911374716885, "total_latency_us": 21415}, {"doc_id": 17, "doc_len": 19831, "worker_id": 3, "attn_time_us": 1531.8416169917787, "mlp_time_us": 2269.4778442382812, "allgather_time_us": 61.157699823379524, "allreduce_time_us": 326.66881420420884, "total_latency_us": 4189}, {"doc_id": 18, "doc_len": 15296, "worker_id": 0, "attn_time_us": 992.1704939613513, "mlp_time_us": 1750.48828125, "allgather_time_us": 47.17201232910156, "allreduce_time_us": 266.4863482146812, "total_latency_us": 3056}, {"doc_id": 19, "doc_len": 31167, "worker_id": 3, "attn_time_us": 3325.2340815129623, "mlp_time_us": 3566.7800903320312, "allgather_time_us": 96.11729264259338, "allreduce_time_us": 470.57854979376003, "total_latency_us": 7458}, {"doc_id": 20, "doc_len": 7769, "worker_id": 1, "attn_time_us": 349.26891027510334, "mlp_time_us": 889.0914916992188, "allgather_time_us": 23.959163427352905, "allreduce_time_us": 163.23850924043458, "total_latency_us": 1425}, {"doc_id": 21, "doc_len": 6741, "worker_id": 2, "attn_time_us": 288.2415817329631, "mlp_time_us": 771.4462280273438, "allgather_time_us": 20.78886866569519, "allreduce_time_us": 146.4314794158378, "total_latency_us": 1226}, {"doc_id": 22, "doc_len": 8646, "worker_id": 0, "attn_time_us": 408.12177438321106, "mlp_time_us": 989.4561767578125, "allgather_time_us": 26.66378259658814, "allreduce_time_us": 176.73094528683725, "total_latency_us": 1600}, {"doc_id": 23, "doc_len": 57831, "worker_id": 0, "attn_time_us": 9936.83546325788, "mlp_time_us": 6618.232727050781, "allgather_time_us": 178.34758400917053, "allreduce_time_us": 813.8225420191098, "total_latency_us": 17547}, {"doc_id": 24, "doc_len": 39755, "worker_id": 3, "attn_time_us": 5107.267185944924, "mlp_time_us": 4549.598693847656, "allgather_time_us": 122.60220646858217, "allreduce_time_us": 582.3220640749761, "total_latency_us": 10361}, {"doc_id": 25, "doc_len": 34611, "worker_id": 3, "attn_time_us": 3993.1887906428956, "mlp_time_us": 3960.9146118164062, "allgather_time_us": 106.73839688301088, "allreduce_time_us": 514.5404675442439, "total_latency_us": 8575}, {"doc_id": 26, "doc_len": 61200, "worker_id": 1, "attn_time_us": 10987.995661866013, "mlp_time_us": 7003.7841796875, "allgather_time_us": 188.7373924255371, "allreduce_time_us": 856.0345894352561, "total_latency_us": 19036}, {"doc_id": 27, "doc_len": 18523, "worker_id": 2, "attn_time_us": 1362.739300115704, "mlp_time_us": 2119.7891235351562, "allgather_time_us": 57.12390065193176, "allreduce_time_us": 309.1598552503861, "total_latency_us": 3848}, {"doc_id": 28, "doc_len": 35075, "worker_id": 0, "attn_time_us": 4088.7518418242844, "mlp_time_us": 4014.0151977539062, "allgather_time_us": 108.16934704780579, "allreduce_time_us": 520.696575719956, "total_latency_us": 8731}, {"doc_id": 29, "doc_len": 8666, "worker_id": 1, "attn_time_us": 409.5927541340431, "mlp_time_us": 991.7449951171875, "allgather_time_us": 26.72546148300171, "allreduce_time_us": 177.02515308297293, "total_latency_us": 1605}, {"doc_id": 30, "doc_len": 6624, "worker_id": 0, "attn_time_us": 281.493265016299, "mlp_time_us": 758.056640625, "allgather_time_us": 20.42804718017578, "allreduce_time_us": 144.4818591389492, "total_latency_us": 1204}, {"doc_id": 31, "doc_len": 33237, "worker_id": 2, "attn_time_us": 3716.0181261645216, "mlp_time_us": 3803.6727905273438, "allgather_time_us": 102.50105738639833, "allreduce_time_us": 496.2586549675635, "total_latency_us": 8118}, {"doc_id": 32, "doc_len": 16523, "worker_id": 0, "attn_time_us": 1120.3244737674424, "mlp_time_us": 1890.9072875976562, "allgather_time_us": 50.95601201057434, "allreduce_time_us": 281.91630016084656, "total_latency_us": 3344}, {"doc_id": 33, "doc_len": 34119, "worker_id": 3, "attn_time_us": 3892.93926243583, "mlp_time_us": 3904.6096801757812, "allgather_time_us": 105.22109627723694, "allreduce_time_us": 508.00322152934996, "total_latency_us": 8410}, {"doc_id": 34, "doc_len": 66136, "worker_id": 1, "attn_time_us": 12626.724848010808, "mlp_time_us": 7568.66455078125, "allgather_time_us": 203.95974159240723, "allreduce_time_us": 917.5788527746496, "total_latency_us": 21316}, {"doc_id": 35, "doc_len": 33889, "worker_id": 0, "attn_time_us": 3846.4570188777902, "mlp_time_us": 3878.2882690429688, "allgather_time_us": 104.51178908348083, "allreduce_time_us": 504.94374186556115, "total_latency_us": 8334}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 68.47694141439753, "mlp_time": 232.65838623046875, "allgather_time": 6.269658803939819, "allreduce_time": 69.8856543400674}, "1": {"doc_len": 32101, "attn_time": 3497.888587787786, "mlp_time": 3673.6679077148438, "allgather_time": 98.9976966381073, "allreduce_time": 481.93147583199897}, "2": {"doc_len": 60107, "attn_time": 10641.913343868824, "mlp_time": 6878.700256347656, "allgather_time": 185.36664128303528, "allreduce_time": 842.3676918899671}, "3": {"doc_len": 16438, "attn_time": 1110.4624079221142, "mlp_time": 1881.1798095703125, "allgather_time": 50.69387674331665, "allreduce_time": 280.74483252422374}, "4": {"doc_len": 17552, "attn_time": 1242.5783393361053, "mlp_time": 2008.6669921875, "allgather_time": 54.129390716552734, "allreduce_time": 296.00791871083493}, "5": {"doc_len": 17650, "attn_time": 1254.495728520667, "mlp_time": 2019.8822021484375, "allgather_time": 54.43161725997925, "allreduce_time": 297.3415450962168}, "6": {"doc_len": 7168, "attn_time": 313.21859427433105, "mlp_time": 820.3125, "allgather_time": 22.105712890625, "allreduce_time": 153.4808059082835}, "7": {"doc_len": 7125, "attn_time": 310.6789537751772, "mlp_time": 815.3915405273438, "allgather_time": 21.973103284835815, "allreduce_time": 152.77547078634439}, "8": {"doc_len": 19562, "attn_time": 1496.3927179944133, "mlp_time": 2238.6932373046875, "allgather_time": 60.32811880111694, "allreduce_time": 323.0866129032291}, "9": {"doc_len": 9323, "attn_time": 458.95555392887417, "mlp_time": 1066.9326782226562, "allgather_time": 28.751612901687622, "allreduce_time": 186.58734851770646}, "10": {"doc_len": 41353, "attn_time": 5477.512544570098, "mlp_time": 4732.475280761719, "allgather_time": 127.53034949302675, "allreduce_time": 603.1823535044257}, "11": {"doc_len": 18999, "attn_time": 1423.3235663170171, "mlp_time": 2174.2630004882812, "allgather_time": 58.59185814857483, "allreduce_time": 315.55834891481015}, "12": {"doc_len": 81288, "attn_time": 18741.78853722026, "mlp_time": 9302.67333984375, "allgather_time": 250.68766593933105, "allreduce_time": 1107.0675685466078}, "13": {"doc_len": 26799, "attn_time": 2566.8645132566126, "mlp_time": 3066.9021606445312, "allgather_time": 82.64662384986877, "allreduce_time": 416.57066903753}, "14": {"doc_len": 14333, "attn_time": 896.6273679234284, "mlp_time": 1640.2816772460938, "allgather_time": 44.202173948287964, "allreduce_time": 254.29900208492646}, "15": {"doc_len": 74771, "attn_time": 15970.78814893323, "mlp_time": 8556.861877441406, "allgather_time": 230.5896008014679, "allreduce_time": 1025.9948267015664}, "16": {"doc_len": 66335, "attn_time": 12699.56421929799, "mlp_time": 7591.438293457031, "allgather_time": 204.5734465122223, "allreduce_time": 920.0911374716885}, "17": {"doc_len": 19831, "attn_time": 1531.8416169917787, "mlp_time": 2269.4778442382812, "allgather_time": 61.157699823379524, "allreduce_time": 326.66881420420884}, "18": {"doc_len": 15296, "attn_time": 992.1704939613513, "mlp_time": 1750.48828125, "allgather_time": 47.17201232910156, "allreduce_time": 266.4863482146812}, "19": {"doc_len": 31167, "attn_time": 3325.2340815129623, "mlp_time": 3566.7800903320312, "allgather_time": 96.11729264259338, "allreduce_time": 470.57854979376003}, "20": {"doc_len": 7769, "attn_time": 349.26891027510334, "mlp_time": 889.0914916992188, "allgather_time": 23.959163427352905, "allreduce_time": 163.23850924043458}, "21": {"doc_len": 6741, "attn_time": 288.2415817329631, "mlp_time": 771.4462280273438, "allgather_time": 20.78886866569519, "allreduce_time": 146.4314794158378}, "22": {"doc_len": 8646, "attn_time": 408.12177438321106, "mlp_time": 989.4561767578125, "allgather_time": 26.66378259658814, "allreduce_time": 176.73094528683725}, "23": {"doc_len": 57831, "attn_time": 9936.83546325788, "mlp_time": 6618.232727050781, "allgather_time": 178.34758400917053, "allreduce_time": 813.8225420191098}, "24": {"doc_len": 39755, "attn_time": 5107.267185944924, "mlp_time": 4549.598693847656, "allgather_time": 122.60220646858217, "allreduce_time": 582.3220640749761}, "25": {"doc_len": 34611, "attn_time": 3993.1887906428956, "mlp_time": 3960.9146118164062, "allgather_time": 106.73839688301088, "allreduce_time": 514.5404675442439}, "26": {"doc_len": 61200, "attn_time": 10987.995661866013, "mlp_time": 7003.7841796875, "allgather_time": 188.7373924255371, "allreduce_time": 856.0345894352561}, "27": {"doc_len": 18523, "attn_time": 1362.739300115704, "mlp_time": 2119.7891235351562, "allgather_time": 57.12390065193176, "allreduce_time": 309.1598552503861}, "28": {"doc_len": 35075, "attn_time": 4088.7518418242844, "mlp_time": 4014.0151977539062, "allgather_time": 108.16934704780579, "allreduce_time": 520.696575719956}, "29": {"doc_len": 8666, "attn_time": 409.5927541340431, "mlp_time": 991.7449951171875, "allgather_time": 26.72546148300171, "allreduce_time": 177.02515308297293}, "30": {"doc_len": 6624, "attn_time": 281.493265016299, "mlp_time": 758.056640625, "allgather_time": 20.42804718017578, "allreduce_time": 144.4818591389492}, "31": {"doc_len": 33237, "attn_time": 3716.0181261645216, "mlp_time": 3803.6727905273438, "allgather_time": 102.50105738639833, "allreduce_time": 496.2586549675635}, "32": {"doc_len": 16523, "attn_time": 1120.3244737674424, "mlp_time": 1890.9072875976562, "allgather_time": 50.95601201057434, "allreduce_time": 281.91630016084656}, "33": {"doc_len": 34119, "attn_time": 3892.93926243583, "mlp_time": 3904.6096801757812, "allgather_time": 105.22109627723694, "allreduce_time": 508.00322152934996}, "34": {"doc_len": 66136, "attn_time": 12626.724848010808, "mlp_time": 7568.66455078125, "allgather_time": 203.95974159240723, "allreduce_time": 917.5788527746496}, "35": {"doc_len": 33889, "attn_time": 3846.4570188777902, "mlp_time": 3878.2882690429688, "allgather_time": 104.51178908348083, "allreduce_time": 504.94374186556115}}}, "attnserver_result": {"batch_total_time": 70202.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 6540.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 2, "mlp_cp": 8}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 1, "dp": 16, "ratio": 0.5748305615046315, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 113463, "worker_latencies_us": [98568, 13831, 43414, 113463, 36475, 80824, 0, 99834, 74446, 37202, 85942, 0, 44661, 108463, 107443, 82610], "doc2worker": {"0": 15, "1": 15, "2": 14, "3": 12, "4": 13, "5": 14, "6": 9, "7": 13, "8": 14, "9": 10, "10": 13, "11": 12, "12": 3, "13": 12, "14": 14, "15": 0, "16": 5, "17": 1, "18": 2, "19": 15, "20": 8, "21": 14, "22": 9, "23": 8, "24": 4, "25": 2, "26": 7, "27": 13, "28": 13, "29": 8, "30": 2, "31": 9, "32": 13, "33": 15, "34": 10, "35": 7}, "latency_breakdown": {"max_worker_latency_us": 113463, "worker_latencies_us": [98568, 13831, 43414, 113463, 36475, 80824, 0, 99834, 74446, 37202, 85942, 0, 44661, 108463, 107443, 82610], "solver_status": "OPTIMAL", "solved_time_s": 0.026325464248657227, "num_vars": 593, "num_cons": 84}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [15], "total_batch_length": 74771, "total_latency_us": 98568, "mlp_cost_us": 34227.447509765625, "attn_cost_us": 63481.545490346834, "allreduce_cost_us": 859.5839231858736, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [17], "total_batch_length": 19831, "total_latency_us": 13831, "mlp_cost_us": 9077.911376953125, "attn_cost_us": 4511.937356817677, "allreduce_cost_us": 241.73076546882646, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [18, 25, 30], "total_batch_length": 56531, "total_latency_us": 43414, "mlp_cost_us": 25877.838134765625, "attn_cost_us": 16794.174230141096, "allreduce_cost_us": 743.562495095896, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [12], "total_batch_length": 81288, "total_latency_us": 113463, "mlp_cost_us": 37210.693359375, "attn_cost_us": 75339.00051993325, "allreduce_cost_us": 914.1872507847287, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [24], "total_batch_length": 39755, "total_latency_us": 36475, "mlp_cost_us": 18198.394775390625, "attn_cost_us": 17839.67949243101, "allreduce_cost_us": 437.63777117875514, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [16], "total_batch_length": 66335, "total_latency_us": 80824, "mlp_cost_us": 30365.753173828125, "attn_cost_us": 49671.61847726627, "allreduce_cost_us": 786.9970552170928, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [26, 35], "total_batch_length": 95089, "total_latency_us": 99834, "mlp_cost_us": 43528.289794921875, "attn_cost_us": 55222.83382118231, "allreduce_cost_us": 1084.5303424854203, "allgather_cost_us": 0}, {"worker_id": 8, "assigned_docs": [20, 23, 29], "total_batch_length": 74266, "total_latency_us": 74446, "mlp_cost_us": 33996.27685546875, "attn_cost_us": 39385.67395210521, "allreduce_cost_us": 1065.4528104512146, "allgather_cost_us": 0}, {"worker_id": 9, "assigned_docs": [6, 22, 31], "total_batch_length": 49051, "total_latency_us": 37202, "mlp_cost_us": 22453.765869140625, "attn_cost_us": 14018.05532840161, "allreduce_cost_us": 731.5587634574567, "allgather_cost_us": 0}, {"worker_id": 10, "assigned_docs": [9, 34], "total_batch_length": 75459, "total_latency_us": 85942, "mlp_cost_us": 34542.388916015625, "attn_cost_us": 50413.33098177342, "allreduce_cost_us": 987.0853939924077, "allgather_cost_us": 0}, {"worker_id": 11, "assigned_docs": [], "total_batch_length": 0, "total_latency_us": 0, "mlp_cost_us": 0, "attn_cost_us": 0, "allreduce_cost_us": 0, "allgather_cost_us": 0}, {"worker_id": 12, "assigned_docs": [3, 11, 13], "total_batch_length": 62236, "total_latency_us": 44661, "mlp_cost_us": 28489.3798828125, "attn_cost_us": 15426.40555708063, "allreduce_cost_us": 746.5166448649643, "allgather_cost_us": 0}, {"worker_id": 13, "assigned_docs": [4, 7, 10, 27, 28, 32], "total_batch_length": 136151, "total_latency_us": 108463, "mlp_cost_us": 62324.981689453125, "attn_cost_us": 44468.31750747496, "allreduce_cost_us": 1672.7505222727561, "allgather_cost_us": 0}, {"worker_id": 14, "assigned_docs": [2, 5, 8, 14, 21], "total_batch_length": 118393, "total_latency_us": 107443, "mlp_cost_us": 54196.014404296875, "attn_cost_us": 51710.531839444644, "allreduce_cost_us": 1539.5502653840936, "allgather_cost_us": 0}, {"worker_id": 15, "assigned_docs": [0, 1, 19, 33], "total_batch_length": 99420, "total_latency_us": 82610, "mlp_cost_us": 45510.8642578125, "attn_cost_us": 35843.45643534242, "allreduce_cost_us": 1258.1816335705334, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 15, "attn_time_us": 74.89683671797832, "mlp_time_us": 930.633544921875, "allgather_time_us": 0, "allreduce_time_us": 209.3952339467502, "total_latency_us": 1214}, {"doc_id": 1, "doc_len": 32101, "worker_id": 15, "attn_time_us": 11641.77106617797, "mlp_time_us": 14694.671630859375, "allgather_time_us": 0, "allreduce_time_us": 344.7354374636814, "total_latency_us": 26681}, {"doc_id": 2, "doc_len": 60107, "worker_id": 14, "attn_time_us": 40761.99610086713, "mlp_time_us": 27514.801025390625, "allgather_time_us": 0, "allreduce_time_us": 705.7919276489633, "total_latency_us": 68982}, {"doc_id": 3, "doc_len": 16438, "worker_id": 12, "attn_time_us": 3118.738747447154, "mlp_time_us": 7524.71923828125, "allgather_time_us": 0, "allreduce_time_us": 210.50986158974175, "total_latency_us": 10853}, {"doc_id": 4, "doc_len": 17552, "worker_id": 13, "attn_time_us": 3548.3234934425295, "mlp_time_us": 8034.66796875, "allgather_time_us": 0, "allreduce_time_us": 220.93243657827904, "total_latency_us": 11803}, {"doc_id": 5, "doc_len": 17650, "worker_id": 14, "attn_time_us": 3587.4185193169214, "mlp_time_us": 8079.52880859375, "allgather_time_us": 0, "allreduce_time_us": 221.8408590788859, "total_latency_us": 11888}, {"doc_id": 6, "doc_len": 7168, "worker_id": 9, "attn_time_us": 640.9407394587936, "mlp_time_us": 3281.25, "allgather_time_us": 0, "allreduce_time_us": 175.0, "total_latency_us": 4097}, {"doc_id": 7, "doc_len": 7125, "worker_id": 13, "attn_time_us": 634.0071205014534, "mlp_time_us": 3261.566162109375, "allgather_time_us": 0, "allreduce_time_us": 173.95019531249994, "total_latency_us": 4069}, {"doc_id": 8, "doc_len": 19562, "worker_id": 14, "attn_time_us": 4392.280807743863, "mlp_time_us": 8954.77294921875, "allgather_time_us": 0, "allreduce_time_us": 239.3099296338815, "total_latency_us": 13586}, {"doc_id": 9, "doc_len": 9323, "worker_id": 10, "attn_time_us": 1046.5865107690865, "mlp_time_us": 4267.730712890625, "allgather_time_us": 0, "allreduce_time_us": 201.82895165747394, "total_latency_us": 5516}, {"doc_id": 10, "doc_len": 41353, "worker_id": 13, "attn_time_us": 19301.83863738121, "mlp_time_us": 18929.901123046875, "allgather_time_us": 0, "allreduce_time_us": 458.03860413137375, "total_latency_us": 38689}, {"doc_id": 11, "doc_len": 18999, "worker_id": 12, "attn_time_us": 4146.969234525931, "mlp_time_us": 8697.052001953125, "allgather_time_us": 0, "allreduce_time_us": 234.2146973176681, "total_latency_us": 13078}, {"doc_id": 12, "doc_len": 81288, "worker_id": 3, "attn_time_us": 75339.00051993325, "mlp_time_us": 37210.693359375, "allgather_time_us": 0, "allreduce_time_us": 914.1872507847287, "total_latency_us": 113463}, {"doc_id": 13, "doc_len": 26799, "worker_id": 12, "attn_time_us": 8160.697575107546, "mlp_time_us": 12267.608642578125, "allgather_time_us": 0, "allreduce_time_us": 301.7920859575545, "total_latency_us": 20730}, {"doc_id": 14, "doc_len": 14333, "worker_id": 14, "attn_time_us": 2395.2485067132698, "mlp_time_us": 6561.126708984375, "allgather_time_us": 0, "allreduce_time_us": 208.03235370986292, "total_latency_us": 9164}, {"doc_id": 15, "doc_len": 74771, "worker_id": 0, "attn_time_us": 63481.545490346834, "mlp_time_us": 34227.447509765625, "allgather_time_us": 0, "allreduce_time_us": 859.5839231858736, "total_latency_us": 98568}, {"doc_id": 16, "doc_len": 66335, "worker_id": 5, "attn_time_us": 49671.61847726627, "mlp_time_us": 30365.753173828125, "allgather_time_us": 0, "allreduce_time_us": 786.9970552170928, "total_latency_us": 80824}, {"doc_id": 17, "doc_len": 19831, "worker_id": 1, "attn_time_us": 4511.937356817677, "mlp_time_us": 9077.911376953125, "allgather_time_us": 0, "allreduce_time_us": 241.73076546882646, "total_latency_us": 13831}, {"doc_id": 18, "doc_len": 15296, "worker_id": 2, "attn_time_us": 2714.671454696122, "mlp_time_us": 7001.953125, "allgather_time_us": 0, "allreduce_time_us": 208.98674021487867, "total_latency_us": 9925}, {"doc_id": 19, "doc_len": 31167, "worker_id": 15, "attn_time_us": 10984.547855934177, "mlp_time_us": 14267.120361328125, "allgather_time_us": 0, "allreduce_time_us": 337.31480763455045, "total_latency_us": 25588}, {"doc_id": 20, "doc_len": 7769, "worker_id": 8, "attn_time_us": 741.3577249995108, "mlp_time_us": 3556.365966796875, "allgather_time_us": 0, "allreduce_time_us": 189.67285156250006, "total_latency_us": 4487}, {"doc_id": 21, "doc_len": 6741, "worker_id": 14, "attn_time_us": 573.5879048034607, "mlp_time_us": 3085.784912109375, "allgather_time_us": 0, "allreduce_time_us": 164.57519531250003, "total_latency_us": 3823}, {"doc_id": 22, "doc_len": 8646, "worker_id": 9, "attn_time_us": 905.20311871462, "mlp_time_us": 3957.82470703125, "allgather_time_us": 0, "allreduce_time_us": 200.76078534755501, "total_latency_us": 5063}, {"doc_id": 23, "doc_len": 57831, "worker_id": 8, "attn_time_us": 37735.07775490734, "mlp_time_us": 26472.930908203125, "allgather_time_us": 0, "allreduce_time_us": 674.9865197235906, "total_latency_us": 64882}, {"doc_id": 24, "doc_len": 39755, "worker_id": 4, "attn_time_us": 17839.67949243101, "mlp_time_us": 18198.394775390625, "allgather_time_us": 0, "allreduce_time_us": 437.63777117875514, "total_latency_us": 36475}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 13523.785041017252, "mlp_time_us": 15843.658447265625, "allgather_time_us": 0, "allreduce_time_us": 372.8570048810173, "total_latency_us": 29740}, {"doc_id": 26, "doc_len": 61200, "worker_id": 7, "attn_time_us": 42257.08574510789, "mlp_time_us": 28015.13671875, "allgather_time_us": 0, "allreduce_time_us": 720.6508499671811, "total_latency_us": 70992}, {"doc_id": 27, "doc_len": 18523, "worker_id": 13, "attn_time_us": 3944.97735826725, "mlp_time_us": 8479.156494140625, "allgather_time_us": 0, "allreduce_time_us": 229.87577887079104, "total_latency_us": 12654}, {"doc_id": 28, "doc_len": 35075, "worker_id": 13, "attn_time_us": 13888.614997662677, "mlp_time_us": 16056.060791015625, "allgather_time_us": 0, "allreduce_time_us": 378.6419773265417, "total_latency_us": 30323}, {"doc_id": 29, "doc_len": 8666, "worker_id": 8, "attn_time_us": 909.2384721983537, "mlp_time_us": 3966.97998046875, "allgather_time_us": 0, "allreduce_time_us": 200.79343916512403, "total_latency_us": 5077}, {"doc_id": 30, "doc_len": 6624, "worker_id": 2, "attn_time_us": 555.7177344277227, "mlp_time_us": 3032.2265625, "allgather_time_us": 0, "allreduce_time_us": 161.71875, "total_latency_us": 3749}, {"doc_id": 31, "doc_len": 33237, "worker_id": 9, "attn_time_us": 12471.911470228197, "mlp_time_us": 15214.691162109375, "allgather_time_us": 0, "allreduce_time_us": 355.79797810990163, "total_latency_us": 28042}, {"doc_id": 32, "doc_len": 16523, "worker_id": 13, "attn_time_us": 3150.555900219846, "mlp_time_us": 7563.629150390625, "allgather_time_us": 0, "allreduce_time_us": 211.31153005327067, "total_latency_us": 10925}, {"doc_id": 33, "doc_len": 34119, "worker_id": 15, "attn_time_us": 13142.240676512296, "mlp_time_us": 15618.438720703125, "allgather_time_us": 0, "allreduce_time_us": 366.7361545255514, "total_latency_us": 29127}, {"doc_id": 34, "doc_len": 66136, "worker_id": 10, "attn_time_us": 49366.744471004335, "mlp_time_us": 30274.658203125, "allgather_time_us": 0, "allreduce_time_us": 785.2564423349338, "total_latency_us": 80426}, {"doc_id": 35, "doc_len": 33889, "worker_id": 7, "attn_time_us": 12965.748076074415, "mlp_time_us": 15513.153076171875, "allgather_time_us": 0, "allreduce_time_us": 363.87949251823926, "total_latency_us": 28842}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 74.89683671797832, "mlp_time": 930.633544921875, "allgather_time": 0, "allreduce_time": 209.3952339467502}, "1": {"doc_len": 32101, "attn_time": 11641.77106617797, "mlp_time": 14694.671630859375, "allgather_time": 0, "allreduce_time": 344.7354374636814}, "2": {"doc_len": 60107, "attn_time": 40761.99610086713, "mlp_time": 27514.801025390625, "allgather_time": 0, "allreduce_time": 705.7919276489633}, "3": {"doc_len": 16438, "attn_time": 3118.738747447154, "mlp_time": 7524.71923828125, "allgather_time": 0, "allreduce_time": 210.50986158974175}, "4": {"doc_len": 17552, "attn_time": 3548.3234934425295, "mlp_time": 8034.66796875, "allgather_time": 0, "allreduce_time": 220.93243657827904}, "5": {"doc_len": 17650, "attn_time": 3587.4185193169214, "mlp_time": 8079.52880859375, "allgather_time": 0, "allreduce_time": 221.8408590788859}, "6": {"doc_len": 7168, "attn_time": 640.9407394587936, "mlp_time": 3281.25, "allgather_time": 0, "allreduce_time": 175.0}, "7": {"doc_len": 7125, "attn_time": 634.0071205014534, "mlp_time": 3261.566162109375, "allgather_time": 0, "allreduce_time": 173.95019531249994}, "8": {"doc_len": 19562, "attn_time": 4392.280807743863, "mlp_time": 8954.77294921875, "allgather_time": 0, "allreduce_time": 239.3099296338815}, "9": {"doc_len": 9323, "attn_time": 1046.5865107690865, "mlp_time": 4267.730712890625, "allgather_time": 0, "allreduce_time": 201.82895165747394}, "10": {"doc_len": 41353, "attn_time": 19301.83863738121, "mlp_time": 18929.901123046875, "allgather_time": 0, "allreduce_time": 458.03860413137375}, "11": {"doc_len": 18999, "attn_time": 4146.969234525931, "mlp_time": 8697.052001953125, "allgather_time": 0, "allreduce_time": 234.2146973176681}, "12": {"doc_len": 81288, "attn_time": 75339.00051993325, "mlp_time": 37210.693359375, "allgather_time": 0, "allreduce_time": 914.1872507847287}, "13": {"doc_len": 26799, "attn_time": 8160.697575107546, "mlp_time": 12267.608642578125, "allgather_time": 0, "allreduce_time": 301.7920859575545}, "14": {"doc_len": 14333, "attn_time": 2395.2485067132698, "mlp_time": 6561.126708984375, "allgather_time": 0, "allreduce_time": 208.03235370986292}, "15": {"doc_len": 74771, "attn_time": 63481.545490346834, "mlp_time": 34227.447509765625, "allgather_time": 0, "allreduce_time": 859.5839231858736}, "16": {"doc_len": 66335, "attn_time": 49671.61847726627, "mlp_time": 30365.753173828125, "allgather_time": 0, "allreduce_time": 786.9970552170928}, "17": {"doc_len": 19831, "attn_time": 4511.937356817677, "mlp_time": 9077.911376953125, "allgather_time": 0, "allreduce_time": 241.73076546882646}, "18": {"doc_len": 15296, "attn_time": 2714.671454696122, "mlp_time": 7001.953125, "allgather_time": 0, "allreduce_time": 208.98674021487867}, "19": {"doc_len": 31167, "attn_time": 10984.547855934177, "mlp_time": 14267.120361328125, "allgather_time": 0, "allreduce_time": 337.31480763455045}, "20": {"doc_len": 7769, "attn_time": 741.3577249995108, "mlp_time": 3556.365966796875, "allgather_time": 0, "allreduce_time": 189.67285156250006}, "21": {"doc_len": 6741, "attn_time": 573.5879048034607, "mlp_time": 3085.784912109375, "allgather_time": 0, "allreduce_time": 164.57519531250003}, "22": {"doc_len": 8646, "attn_time": 905.20311871462, "mlp_time": 3957.82470703125, "allgather_time": 0, "allreduce_time": 200.76078534755501}, "23": {"doc_len": 57831, "attn_time": 37735.07775490734, "mlp_time": 26472.930908203125, "allgather_time": 0, "allreduce_time": 674.9865197235906}, "24": {"doc_len": 39755, "attn_time": 17839.67949243101, "mlp_time": 18198.394775390625, "allgather_time": 0, "allreduce_time": 437.63777117875514}, "25": {"doc_len": 34611, "attn_time": 13523.785041017252, "mlp_time": 15843.658447265625, "allgather_time": 0, "allreduce_time": 372.8570048810173}, "26": {"doc_len": 61200, "attn_time": 42257.08574510789, "mlp_time": 28015.13671875, "allgather_time": 0, "allreduce_time": 720.6508499671811}, "27": {"doc_len": 18523, "attn_time": 3944.97735826725, "mlp_time": 8479.156494140625, "allgather_time": 0, "allreduce_time": 229.87577887079104}, "28": {"doc_len": 35075, "attn_time": 13888.614997662677, "mlp_time": 16056.060791015625, "allgather_time": 0, "allreduce_time": 378.6419773265417}, "29": {"doc_len": 8666, "attn_time": 909.2384721983537, "mlp_time": 3966.97998046875, "allgather_time": 0, "allreduce_time": 200.79343916512403}, "30": {"doc_len": 6624, "attn_time": 555.7177344277227, "mlp_time": 3032.2265625, "allgather_time": 0, "allreduce_time": 161.71875}, "31": {"doc_len": 33237, "attn_time": 12471.911470228197, "mlp_time": 15214.691162109375, "allgather_time": 0, "allreduce_time": 355.79797810990163}, "32": {"doc_len": 16523, "attn_time": 3150.555900219846, "mlp_time": 7563.629150390625, "allgather_time": 0, "allreduce_time": 211.31153005327067}, "33": {"doc_len": 34119, "attn_time": 13142.240676512296, "mlp_time": 15618.438720703125, "allgather_time": 0, "allreduce_time": 366.7361545255514}, "34": {"doc_len": 66136, "attn_time": 49366.744471004335, "mlp_time": 30274.658203125, "allgather_time": 0, "allreduce_time": 785.2564423349338}, "35": {"doc_len": 33889, "attn_time": 12965.748076074415, "mlp_time": 15513.153076171875, "allgather_time": 0, "allreduce_time": 363.87949251823926}}}, "attnserver_result": {"batch_total_time": 65222.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 1560.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 4, "mlp_cp": 1}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 2, "dp": 8, "ratio": 1.0126075461894646, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 65437, "worker_latencies_us": [65435, 65434, 65434, 65410, 65426, 65404, 65436, 65437], "doc2worker": {"0": 7, "1": 7, "2": 5, "3": 4, "4": 6, "5": 2, "6": 3, "7": 1, "8": 3, "9": 6, "10": 5, "11": 1, "12": 3, "13": 5, "14": 0, "15": 1, "16": 6, "17": 1, "18": 2, "19": 0, "20": 7, "21": 0, "22": 4, "23": 2, "24": 7, "25": 2, "26": 4, "27": 4, "28": 6, "29": 0, "30": 0, "31": 4, "32": 2, "33": 7, "34": 0, "35": 7}, "latency_breakdown": {"max_worker_latency_us": 65437, "worker_latencies_us": [65435, 65434, 65434, 65410, 65426, 65404, 65436, 65437], "solver_status": "FEASIBLE", "solved_time_s": 360.07482147216797, "num_vars": 297, "num_cons": 60}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [14, 19, 21, 29, 30, 34], "total_batch_length": 133667, "total_latency_us": 65435, "mlp_cost_us": 30593.948364257812, "attn_cost_us": 32820.036684798295, "allreduce_cost_us": 1857.6909881569711, "allgather_cost_us": 165.23918986320496}, {"worker_id": 1, "assigned_docs": [7, 11, 15, 17], "total_batch_length": 120726, "total_latency_us": 65434, "mlp_cost_us": 27631.988525390625, "attn_cost_us": 36144.57193216574, "allreduce_cost_us": 1509.4795812848683, "allgather_cost_us": 149.24152135848996}, {"worker_id": 2, "assigned_docs": [5, 18, 23, 25, 32], "total_batch_length": 141911, "total_latency_us": 65434, "mlp_cost_us": 32480.850219726562, "attn_cost_us": 31090.373057282202, "allreduce_cost_us": 1689.982653951643, "allgather_cost_us": 175.43042540550232}, {"worker_id": 3, "assigned_docs": [6, 8, 12], "total_batch_length": 108018, "total_latency_us": 65410, "mlp_cost_us": 24723.358154296875, "attn_cost_us": 39226.33692021761, "allreduce_cost_us": 1328.4971804186102, "allgather_cost_us": 133.5318875312805}, {"worker_id": 4, "assigned_docs": [3, 22, 26, 27, 31], "total_batch_length": 138044, "total_latency_us": 65426, "mlp_cost_us": 31595.76416015625, "attn_cost_us": 31944.242282693594, "allreduce_cost_us": 1717.5952538851705, "allgather_cost_us": 170.65003871917725}, {"worker_id": 5, "assigned_docs": [2, 10, 13], "total_batch_length": 128259, "total_latency_us": 65404, "mlp_cost_us": 29356.155395507812, "attn_cost_us": 34425.28601140489, "allreduce_cost_us": 1465.6226177378915, "allgather_cost_us": 158.55381846427917}, {"worker_id": 6, "assigned_docs": [4, 9, 16, 28], "total_batch_length": 128285, "total_latency_us": 65436, "mlp_cost_us": 29362.106323242188, "attn_cost_us": 34327.38652026105, "allreduce_cost_us": 1588.4004207793873, "allgather_cost_us": 158.58595967292786}, {"worker_id": 7, "assigned_docs": [0, 1, 20, 24, 33, 35], "total_batch_length": 149666, "total_latency_us": 65437, "mlp_cost_us": 34255.828857421875, "attn_cost_us": 29088.383223688295, "allreduce_cost_us": 1912.0569411954775, "allgather_cost_us": 185.01715898513794}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 66.74058315298734, "mlp_time_us": 465.3167724609375, "allgather_time_us": 2.513195276260376, "allreduce_time_us": 209.3952339467502, "total_latency_us": 743}, {"doc_id": 1, "doc_len": 32101, "worker_id": 7, "attn_time_us": 6018.169632465242, "mlp_time_us": 7347.3358154296875, "allgather_time_us": 39.68326687812805, "allreduce_time_us": 344.7354374636814, "total_latency_us": 13749}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985, "mlp_time_us": 13757.400512695312, "allgather_time_us": 74.30429339408875, "allreduce_time_us": 705.7919276489633, "total_latency_us": 34828}, {"doc_id": 3, "doc_len": 16438, "worker_id": 4, "attn_time_us": 1752.9741557180173, "mlp_time_us": 3762.359619140625, "allgather_time_us": 20.320661067962646, "allreduce_time_us": 210.50986158974175, "total_latency_us": 5746}, {"doc_id": 4, "doc_len": 17552, "worker_id": 6, "attn_time_us": 1978.1458543317867, "mlp_time_us": 4017.333984375, "allgather_time_us": 21.69778823852539, "allreduce_time_us": 220.93243657827904, "total_latency_us": 6238}, {"doc_id": 5, "doc_len": 17650, "worker_id": 2, "attn_time_us": 1998.548728522027, "mlp_time_us": 4039.764404296875, "allgather_time_us": 21.818935871124268, "allreduce_time_us": 221.8408590788859, "total_latency_us": 6281}, {"doc_id": 6, "doc_len": 7168, "worker_id": 3, "attn_time_us": 417.4589652242031, "mlp_time_us": 1640.625, "allgather_time_us": 8.861083984374998, "allreduce_time_us": 175.0, "total_latency_us": 2241}, {"doc_id": 7, "doc_len": 7125, "worker_id": 1, "attn_time_us": 413.4748019047083, "mlp_time_us": 1630.7830810546875, "allgather_time_us": 8.807927370071411, "allreduce_time_us": 173.95019531249994, "total_latency_us": 2227}, {"doc_id": 8, "doc_len": 19562, "worker_id": 3, "attn_time_us": 2415.664093795966, "mlp_time_us": 4477.386474609375, "allgather_time_us": 24.182550907135006, "allreduce_time_us": 239.3099296338815, "total_latency_us": 7156}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 647.9962960708053, "mlp_time_us": 2133.8653564453125, "allgather_time_us": 11.525095701217651, "allreduce_time_us": 201.82895165747394, "total_latency_us": 2995}, {"doc_id": 10, "doc_len": 41353, "worker_id": 5, "attn_time_us": 9819.030371928073, "mlp_time_us": 9464.950561523438, "allgather_time_us": 51.12059235572815, "allreduce_time_us": 458.03860413137375, "total_latency_us": 19793}, {"doc_id": 11, "doc_len": 18999, "worker_id": 1, "attn_time_us": 2289.0924612727576, "mlp_time_us": 4348.5260009765625, "allgather_time_us": 23.486570119857785, "allreduce_time_us": 234.2146973176681, "total_latency_us": 6895}, {"doc_id": 12, "doc_len": 81288, "worker_id": 3, "attn_time_us": 36393.213861197444, "mlp_time_us": 18605.3466796875, "allgather_time_us": 100.4882526397705, "allreduce_time_us": 914.1872507847287, "total_latency_us": 56013}, {"doc_id": 13, "doc_len": 26799, "worker_id": 5, "attn_time_us": 4314.965790577829, "mlp_time_us": 6133.8043212890625, "allgather_time_us": 33.12893271446228, "allreduce_time_us": 301.7920859575545, "total_latency_us": 10783}, {"doc_id": 14, "doc_len": 14333, "worker_id": 0, "attn_time_us": 1377.9904372414553, "mlp_time_us": 3280.5633544921875, "allgather_time_us": 17.718459367752075, "allreduce_time_us": 208.03235370986292, "total_latency_us": 4884}, {"doc_id": 15, "doc_len": 74771, "worker_id": 1, "attn_time_us": 30964.76667866259, "mlp_time_us": 17113.723754882812, "allgather_time_us": 92.43193507194518, "allreduce_time_us": 859.5839231858736, "total_latency_us": 49030}, {"doc_id": 16, "doc_len": 66335, "worker_id": 6, "attn_time_us": 24568.208511425775, "mlp_time_us": 15182.876586914062, "allgather_time_us": 82.00334906578064, "allreduce_time_us": 786.9970552170928, "total_latency_us": 40620}, {"doc_id": 17, "doc_len": 19831, "worker_id": 1, "attn_time_us": 2477.2379903256806, "mlp_time_us": 4538.9556884765625, "allgather_time_us": 24.515088796615597, "allreduce_time_us": 241.73076546882646, "total_latency_us": 7282}, {"doc_id": 18, "doc_len": 15296, "worker_id": 2, "attn_time_us": 1544.505479725131, "mlp_time_us": 3500.9765625, "allgather_time_us": 18.908920288085938, "allreduce_time_us": 208.98674021487867, "total_latency_us": 5273}, {"doc_id": 19, "doc_len": 31167, "worker_id": 0, "attn_time_us": 5699.427983123611, "mlp_time_us": 7133.5601806640625, "allgather_time_us": 38.528655767440796, "allreduce_time_us": 337.31480763455045, "total_latency_us": 13208}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 474.61734728098975, "mlp_time_us": 1778.1829833984375, "allgather_time_us": 9.604040384292603, "allreduce_time_us": 189.67285156250006, "total_latency_us": 2452}, {"doc_id": 21, "doc_len": 6741, "worker_id": 0, "attn_time_us": 378.5313895297653, "mlp_time_us": 1542.8924560546875, "allgather_time_us": 8.333226442337036, "allreduce_time_us": 164.57519531250003, "total_latency_us": 2094}, {"doc_id": 22, "doc_len": 8646, "worker_id": 4, "attn_time_us": 567.721594253597, "mlp_time_us": 1978.912353515625, "allgather_time_us": 10.688188076019285, "allreduce_time_us": 200.76078534755501, "total_latency_us": 2758}, {"doc_id": 23, "doc_len": 57831, "worker_id": 2, "attn_time_us": 18826.57526833159, "mlp_time_us": 13236.465454101562, "allgather_time_us": 71.49070143699646, "allreduce_time_us": 674.9865197235906, "total_latency_us": 32809}, {"doc_id": 24, "doc_len": 39755, "worker_id": 7, "attn_time_us": 9095.973319396755, "mlp_time_us": 9099.197387695312, "allgather_time_us": 49.14514422416687, "allreduce_time_us": 437.63777117875514, "total_latency_us": 18681}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 6951.0275631771965, "mlp_time_us": 7921.8292236328125, "allgather_time_us": 42.786129713058465, "allreduce_time_us": 372.8570048810173, "total_latency_us": 15288}, {"doc_id": 26, "doc_len": 61200, "worker_id": 4, "attn_time_us": 21013.579779816293, "mlp_time_us": 14007.568359375, "allgather_time_us": 75.65546035766602, "allreduce_time_us": 720.6508499671811, "total_latency_us": 35817}, {"doc_id": 27, "doc_len": 18523, "worker_id": 4, "attn_time_us": 2184.5154727407735, "mlp_time_us": 4239.5782470703125, "allgather_time_us": 22.898138761520382, "allreduce_time_us": 229.87577887079104, "total_latency_us": 6676}, {"doc_id": 28, "doc_len": 35075, "worker_id": 6, "attn_time_us": 7133.035858432675, "mlp_time_us": 8028.0303955078125, "allgather_time_us": 43.359726667404175, "allreduce_time_us": 378.6419773265417, "total_latency_us": 15583}, {"doc_id": 29, "doc_len": 8666, "worker_id": 0, "attn_time_us": 570.0274744180244, "mlp_time_us": 1983.489990234375, "allgather_time_us": 10.71291208267212, "allreduce_time_us": 200.79343916512403, "total_latency_us": 2765}, {"doc_id": 30, "doc_len": 6624, "worker_id": 0, "attn_time_us": 368.1144026980197, "mlp_time_us": 1516.11328125, "allgather_time_us": 8.188591003417967, "allreduce_time_us": 161.71875, "total_latency_us": 2054}, {"doc_id": 31, "doc_len": 33237, "worker_id": 4, "attn_time_us": 6425.451280164909, "mlp_time_us": 7607.3455810546875, "allgather_time_us": 41.08759045600891, "allreduce_time_us": 355.79797810990163, "total_latency_us": 14429}, {"doc_id": 32, "doc_len": 16523, "worker_id": 2, "attn_time_us": 1769.7160175262527, "mlp_time_us": 3781.8145751953125, "allgather_time_us": 20.42573809623718, "allreduce_time_us": 211.31153005327067, "total_latency_us": 5783}, {"doc_id": 33, "doc_len": 34119, "worker_id": 7, "attn_time_us": 6760.528215829564, "mlp_time_us": 7809.2193603515625, "allgather_time_us": 42.1779191493988, "allreduce_time_us": 366.7361545255514, "total_latency_us": 14978}, {"doc_id": 34, "doc_len": 66136, "worker_id": 0, "attn_time_us": 24425.944997787417, "mlp_time_us": 15137.3291015625, "allgather_time_us": 81.75734519958496, "allreduce_time_us": 785.2564423349338, "total_latency_us": 40430}, {"doc_id": 35, "doc_len": 33889, "worker_id": 7, "attn_time_us": 6672.354125562756, "mlp_time_us": 7756.5765380859375, "allgather_time_us": 41.893593072891235, "allreduce_time_us": 363.87949251823926, "total_latency_us": 14834}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 66.74058315298734, "mlp_time": 465.3167724609375, "allgather_time": 2.513195276260376, "allreduce_time": 209.3952339467502}, "1": {"doc_len": 32101, "attn_time": 6018.169632465242, "mlp_time": 7347.3358154296875, "allgather_time": 39.68326687812805, "allreduce_time": 344.7354374636814}, "2": {"doc_len": 60107, "attn_time": 20291.289848898985, "mlp_time": 13757.400512695312, "allgather_time": 74.30429339408875, "allreduce_time": 705.7919276489633}, "3": {"doc_len": 16438, "attn_time": 1752.9741557180173, "mlp_time": 3762.359619140625, "allgather_time": 20.320661067962646, "allreduce_time": 210.50986158974175}, "4": {"doc_len": 17552, "attn_time": 1978.1458543317867, "mlp_time": 4017.333984375, "allgather_time": 21.69778823852539, "allreduce_time": 220.93243657827904}, "5": {"doc_len": 17650, "attn_time": 1998.548728522027, "mlp_time": 4039.764404296875, "allgather_time": 21.818935871124268, "allreduce_time": 221.8408590788859}, "6": {"doc_len": 7168, "attn_time": 417.4589652242031, "mlp_time": 1640.625, "allgather_time": 8.861083984374998, "allreduce_time": 175.0}, "7": {"doc_len": 7125, "attn_time": 413.4748019047083, "mlp_time": 1630.7830810546875, "allgather_time": 8.807927370071411, "allreduce_time": 173.95019531249994}, "8": {"doc_len": 19562, "attn_time": 2415.664093795966, "mlp_time": 4477.386474609375, "allgather_time": 24.182550907135006, "allreduce_time": 239.3099296338815}, "9": {"doc_len": 9323, "attn_time": 647.9962960708053, "mlp_time": 2133.8653564453125, "allgather_time": 11.525095701217651, "allreduce_time": 201.82895165747394}, "10": {"doc_len": 41353, "attn_time": 9819.030371928073, "mlp_time": 9464.950561523438, "allgather_time": 51.12059235572815, "allreduce_time": 458.03860413137375}, "11": {"doc_len": 18999, "attn_time": 2289.0924612727576, "mlp_time": 4348.5260009765625, "allgather_time": 23.486570119857785, "allreduce_time": 234.2146973176681}, "12": {"doc_len": 81288, "attn_time": 36393.213861197444, "mlp_time": 18605.3466796875, "allgather_time": 100.4882526397705, "allreduce_time": 914.1872507847287}, "13": {"doc_len": 26799, "attn_time": 4314.965790577829, "mlp_time": 6133.8043212890625, "allgather_time": 33.12893271446228, "allreduce_time": 301.7920859575545}, "14": {"doc_len": 14333, "attn_time": 1377.9904372414553, "mlp_time": 3280.5633544921875, "allgather_time": 17.718459367752075, "allreduce_time": 208.03235370986292}, "15": {"doc_len": 74771, "attn_time": 30964.76667866259, "mlp_time": 17113.723754882812, "allgather_time": 92.43193507194518, "allreduce_time": 859.5839231858736}, "16": {"doc_len": 66335, "attn_time": 24568.208511425775, "mlp_time": 15182.876586914062, "allgather_time": 82.00334906578064, "allreduce_time": 786.9970552170928}, "17": {"doc_len": 19831, "attn_time": 2477.2379903256806, "mlp_time": 4538.9556884765625, "allgather_time": 24.515088796615597, "allreduce_time": 241.73076546882646}, "18": {"doc_len": 15296, "attn_time": 1544.505479725131, "mlp_time": 3500.9765625, "allgather_time": 18.908920288085938, "allreduce_time": 208.98674021487867}, "19": {"doc_len": 31167, "attn_time": 5699.427983123611, "mlp_time": 7133.5601806640625, "allgather_time": 38.528655767440796, "allreduce_time": 337.31480763455045}, "20": {"doc_len": 7769, "attn_time": 474.61734728098975, "mlp_time": 1778.1829833984375, "allgather_time": 9.604040384292603, "allreduce_time": 189.67285156250006}, "21": {"doc_len": 6741, "attn_time": 378.5313895297653, "mlp_time": 1542.8924560546875, "allgather_time": 8.333226442337036, "allreduce_time": 164.57519531250003}, "22": {"doc_len": 8646, "attn_time": 567.721594253597, "mlp_time": 1978.912353515625, "allgather_time": 10.688188076019285, "allreduce_time": 200.76078534755501}, "23": {"doc_len": 57831, "attn_time": 18826.57526833159, "mlp_time": 13236.465454101562, "allgather_time": 71.49070143699646, "allreduce_time": 674.9865197235906}, "24": {"doc_len": 39755, "attn_time": 9095.973319396755, "mlp_time": 9099.197387695312, "allgather_time": 49.14514422416687, "allreduce_time": 437.63777117875514}, "25": {"doc_len": 34611, "attn_time": 6951.0275631771965, "mlp_time": 7921.8292236328125, "allgather_time": 42.786129713058465, "allreduce_time": 372.8570048810173}, "26": {"doc_len": 61200, "attn_time": 21013.579779816293, "mlp_time": 14007.568359375, "allgather_time": 75.65546035766602, "allreduce_time": 720.6508499671811}, "27": {"doc_len": 18523, "attn_time": 2184.5154727407735, "mlp_time": 4239.5782470703125, "allgather_time": 22.898138761520382, "allreduce_time": 229.87577887079104}, "28": {"doc_len": 35075, "attn_time": 7133.035858432675, "mlp_time": 8028.0303955078125, "allgather_time": 43.359726667404175, "allreduce_time": 378.6419773265417}, "29": {"doc_len": 8666, "attn_time": 570.0274744180244, "mlp_time": 1983.489990234375, "allgather_time": 10.71291208267212, "allreduce_time": 200.79343916512403}, "30": {"doc_len": 6624, "attn_time": 368.1144026980197, "mlp_time": 1516.11328125, "allgather_time": 8.188591003417967, "allreduce_time": 161.71875}, "31": {"doc_len": 33237, "attn_time": 6425.451280164909, "mlp_time": 7607.3455810546875, "allgather_time": 41.08759045600891, "allreduce_time": 355.79797810990163}, "32": {"doc_len": 16523, "attn_time": 1769.7160175262527, "mlp_time": 3781.8145751953125, "allgather_time": 20.42573809623718, "allreduce_time": 211.31153005327067}, "33": {"doc_len": 34119, "attn_time": 6760.528215829564, "mlp_time": 7809.2193603515625, "allgather_time": 42.1779191493988, "allreduce_time": 366.7361545255514}, "34": {"doc_len": 66136, "attn_time": 24425.944997787417, "mlp_time": 15137.3291015625, "allgather_time": 81.75734519958496, "allreduce_time": 785.2564423349338}, "35": {"doc_len": 33889, "attn_time": 6672.354125562756, "mlp_time": 7756.5765380859375, "allgather_time": 41.893593072891235, "allreduce_time": 363.87949251823926}}}, "attnserver_result": {"batch_total_time": 66262.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 2600.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 4, "mlp_cp": 2}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 4, "dp": 4, "ratio": 0.982287143801938, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 69554, "worker_latencies_us": [69554, 69554, 69554, 69552], "doc2worker": {"0": 3, "1": 3, "2": 2, "3": 3, "4": 1, "5": 2, "6": 2, "7": 2, "8": 3, "9": 0, "10": 2, "11": 1, "12": 0, "13": 0, "14": 2, "15": 1, "16": 2, "17": 0, "18": 1, "19": 1, "20": 3, "21": 2, "22": 0, "23": 0, "24": 0, "25": 3, "26": 1, "27": 3, "28": 3, "29": 2, "30": 3, "31": 3, "32": 3, "33": 2, "34": 3, "35": 1}, "latency_breakdown": {"max_worker_latency_us": 69554, "worker_latencies_us": [69554, 69554, 69554, 69552], "solver_status": "OPTIMAL", "solved_time_s": 0.31515932083129883, "num_vars": 149, "num_cons": 48}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [9, 12, 13, 17, 22, 23, 24], "total_batch_length": 243473, "total_latency_us": 69554, "mlp_cost_us": 27863.27362060547, "attn_cost_us": 38385.003611489155, "allreduce_cost_us": 2972.9241301184843, "allgather_cost_us": 335.5202531814575}, {"worker_id": 1, "assigned_docs": [4, 11, 15, 18, 19, 26, 35], "total_batch_length": 252874, "total_latency_us": 69554, "mlp_cost_us": 28939.132690429688, "attn_cost_us": 37323.98556335727, "allreduce_cost_us": 2945.56294741667, "allgather_cost_us": 348.4753894805908}, {"worker_id": 2, "assigned_docs": [2, 5, 6, 7, 10, 14, 16, 21, 29, 33], "total_batch_length": 263597, "total_latency_us": 69554, "mlp_cost_us": 30166.282653808594, "attn_cost_us": 35567.83729940923, "allreduce_cost_us": 3461.755784101854, "allgather_cost_us": 363.2523202896118}, {"worker_id": 3, "assigned_docs": [0, 1, 3, 8, 20, 25, 27, 28, 30, 31, 32, 34], "total_batch_length": 288632, "total_latency_us": 69552, "mlp_cost_us": 33031.31103515625, "attn_cost_us": 32439.24992065059, "allreduce_cost_us": 3689.0827757730112, "allgather_cost_us": 397.75203704833984}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 3, "attn_time_us": 49.42633039092835, "mlp_time_us": 232.65838623046875, "allgather_time_us": 2.8015947341918945, "allreduce_time_us": 209.3952339467502, "total_latency_us": 494}, {"doc_id": 1, "doc_len": 32101, "worker_id": 3, "attn_time_us": 3310.9124187511397, "mlp_time_us": 3673.6679077148438, "allgather_time_us": 44.23708438873291, "allreduce_time_us": 344.7354374636814, "total_latency_us": 7373}, {"doc_id": 2, "doc_len": 60107, "worker_id": 2, "attn_time_us": 10712.241571757932, "mlp_time_us": 6878.700256347656, "allgather_time_us": 82.83101558685303, "allreduce_time_us": 705.7919276489633, "total_latency_us": 18379}, {"doc_id": 3, "doc_len": 16438, "worker_id": 3, "attn_time_us": 976.2199790348404, "mlp_time_us": 1881.1798095703125, "allgather_time_us": 22.65254020690918, "allreduce_time_us": 210.50986158974175, "total_latency_us": 3090}, {"doc_id": 4, "doc_len": 17552, "worker_id": 1, "attn_time_us": 1100.3030594953157, "mlp_time_us": 2008.6669921875, "allgather_time_us": 24.187698364257812, "allreduce_time_us": 220.93243657827904, "total_latency_us": 3354}, {"doc_id": 5, "doc_len": 17650, "worker_id": 2, "attn_time_us": 1111.53912298819, "mlp_time_us": 2019.8822021484375, "allgather_time_us": 24.3227481842041, "allreduce_time_us": 221.8408590788859, "total_latency_us": 3377}, {"doc_id": 6, "doc_len": 7168, "worker_id": 2, "attn_time_us": 248.39051546321056, "mlp_time_us": 820.3125, "allgather_time_us": 9.8779296875, "allreduce_time_us": 175.0, "total_latency_us": 1253}, {"doc_id": 7, "doc_len": 7125, "worker_id": 2, "attn_time_us": 246.20400705154404, "mlp_time_us": 815.3915405273438, "allgather_time_us": 9.818673133850098, "allreduce_time_us": 173.95019531249994, "total_latency_us": 1245}, {"doc_id": 8, "doc_len": 19562, "worker_id": 3, "attn_time_us": 1341.015458460395, "mlp_time_us": 2238.6932373046875, "allgather_time_us": 26.957597732543945, "allreduce_time_us": 239.3099296338815, "total_latency_us": 3845}, {"doc_id": 9, "doc_len": 9323, "worker_id": 0, "attn_time_us": 375.7252943683381, "mlp_time_us": 1066.9326782226562, "allgather_time_us": 12.847647666931152, "allreduce_time_us": 201.82895165747394, "total_latency_us": 1657}, {"doc_id": 10, "doc_len": 41353, "worker_id": 2, "attn_time_us": 5315.9543832679765, "mlp_time_us": 4732.475280761719, "allgather_time_us": 56.98688983917236, "allreduce_time_us": 458.03860413137375, "total_latency_us": 10563}, {"doc_id": 11, "doc_len": 18999, "worker_id": 1, "attn_time_us": 1271.4267406512968, "mlp_time_us": 2174.2630004882812, "allgather_time_us": 26.181750297546387, "allreduce_time_us": 234.2146973176681, "total_latency_us": 3706}, {"doc_id": 12, "doc_len": 81288, "worker_id": 0, "attn_time_us": 19019.310797753013, "mlp_time_us": 9302.67333984375, "allgather_time_us": 112.01969146728516, "allreduce_time_us": 914.1872507847287, "total_latency_us": 29348}, {"doc_id": 13, "doc_len": 26799, "worker_id": 0, "attn_time_us": 2381.70056757483, "mlp_time_us": 3066.9021606445312, "allgather_time_us": 36.93061351776123, "allreduce_time_us": 301.7920859575545, "total_latency_us": 5787}, {"doc_id": 14, "doc_len": 14333, "worker_id": 2, "attn_time_us": 774.8103155740483, "mlp_time_us": 1640.2816772460938, "allgather_time_us": 19.75172519683838, "allreduce_time_us": 208.03235370986292, "total_latency_us": 2642}, {"doc_id": 15, "doc_len": 74771, "worker_id": 1, "attn_time_us": 16209.374177741967, "mlp_time_us": 8556.861877441406, "allgather_time_us": 103.03887844085693, "allreduce_time_us": 859.5839231858736, "total_latency_us": 25728}, {"doc_id": 16, "doc_len": 66335, "worker_id": 2, "attn_time_us": 12891.66948718394, "mlp_time_us": 7591.438293457031, "allgather_time_us": 91.41356945037842, "allreduce_time_us": 786.9970552170928, "total_latency_us": 21361}, {"doc_id": 17, "doc_len": 19831, "worker_id": 0, "attn_time_us": 1374.8554736756475, "mlp_time_us": 2269.4778442382812, "allgather_time_us": 27.32829570770264, "allreduce_time_us": 241.73076546882646, "total_latency_us": 3913}, {"doc_id": 18, "doc_len": 15296, "worker_id": 1, "attn_time_us": 864.4111469485147, "mlp_time_us": 1750.48828125, "allgather_time_us": 21.07879638671875, "allreduce_time_us": 208.98674021487867, "total_latency_us": 2844}, {"doc_id": 19, "doc_len": 31167, "worker_id": 1, "attn_time_us": 3137.240918292033, "mlp_time_us": 3566.7800903320312, "allgather_time_us": 42.94997692108154, "allreduce_time_us": 337.31480763455045, "total_latency_us": 7084}, {"doc_id": 20, "doc_len": 7769, "worker_id": 3, "attn_time_us": 279.58757267499607, "mlp_time_us": 889.0914916992188, "allgather_time_us": 10.706143379211426, "allreduce_time_us": 189.67285156250006, "total_latency_us": 1369}, {"doc_id": 21, "doc_len": 6741, "worker_id": 2, "attn_time_us": 226.95464186671273, "mlp_time_us": 771.4462280273438, "allgather_time_us": 9.289498329162598, "allreduce_time_us": 164.57519531250003, "total_latency_us": 1172}, {"doc_id": 22, "doc_len": 8646, "worker_id": 0, "attn_time_us": 330.95823183092585, "mlp_time_us": 989.4561767578125, "allgather_time_us": 11.914701461791994, "allreduce_time_us": 200.76078534755501, "total_latency_us": 1533}, {"doc_id": 23, "doc_len": 57831, "worker_id": 0, "attn_time_us": 9964.8651426371, "mlp_time_us": 6618.232727050781, "allgather_time_us": 79.69455242156982, "allreduce_time_us": 674.9865197235906, "total_latency_us": 17337}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 4937.588103649304, "mlp_time_us": 4549.598693847656, "allgather_time_us": 54.784750938415534, "allreduce_time_us": 437.63777117875514, "total_latency_us": 9979}, {"doc_id": 25, "doc_len": 34611, "worker_id": 3, "attn_time_us": 3808.630103387034, "mlp_time_us": 3960.9146118164062, "allgather_time_us": 47.696013450622566, "allreduce_time_us": 372.8570048810173, "total_latency_us": 8190}, {"doc_id": 26, "doc_len": 61200, "worker_id": 1, "attn_time_us": 11080.09520088578, "mlp_time_us": 7003.7841796875, "allgather_time_us": 84.33723449707031, "allreduce_time_us": 720.6508499671811, "total_latency_us": 18888}, {"doc_id": 27, "doc_len": 18523, "worker_id": 3, "attn_time_us": 1213.9020261092269, "mlp_time_us": 2119.7891235351562, "allgather_time_us": 25.52579402923584, "allreduce_time_us": 229.87577887079104, "total_latency_us": 3589}, {"doc_id": 28, "doc_len": 35075, "worker_id": 3, "attn_time_us": 3904.851852120881, "mlp_time_us": 4014.0151977539062, "allgather_time_us": 48.33543300628662, "allreduce_time_us": 378.6419773265417, "total_latency_us": 8345}, {"doc_id": 29, "doc_len": 8666, "worker_id": 2, "attn_time_us": 332.24759701135036, "mlp_time_us": 991.7449951171875, "allgather_time_us": 11.942262649536133, "allreduce_time_us": 200.79343916512403, "total_latency_us": 1536}, {"doc_id": 30, "doc_len": 6624, "worker_id": 3, "attn_time_us": 221.18989226420368, "mlp_time_us": 758.056640625, "allgather_time_us": 9.128265380859375, "allreduce_time_us": 161.71875, "total_latency_us": 1150}, {"doc_id": 31, "doc_len": 33237, "worker_id": 3, "attn_time_us": 3530.2754910919152, "mlp_time_us": 3803.6727905273438, "allgather_time_us": 45.802559852600105, "allreduce_time_us": 355.79797810990163, "total_latency_us": 7735}, {"doc_id": 32, "doc_len": 16523, "worker_id": 3, "attn_time_us": 985.4509286417602, "mlp_time_us": 1890.9072875976562, "allgather_time_us": 22.769675254821777, "allreduce_time_us": 211.31153005327067, "total_latency_us": 3110}, {"doc_id": 33, "doc_len": 34119, "worker_id": 2, "attn_time_us": 3707.825657244323, "mlp_time_us": 3904.6096801757812, "allgather_time_us": 47.0180082321167, "allreduce_time_us": 366.7361545255514, "total_latency_us": 8026}, {"doc_id": 34, "doc_len": 66136, "worker_id": 3, "attn_time_us": 12817.78786772327, "mlp_time_us": 7568.66455078125, "allgather_time_us": 91.13933563232422, "allreduce_time_us": 785.2564423349338, "total_latency_us": 21262}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 3661.1343193423695, "mlp_time_us": 3878.2882690429688, "allgather_time_us": 46.70105457305908, "allreduce_time_us": 363.87949251823926, "total_latency_us": 7950}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 49.42633039092835, "mlp_time": 232.65838623046875, "allgather_time": 2.8015947341918945, "allreduce_time": 209.3952339467502}, "1": {"doc_len": 32101, "attn_time": 3310.9124187511397, "mlp_time": 3673.6679077148438, "allgather_time": 44.23708438873291, "allreduce_time": 344.7354374636814}, "2": {"doc_len": 60107, "attn_time": 10712.241571757932, "mlp_time": 6878.700256347656, "allgather_time": 82.83101558685303, "allreduce_time": 705.7919276489633}, "3": {"doc_len": 16438, "attn_time": 976.2199790348404, "mlp_time": 1881.1798095703125, "allgather_time": 22.65254020690918, "allreduce_time": 210.50986158974175}, "4": {"doc_len": 17552, "attn_time": 1100.3030594953157, "mlp_time": 2008.6669921875, "allgather_time": 24.187698364257812, "allreduce_time": 220.93243657827904}, "5": {"doc_len": 17650, "attn_time": 1111.53912298819, "mlp_time": 2019.8822021484375, "allgather_time": 24.3227481842041, "allreduce_time": 221.8408590788859}, "6": {"doc_len": 7168, "attn_time": 248.39051546321056, "mlp_time": 820.3125, "allgather_time": 9.8779296875, "allreduce_time": 175.0}, "7": {"doc_len": 7125, "attn_time": 246.20400705154404, "mlp_time": 815.3915405273438, "allgather_time": 9.818673133850098, "allreduce_time": 173.95019531249994}, "8": {"doc_len": 19562, "attn_time": 1341.015458460395, "mlp_time": 2238.6932373046875, "allgather_time": 26.957597732543945, "allreduce_time": 239.3099296338815}, "9": {"doc_len": 9323, "attn_time": 375.7252943683381, "mlp_time": 1066.9326782226562, "allgather_time": 12.847647666931152, "allreduce_time": 201.82895165747394}, "10": {"doc_len": 41353, "attn_time": 5315.9543832679765, "mlp_time": 4732.475280761719, "allgather_time": 56.98688983917236, "allreduce_time": 458.03860413137375}, "11": {"doc_len": 18999, "attn_time": 1271.4267406512968, "mlp_time": 2174.2630004882812, "allgather_time": 26.181750297546387, "allreduce_time": 234.2146973176681}, "12": {"doc_len": 81288, "attn_time": 19019.310797753013, "mlp_time": 9302.67333984375, "allgather_time": 112.01969146728516, "allreduce_time": 914.1872507847287}, "13": {"doc_len": 26799, "attn_time": 2381.70056757483, "mlp_time": 3066.9021606445312, "allgather_time": 36.93061351776123, "allreduce_time": 301.7920859575545}, "14": {"doc_len": 14333, "attn_time": 774.8103155740483, "mlp_time": 1640.2816772460938, "allgather_time": 19.75172519683838, "allreduce_time": 208.03235370986292}, "15": {"doc_len": 74771, "attn_time": 16209.374177741967, "mlp_time": 8556.861877441406, "allgather_time": 103.03887844085693, "allreduce_time": 859.5839231858736}, "16": {"doc_len": 66335, "attn_time": 12891.66948718394, "mlp_time": 7591.438293457031, "allgather_time": 91.41356945037842, "allreduce_time": 786.9970552170928}, "17": {"doc_len": 19831, "attn_time": 1374.8554736756475, "mlp_time": 2269.4778442382812, "allgather_time": 27.32829570770264, "allreduce_time": 241.73076546882646}, "18": {"doc_len": 15296, "attn_time": 864.4111469485147, "mlp_time": 1750.48828125, "allgather_time": 21.07879638671875, "allreduce_time": 208.98674021487867}, "19": {"doc_len": 31167, "attn_time": 3137.240918292033, "mlp_time": 3566.7800903320312, "allgather_time": 42.94997692108154, "allreduce_time": 337.31480763455045}, "20": {"doc_len": 7769, "attn_time": 279.58757267499607, "mlp_time": 889.0914916992188, "allgather_time": 10.706143379211426, "allreduce_time": 189.67285156250006}, "21": {"doc_len": 6741, "attn_time": 226.95464186671273, "mlp_time": 771.4462280273438, "allgather_time": 9.289498329162598, "allreduce_time": 164.57519531250003}, "22": {"doc_len": 8646, "attn_time": 330.95823183092585, "mlp_time": 989.4561767578125, "allgather_time": 11.914701461791994, "allreduce_time": 200.76078534755501}, "23": {"doc_len": 57831, "attn_time": 9964.8651426371, "mlp_time": 6618.232727050781, "allgather_time": 79.69455242156982, "allreduce_time": 674.9865197235906}, "24": {"doc_len": 39755, "attn_time": 4937.588103649304, "mlp_time": 4549.598693847656, "allgather_time": 54.784750938415534, "allreduce_time": 437.63777117875514}, "25": {"doc_len": 34611, "attn_time": 3808.630103387034, "mlp_time": 3960.9146118164062, "allgather_time": 47.696013450622566, "allreduce_time": 372.8570048810173}, "26": {"doc_len": 61200, "attn_time": 11080.09520088578, "mlp_time": 7003.7841796875, "allgather_time": 84.33723449707031, "allreduce_time": 720.6508499671811}, "27": {"doc_len": 18523, "attn_time": 1213.9020261092269, "mlp_time": 2119.7891235351562, "allgather_time": 25.52579402923584, "allreduce_time": 229.87577887079104}, "28": {"doc_len": 35075, "attn_time": 3904.851852120881, "mlp_time": 4014.0151977539062, "allgather_time": 48.33543300628662, "allreduce_time": 378.6419773265417}, "29": {"doc_len": 8666, "attn_time": 332.24759701135036, "mlp_time": 991.7449951171875, "allgather_time": 11.942262649536133, "allreduce_time": 200.79343916512403}, "30": {"doc_len": 6624, "attn_time": 221.18989226420368, "mlp_time": 758.056640625, "allgather_time": 9.128265380859375, "allreduce_time": 161.71875}, "31": {"doc_len": 33237, "attn_time": 3530.2754910919152, "mlp_time": 3803.6727905273438, "allgather_time": 45.802559852600105, "allreduce_time": 355.79797810990163}, "32": {"doc_len": 16523, "attn_time": 985.4509286417602, "mlp_time": 1890.9072875976562, "allgather_time": 22.769675254821777, "allreduce_time": 211.31153005327067}, "33": {"doc_len": 34119, "attn_time": 3707.825657244323, "mlp_time": 3904.6096801757812, "allgather_time": 47.0180082321167, "allreduce_time": 366.7361545255514}, "34": {"doc_len": 66136, "attn_time": 12817.78786772327, "mlp_time": 7568.66455078125, "allgather_time": 91.13933563232422, "allreduce_time": 785.2564423349338}, "35": {"doc_len": 33889, "attn_time": 3661.1343193423695, "mlp_time": 3878.2882690429688, "allgather_time": 46.70105457305908, "allreduce_time": 363.87949251823926}}}, "attnserver_result": {"batch_total_time": 68322.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 4660.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 4, "mlp_cp": 4}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 4, "cp": 8, "dp": 2, "ratio": 0.9650807970918354, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 75374, "worker_latencies_us": [75374, 75374], "doc2worker": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 1, "7": 1, "8": 1, "9": 1, "10": 0, "11": 0, "12": 0, "13": 1, "14": 1, "15": 0, "16": 0, "17": 0, "18": 1, "19": 1, "20": 1, "21": 1, "22": 1, "23": 1, "24": 1, "25": 1, "26": 1, "27": 1, "28": 0, "29": 0, "30": 1, "31": 1, "32": 1, "33": 1, "34": 1, "35": 1}, "latency_breakdown": {"max_worker_latency_us": 75374, "worker_latencies_us": [75374, 75374], "solver_status": "OPTIMAL", "solved_time_s": 0.03891110420227051, "num_vars": 75, "num_cons": 42}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [0, 1, 2, 3, 4, 5, 10, 11, 12, 15, 16, 17, 28, 29], "total_batch_length": 492199, "total_latency_us": 75374, "mlp_cost_us": 28163.85269165039, "attn_cost_us": 40473.50979902725, "allreduce_cost_us": 5987.39346890353, "allgather_cost_us": 758.9571553468704}, {"worker_id": 1, "assigned_docs": [6, 7, 8, 9, 13, 14, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 30, 31, 32, 33, 34, 35], "total_batch_length": 556377, "total_latency_us": 75374, "mlp_cost_us": 31836.14730834961, "attn_cost_us": 35609.869072551985, "allreduce_cost_us": 7081.93216850649, "allgather_cost_us": 857.9178446531296}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 0, "attn_time_us": 45.053083285681694, "mlp_time_us": 116.32919311523438, "allgather_time_us": 3.1348294019699097, "allreduce_time_us": 209.3952339467502, "total_latency_us": 373}, {"doc_id": 1, "doc_len": 32101, "worker_id": 0, "attn_time_us": 1834.1594272812608, "mlp_time_us": 1836.8339538574219, "allgather_time_us": 49.49884831905365, "allreduce_time_us": 344.7354374636814, "total_latency_us": 4065}, {"doc_id": 2, "doc_len": 60107, "worker_id": 0, "attn_time_us": 5503.952959704578, "mlp_time_us": 3439.350128173828, "allgather_time_us": 92.68332064151764, "allreduce_time_us": 705.7919276489633, "total_latency_us": 9741}, {"doc_id": 3, "doc_len": 16438, "worker_id": 0, "attn_time_us": 587.0227732365913, "mlp_time_us": 940.5899047851562, "allgather_time_us": 25.346938371658325, "allreduce_time_us": 210.50986158974175, "total_latency_us": 1763}, {"doc_id": 4, "doc_len": 17552, "worker_id": 0, "attn_time_us": 656.3417129498802, "mlp_time_us": 1004.33349609375, "allgather_time_us": 27.064695358276367, "allreduce_time_us": 220.93243657827904, "total_latency_us": 1908}, {"doc_id": 5, "doc_len": 17650, "worker_id": 0, "attn_time_us": 662.5919136873613, "mlp_time_us": 1009.9411010742188, "allgather_time_us": 27.215808629989624, "allreduce_time_us": 221.8408590788859, "total_latency_us": 1921}, {"doc_id": 6, "doc_len": 7168, "worker_id": 1, "attn_time_us": 171.4962649708702, "mlp_time_us": 410.15625, "allgather_time_us": 11.0528564453125, "allreduce_time_us": 175.0, "total_latency_us": 767}, {"doc_id": 7, "doc_len": 7125, "worker_id": 1, "attn_time_us": 170.16977334438286, "mlp_time_us": 407.6957702636719, "allgather_time_us": 10.986551642417908, "allreduce_time_us": 173.95019531249994, "total_latency_us": 762}, {"doc_id": 8, "doc_len": 19562, "worker_id": 1, "attn_time_us": 789.3717850540575, "mlp_time_us": 1119.3466186523438, "allgather_time_us": 30.16405940055847, "allreduce_time_us": 239.3099296338815, "total_latency_us": 2178}, {"doc_id": 9, "doc_len": 9323, "worker_id": 1, "attn_time_us": 247.96126215049284, "mlp_time_us": 533.4663391113281, "allgather_time_us": 14.375806450843811, "allreduce_time_us": 201.82895165747394, "total_latency_us": 997}, {"doc_id": 10, "doc_len": 41353, "worker_id": 0, "attn_time_us": 2856.640907802848, "mlp_time_us": 2366.2376403808594, "allgather_time_us": 63.765174746513374, "allreduce_time_us": 458.03860413137375, "total_latency_us": 5744}, {"doc_id": 11, "doc_len": 18999, "worker_id": 0, "attn_time_us": 751.0921743399517, "mlp_time_us": 1087.1315002441406, "allgather_time_us": 29.295929074287415, "allreduce_time_us": 234.2146973176681, "total_latency_us": 2101}, {"doc_id": 12, "doc_len": 81288, "worker_id": 0, "attn_time_us": 9631.20516623635, "mlp_time_us": 4651.336669921875, "allgather_time_us": 125.34383296966553, "allreduce_time_us": 914.1872507847287, "total_latency_us": 15322}, {"doc_id": 13, "doc_len": 26799, "worker_id": 1, "attn_time_us": 1348.9115439804193, "mlp_time_us": 1533.4510803222656, "allgather_time_us": 41.32331192493439, "allreduce_time_us": 301.7920859575545, "total_latency_us": 3225}, {"doc_id": 14, "doc_len": 14333, "worker_id": 1, "attn_time_us": 476.45373404002515, "mlp_time_us": 820.1408386230469, "allgather_time_us": 22.101086974143982, "allreduce_time_us": 208.03235370986292, "total_latency_us": 1526}, {"doc_id": 15, "doc_len": 74771, "worker_id": 0, "attn_time_us": 8221.519697834525, "mlp_time_us": 4278.430938720703, "allgather_time_us": 115.29480040073395, "allreduce_time_us": 859.5839231858736, "total_latency_us": 13474}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 6553.869156217277, "mlp_time_us": 3795.7191467285156, "allgather_time_us": 102.28672325611115, "allreduce_time_us": 786.9970552170928, "total_latency_us": 11238}, {"doc_id": 17, "doc_len": 19831, "worker_id": 0, "attn_time_us": 807.9380263762004, "mlp_time_us": 1134.7389221191406, "allgather_time_us": 30.578849911689762, "allreduce_time_us": 241.73076546882646, "total_latency_us": 2214}, {"doc_id": 18, "doc_len": 15296, "worker_id": 1, "attn_time_us": 525.9031338891015, "mlp_time_us": 875.244140625, "allgather_time_us": 23.58600616455078, "allreduce_time_us": 208.98674021487867, "total_latency_us": 1633}, {"doc_id": 19, "doc_len": 31167, "worker_id": 1, "attn_time_us": 1744.2495713534097, "mlp_time_us": 1783.3900451660156, "allgather_time_us": 48.05864632129669, "allreduce_time_us": 337.31480763455045, "total_latency_us": 3913}, {"doc_id": 20, "doc_len": 7769, "worker_id": 1, "attn_time_us": 190.27415093411705, "mlp_time_us": 444.5457458496094, "allgather_time_us": 11.979581713676453, "allreduce_time_us": 189.67285156250006, "total_latency_us": 836}, {"doc_id": 21, "doc_len": 6741, "worker_id": 1, "attn_time_us": 158.42811526122927, "mlp_time_us": 385.7231140136719, "allgather_time_us": 10.394434332847595, "allreduce_time_us": 164.57519531250003, "total_latency_us": 719}, {"doc_id": 22, "doc_len": 8646, "worker_id": 1, "attn_time_us": 221.13924753393704, "mlp_time_us": 494.72808837890625, "allgather_time_us": 13.33189129829407, "allreduce_time_us": 200.76078534755501, "total_latency_us": 929}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 5143.7098114921455, "mlp_time_us": 3309.1163635253906, "allgather_time_us": 89.17379200458527, "allreduce_time_us": 674.9865197235906, "total_latency_us": 9216}, {"doc_id": 24, "doc_len": 39755, "worker_id": 1, "attn_time_us": 2665.8887959395724, "mlp_time_us": 2274.799346923828, "allgather_time_us": 61.301103234291084, "allreduce_time_us": 437.63777117875514, "total_latency_us": 5439}, {"doc_id": 25, "doc_len": 34611, "worker_id": 1, "attn_time_us": 2090.805015128013, "mlp_time_us": 1980.4573059082031, "allgather_time_us": 53.36919844150544, "allreduce_time_us": 372.8570048810173, "total_latency_us": 4497}, {"doc_id": 26, "doc_len": 61200, "worker_id": 1, "attn_time_us": 5680.664890684295, "mlp_time_us": 3501.89208984375, "allgather_time_us": 94.36869621276855, "allreduce_time_us": 720.6508499671811, "total_latency_us": 9997}, {"doc_id": 27, "doc_len": 18523, "worker_id": 1, "attn_time_us": 719.3426685302084, "mlp_time_us": 1059.8945617675781, "allgather_time_us": 28.56195032596588, "allreduce_time_us": 229.87577887079104, "total_latency_us": 2037}, {"doc_id": 28, "doc_len": 35075, "worker_id": 0, "attn_time_us": 2140.2062860438173, "mlp_time_us": 2007.0075988769531, "allgather_time_us": 54.08467352390289, "allreduce_time_us": 378.6419773265417, "total_latency_us": 4579}, {"doc_id": 29, "doc_len": 8666, "worker_id": 0, "attn_time_us": 221.91651403092902, "mlp_time_us": 495.87249755859375, "allgather_time_us": 13.362730741500854, "allreduce_time_us": 200.79343916512403, "total_latency_us": 931}, {"doc_id": 30, "doc_len": 6624, "worker_id": 1, "attn_time_us": 154.8885371145502, "mlp_time_us": 379.0283203125, "allgather_time_us": 10.21402359008789, "allreduce_time_us": 161.71875, "total_latency_us": 705}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 1947.4365611338137, "mlp_time_us": 1901.8363952636719, "allgather_time_us": 51.250528693199165, "allreduce_time_us": 355.79797810990163, "total_latency_us": 4256}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 592.1991596030263, "mlp_time_us": 945.4536437988281, "allgather_time_us": 25.47800600528717, "allreduce_time_us": 211.31153005327067, "total_latency_us": 1774}, {"doc_id": 33, "doc_len": 34119, "worker_id": 1, "attn_time_us": 2038.9651269439971, "mlp_time_us": 1952.3048400878906, "allgather_time_us": 52.61054813861847, "allreduce_time_us": 366.7361545255514, "total_latency_us": 4410}, {"doc_id": 34, "doc_len": 66136, "worker_id": 1, "attn_time_us": 6516.686817894671, "mlp_time_us": 3784.332275390625, "allgather_time_us": 101.97987079620361, "allreduce_time_us": 785.2564423349338, "total_latency_us": 11188}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 2014.9231055756504, "mlp_time_us": 1939.1441345214844, "allgather_time_us": 52.25589454174042, "allreduce_time_us": 363.87949251823926, "total_latency_us": 4370}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 45.053083285681694, "mlp_time": 116.32919311523438, "allgather_time": 3.1348294019699097, "allreduce_time": 209.3952339467502}, "1": {"doc_len": 32101, "attn_time": 1834.1594272812608, "mlp_time": 1836.8339538574219, "allgather_time": 49.49884831905365, "allreduce_time": 344.7354374636814}, "2": {"doc_len": 60107, "attn_time": 5503.952959704578, "mlp_time": 3439.350128173828, "allgather_time": 92.68332064151764, "allreduce_time": 705.7919276489633}, "3": {"doc_len": 16438, "attn_time": 587.0227732365913, "mlp_time": 940.5899047851562, "allgather_time": 25.346938371658325, "allreduce_time": 210.50986158974175}, "4": {"doc_len": 17552, "attn_time": 656.3417129498802, "mlp_time": 1004.33349609375, "allgather_time": 27.064695358276367, "allreduce_time": 220.93243657827904}, "5": {"doc_len": 17650, "attn_time": 662.5919136873613, "mlp_time": 1009.9411010742188, "allgather_time": 27.215808629989624, "allreduce_time": 221.8408590788859}, "6": {"doc_len": 7168, "attn_time": 171.4962649708702, "mlp_time": 410.15625, "allgather_time": 11.0528564453125, "allreduce_time": 175.0}, "7": {"doc_len": 7125, "attn_time": 170.16977334438286, "mlp_time": 407.6957702636719, "allgather_time": 10.986551642417908, "allreduce_time": 173.95019531249994}, "8": {"doc_len": 19562, "attn_time": 789.3717850540575, "mlp_time": 1119.3466186523438, "allgather_time": 30.16405940055847, "allreduce_time": 239.3099296338815}, "9": {"doc_len": 9323, "attn_time": 247.96126215049284, "mlp_time": 533.4663391113281, "allgather_time": 14.375806450843811, "allreduce_time": 201.82895165747394}, "10": {"doc_len": 41353, "attn_time": 2856.640907802848, "mlp_time": 2366.2376403808594, "allgather_time": 63.765174746513374, "allreduce_time": 458.03860413137375}, "11": {"doc_len": 18999, "attn_time": 751.0921743399517, "mlp_time": 1087.1315002441406, "allgather_time": 29.295929074287415, "allreduce_time": 234.2146973176681}, "12": {"doc_len": 81288, "attn_time": 9631.20516623635, "mlp_time": 4651.336669921875, "allgather_time": 125.34383296966553, "allreduce_time": 914.1872507847287}, "13": {"doc_len": 26799, "attn_time": 1348.9115439804193, "mlp_time": 1533.4510803222656, "allgather_time": 41.32331192493439, "allreduce_time": 301.7920859575545}, "14": {"doc_len": 14333, "attn_time": 476.45373404002515, "mlp_time": 820.1408386230469, "allgather_time": 22.101086974143982, "allreduce_time": 208.03235370986292}, "15": {"doc_len": 74771, "attn_time": 8221.519697834525, "mlp_time": 4278.430938720703, "allgather_time": 115.29480040073395, "allreduce_time": 859.5839231858736}, "16": {"doc_len": 66335, "attn_time": 6553.869156217277, "mlp_time": 3795.7191467285156, "allgather_time": 102.28672325611115, "allreduce_time": 786.9970552170928}, "17": {"doc_len": 19831, "attn_time": 807.9380263762004, "mlp_time": 1134.7389221191406, "allgather_time": 30.578849911689762, "allreduce_time": 241.73076546882646}, "18": {"doc_len": 15296, "attn_time": 525.9031338891015, "mlp_time": 875.244140625, "allgather_time": 23.58600616455078, "allreduce_time": 208.98674021487867}, "19": {"doc_len": 31167, "attn_time": 1744.2495713534097, "mlp_time": 1783.3900451660156, "allgather_time": 48.05864632129669, "allreduce_time": 337.31480763455045}, "20": {"doc_len": 7769, "attn_time": 190.27415093411705, "mlp_time": 444.5457458496094, "allgather_time": 11.979581713676453, "allreduce_time": 189.67285156250006}, "21": {"doc_len": 6741, "attn_time": 158.42811526122927, "mlp_time": 385.7231140136719, "allgather_time": 10.394434332847595, "allreduce_time": 164.57519531250003}, "22": {"doc_len": 8646, "attn_time": 221.13924753393704, "mlp_time": 494.72808837890625, "allgather_time": 13.33189129829407, "allreduce_time": 200.76078534755501}, "23": {"doc_len": 57831, "attn_time": 5143.7098114921455, "mlp_time": 3309.1163635253906, "allgather_time": 89.17379200458527, "allreduce_time": 674.9865197235906}, "24": {"doc_len": 39755, "attn_time": 2665.8887959395724, "mlp_time": 2274.799346923828, "allgather_time": 61.301103234291084, "allreduce_time": 437.63777117875514}, "25": {"doc_len": 34611, "attn_time": 2090.805015128013, "mlp_time": 1980.4573059082031, "allgather_time": 53.36919844150544, "allreduce_time": 372.8570048810173}, "26": {"doc_len": 61200, "attn_time": 5680.664890684295, "mlp_time": 3501.89208984375, "allgather_time": 94.36869621276855, "allreduce_time": 720.6508499671811}, "27": {"doc_len": 18523, "attn_time": 719.3426685302084, "mlp_time": 1059.8945617675781, "allgather_time": 28.56195032596588, "allreduce_time": 229.87577887079104}, "28": {"doc_len": 35075, "attn_time": 2140.2062860438173, "mlp_time": 2007.0075988769531, "allgather_time": 54.08467352390289, "allreduce_time": 378.6419773265417}, "29": {"doc_len": 8666, "attn_time": 221.91651403092902, "mlp_time": 495.87249755859375, "allgather_time": 13.362730741500854, "allreduce_time": 200.79343916512403}, "30": {"doc_len": 6624, "attn_time": 154.8885371145502, "mlp_time": 379.0283203125, "allgather_time": 10.21402359008789, "allreduce_time": 161.71875}, "31": {"doc_len": 33237, "attn_time": 1947.4365611338137, "mlp_time": 1901.8363952636719, "allgather_time": 51.250528693199165, "allreduce_time": 355.79797810990163}, "32": {"doc_len": 16523, "attn_time": 592.1991596030263, "mlp_time": 945.4536437988281, "allgather_time": 25.47800600528717, "allreduce_time": 211.31153005327067}, "33": {"doc_len": 34119, "attn_time": 2038.9651269439971, "mlp_time": 1952.3048400878906, "allgather_time": 52.61054813861847, "allreduce_time": 366.7361545255514}, "34": {"doc_len": 66136, "attn_time": 6516.686817894671, "mlp_time": 3784.332275390625, "allgather_time": 101.97987079620361, "allreduce_time": 785.2564423349338}, "35": {"doc_len": 33889, "attn_time": 2014.9231055756504, "mlp_time": 1939.1441345214844, "allgather_time": 52.25589454174042, "allreduce_time": 363.87949251823926}}}, "attnserver_result": {"batch_total_time": 72742.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 9080.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 4, "mlp_cp": 8}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 1, "dp": 8, "ratio": 0.9661759681516362, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 67319, "worker_latencies_us": [67308, 67319, 67313, 67318, 67311, 67313, 67317, 67296], "doc2worker": {"0": 7, "1": 7, "2": 5, "3": 5, "4": 3, "5": 4, "6": 3, "7": 1, "8": 5, "9": 5, "10": 0, "11": 2, "12": 2, "13": 4, "14": 3, "15": 1, "16": 4, "17": 1, "18": 4, "19": 3, "20": 4, "21": 2, "22": 6, "23": 6, "24": 7, "25": 6, "26": 3, "27": 1, "28": 7, "29": 3, "30": 7, "31": 7, "32": 0, "33": 6, "34": 0, "35": 5}, "latency_breakdown": {"max_worker_latency_us": 67319, "worker_latencies_us": [67308, 67319, 67313, 67318, 67311, 67313, 67317, 67296], "solver_status": "FEASIBLE", "solved_time_s": 360.08472990989685, "num_vars": 297, "num_cons": 60}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [10, 32, 34], "total_batch_length": 124012, "total_latency_us": 67308, "mlp_cost_us": 28384.09423828125, "attn_cost_us": 36881.82202923574, "allreduce_cost_us": 2043.884077892786, "allgather_cost_us": 0}, {"worker_id": 1, "assigned_docs": [7, 15, 17, 27], "total_batch_length": 120250, "total_latency_us": 67319, "mlp_cost_us": 27523.040771484375, "attn_cost_us": 37163.19139396152, "allreduce_cost_us": 2634.4221786491325, "allgather_cost_us": 0}, {"worker_id": 2, "assigned_docs": [11, 12, 21], "total_batch_length": 107028, "total_latency_us": 67313, "mlp_cost_us": 24496.76513671875, "attn_cost_us": 40828.30014030205, "allreduce_cost_us": 1989.0673050369278, "allgather_cost_us": 0}, {"worker_id": 3, "assigned_docs": [4, 6, 14, 19, 26, 29], "total_batch_length": 140086, "total_latency_us": 67318, "mlp_cost_us": 32063.140869140625, "attn_cost_us": 31320.444984700964, "allreduce_cost_us": 3937.840986841917, "allgather_cost_us": 0}, {"worker_id": 4, "assigned_docs": [5, 13, 16, 18, 20], "total_batch_length": 133849, "total_latency_us": 67311, "mlp_cost_us": 30635.604858398438, "attn_cost_us": 33388.7738062007, "allreduce_cost_us": 3288.714274540449, "allgather_cost_us": 0}, {"worker_id": 5, "assigned_docs": [2, 3, 8, 9, 35], "total_batch_length": 139319, "total_latency_us": 67313, "mlp_cost_us": 31887.588500976562, "attn_cost_us": 32111.74870327276, "allreduce_cost_us": 3316.749747227503, "allgather_cost_us": 0}, {"worker_id": 6, "assigned_docs": [22, 23, 25, 33], "total_batch_length": 135207, "total_latency_us": 67317, "mlp_cost_us": 30946.426391601562, "attn_cost_us": 33633.29474781061, "allreduce_cost_us": 2739.54832603154, "allgather_cost_us": 0}, {"worker_id": 7, "assigned_docs": [0, 1, 24, 28, 30, 31], "total_batch_length": 148825, "total_latency_us": 67296, "mlp_cost_us": 34063.33923339844, "attn_cost_us": 29212.051418139024, "allreduce_cost_us": 4023.328851246949, "allgather_cost_us": 0}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 45.99327819338411, "mlp_time_us": 465.3167724609375, "allgather_time_us": 0, "allreduce_time_us": 579.5606088479992, "total_latency_us": 1090}, {"doc_id": 1, "doc_len": 32101, "worker_id": 7, "attn_time_us": 6027.342633591405, "mlp_time_us": 7347.3358154296875, "allgather_time_us": 0, "allreduce_time_us": 697.8152297288477, "total_latency_us": 14072}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20898.30826539956, "mlp_time_us": 13757.400512695312, "allgather_time_us": 0, "allreduce_time_us": 708.7446960600437, "total_latency_us": 35364}, {"doc_id": 3, "doc_len": 16438, "worker_id": 5, "attn_time_us": 1642.7933513500036, "mlp_time_us": 3762.359619140625, "allgather_time_us": 0, "allreduce_time_us": 630.3151814837149, "total_latency_us": 6035}, {"doc_id": 4, "doc_len": 17552, "worker_id": 3, "attn_time_us": 1865.9183509392344, "mlp_time_us": 4017.333984375, "allgather_time_us": 0, "allreduce_time_us": 636.6290557689522, "total_latency_us": 6519}, {"doc_id": 5, "doc_len": 17650, "worker_id": 4, "attn_time_us": 1886.2059304090703, "mlp_time_us": 4039.764404296875, "allgather_time_us": 0, "allreduce_time_us": 637.1680852633538, "total_latency_us": 6563}, {"doc_id": 6, "doc_len": 7168, "worker_id": 3, "attn_time_us": 347.89383480972947, "mlp_time_us": 1640.625, "allgather_time_us": 0, "allreduce_time_us": 637.5155344372663, "total_latency_us": 2626}, {"doc_id": 7, "doc_len": 7125, "worker_id": 1, "attn_time_us": 344.24354820917983, "mlp_time_us": 1630.7830810546875, "allgather_time_us": 0, "allreduce_time_us": 637.8562888315172, "total_latency_us": 2612}, {"doc_id": 8, "doc_len": 19562, "worker_id": 5, "attn_time_us": 2303.271010234323, "mlp_time_us": 4477.386474609375, "allgather_time_us": 0, "allreduce_time_us": 647.2078430632266, "total_latency_us": 7427}, {"doc_id": 9, "doc_len": 9323, "worker_id": 5, "attn_time_us": 561.5682550988607, "mlp_time_us": 2133.8653564453125, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 3325}, {"doc_id": 10, "doc_len": 41353, "worker_id": 0, "attn_time_us": 9952.517655568663, "mlp_time_us": 9464.950561523438, "allgather_time_us": 0, "allreduce_time_us": 703.3412397316583, "total_latency_us": 20120}, {"doc_id": 11, "doc_len": 18999, "worker_id": 2, "attn_time_us": 2176.270483137557, "mlp_time_us": 4348.5260009765625, "allgather_time_us": 0, "allreduce_time_us": 644.3413319582293, "total_latency_us": 7169}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 38339.64717568529, "mlp_time_us": 18605.3466796875, "allgather_time_us": 0, "allreduce_time_us": 703.7235949059694, "total_latency_us": 57648}, {"doc_id": 13, "doc_len": 26799, "worker_id": 4, "attn_time_us": 4244.790356304482, "mlp_time_us": 6133.8043212890625, "allgather_time_us": 0, "allreduce_time_us": 678.9275079322385, "total_latency_us": 11057}, {"doc_id": 14, "doc_len": 14333, "worker_id": 3, "attn_time_us": 1267.3186809539911, "mlp_time_us": 3280.5633544921875, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 5177}, {"doc_id": 15, "doc_len": 74771, "worker_id": 1, "attn_time_us": 32382.140042935374, "mlp_time_us": 17113.723754882812, "allgather_time_us": 0, "allreduce_time_us": 706.152038171347, "total_latency_us": 50202}, {"doc_id": 16, "doc_len": 66335, "worker_id": 4, "attn_time_us": 25423.864330595512, "mlp_time_us": 15182.876586914062, "allgather_time_us": 0, "allreduce_time_us": 709.6454163461838, "total_latency_us": 41316}, {"doc_id": 17, "doc_len": 19831, "worker_id": 1, "attn_time_us": 2365.184477415967, "mlp_time_us": 4538.9556884765625, "allgather_time_us": 0, "allreduce_time_us": 648.552826817597, "total_latency_us": 7552}, {"doc_id": 18, "doc_len": 15296, "worker_id": 4, "attn_time_us": 1433.281249322433, "mlp_time_us": 3500.9765625, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 5564}, {"doc_id": 19, "doc_len": 31167, "worker_id": 3, "attn_time_us": 5691.408569340125, "mlp_time_us": 7133.5601806640625, "allgather_time_us": 0, "allreduce_time_us": 694.6902806686116, "total_latency_us": 13519}, {"doc_id": 20, "doc_len": 7769, "worker_id": 4, "attn_time_us": 400.6319395691988, "mlp_time_us": 1778.1829833984375, "allgather_time_us": 0, "allreduce_time_us": 632.9732649986724, "total_latency_us": 2811}, {"doc_id": 21, "doc_len": 6741, "worker_id": 2, "attn_time_us": 312.3824814792043, "mlp_time_us": 1542.8924560546875, "allgather_time_us": 0, "allreduce_time_us": 641.002378172729, "total_latency_us": 2496}, {"doc_id": 22, "doc_len": 8646, "worker_id": 6, "attn_time_us": 486.901752359458, "mlp_time_us": 1978.912353515625, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 3095}, {"doc_id": 23, "doc_len": 57831, "worker_id": 6, "attn_time_us": 19357.834401720425, "mlp_time_us": 13236.465454101562, "allgather_time_us": 0, "allreduce_time_us": 708.185050039066, "total_latency_us": 33302}, {"doc_id": 24, "doc_len": 39755, "worker_id": 7, "attn_time_us": 9204.125080854983, "mlp_time_us": 9099.197387695312, "allgather_time_us": 0, "allreduce_time_us": 702.7742398668917, "total_latency_us": 19006}, {"doc_id": 25, "doc_len": 34611, "worker_id": 6, "attn_time_us": 6992.171417460123, "mlp_time_us": 7921.8292236328125, "allgather_time_us": 0, "allreduce_time_us": 700.7842834252929, "total_latency_us": 15614}, {"doc_id": 26, "doc_len": 61200, "worker_id": 3, "attn_time_us": 21658.870066801574, "mlp_time_us": 14007.568359375, "allgather_time_us": 0, "allreduce_time_us": 709.0061159670872, "total_latency_us": 36375}, {"doc_id": 27, "doc_len": 18523, "worker_id": 1, "attn_time_us": 2071.623325401003, "mlp_time_us": 4239.5782470703125, "allgather_time_us": 0, "allreduce_time_us": 641.8610248286714, "total_latency_us": 6953}, {"doc_id": 28, "doc_len": 35075, "worker_id": 7, "attn_time_us": 7179.33943354777, "mlp_time_us": 8028.0303955078125, "allgather_time_us": 0, "allreduce_time_us": 700.9752885825412, "total_latency_us": 15908}, {"doc_id": 29, "doc_len": 8666, "worker_id": 3, "attn_time_us": 489.03548185631183, "mlp_time_us": 1983.489990234375, "allgather_time_us": 0, "allreduce_time_us": 630.0, "total_latency_us": 3102}, {"doc_id": 30, "doc_len": 6624, "worker_id": 7, "attn_time_us": 302.9399389201254, "mlp_time_us": 1516.11328125, "allgather_time_us": 0, "allreduce_time_us": 641.9998797975837, "total_latency_us": 2461}, {"doc_id": 31, "doc_len": 33237, "worker_id": 7, "attn_time_us": 6452.3110530313625, "mlp_time_us": 7607.3455810546875, "allgather_time_us": 0, "allreduce_time_us": 700.2036044230861, "total_latency_us": 14759}, {"doc_id": 32, "doc_len": 16523, "worker_id": 0, "attn_time_us": 1659.3322604208663, "mlp_time_us": 3781.8145751953125, "allgather_time_us": 0, "allreduce_time_us": 630.8095262582397, "total_latency_us": 6071}, {"doc_id": 33, "doc_len": 34119, "worker_id": 6, "attn_time_us": 6796.3871762706, "mlp_time_us": 7809.2193603515625, "allgather_time_us": 0, "allreduce_time_us": 700.578992567181, "total_latency_us": 15306}, {"doc_id": 34, "doc_len": 66136, "worker_id": 0, "attn_time_us": 25269.972113246207, "mlp_time_us": 15137.3291015625, "allgather_time_us": 0, "allreduce_time_us": 709.7333119028882, "total_latency_us": 41117}, {"doc_id": 35, "doc_len": 33889, "worker_id": 5, "attn_time_us": 6705.807821190014, "mlp_time_us": 7756.5765380859375, "allgather_time_us": 0, "allreduce_time_us": 700.4820266205178, "total_latency_us": 15162}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 45.99327819338411, "mlp_time": 465.3167724609375, "allgather_time": 0, "allreduce_time": 579.5606088479992}, "1": {"doc_len": 32101, "attn_time": 6027.342633591405, "mlp_time": 7347.3358154296875, "allgather_time": 0, "allreduce_time": 697.8152297288477}, "2": {"doc_len": 60107, "attn_time": 20898.30826539956, "mlp_time": 13757.400512695312, "allgather_time": 0, "allreduce_time": 708.7446960600437}, "3": {"doc_len": 16438, "attn_time": 1642.7933513500036, "mlp_time": 3762.359619140625, "allgather_time": 0, "allreduce_time": 630.3151814837149}, "4": {"doc_len": 17552, "attn_time": 1865.9183509392344, "mlp_time": 4017.333984375, "allgather_time": 0, "allreduce_time": 636.6290557689522}, "5": {"doc_len": 17650, "attn_time": 1886.2059304090703, "mlp_time": 4039.764404296875, "allgather_time": 0, "allreduce_time": 637.1680852633538}, "6": {"doc_len": 7168, "attn_time": 347.89383480972947, "mlp_time": 1640.625, "allgather_time": 0, "allreduce_time": 637.5155344372663}, "7": {"doc_len": 7125, "attn_time": 344.24354820917983, "mlp_time": 1630.7830810546875, "allgather_time": 0, "allreduce_time": 637.8562888315172}, "8": {"doc_len": 19562, "attn_time": 2303.271010234323, "mlp_time": 4477.386474609375, "allgather_time": 0, "allreduce_time": 647.2078430632266}, "9": {"doc_len": 9323, "attn_time": 561.5682550988607, "mlp_time": 2133.8653564453125, "allgather_time": 0, "allreduce_time": 630.0}, "10": {"doc_len": 41353, "attn_time": 9952.517655568663, "mlp_time": 9464.950561523438, "allgather_time": 0, "allreduce_time": 703.3412397316583}, "11": {"doc_len": 18999, "attn_time": 2176.270483137557, "mlp_time": 4348.5260009765625, "allgather_time": 0, "allreduce_time": 644.3413319582293}, "12": {"doc_len": 81288, "attn_time": 38339.64717568529, "mlp_time": 18605.3466796875, "allgather_time": 0, "allreduce_time": 703.7235949059694}, "13": {"doc_len": 26799, "attn_time": 4244.790356304482, "mlp_time": 6133.8043212890625, "allgather_time": 0, "allreduce_time": 678.9275079322385}, "14": {"doc_len": 14333, "attn_time": 1267.3186809539911, "mlp_time": 3280.5633544921875, "allgather_time": 0, "allreduce_time": 630.0}, "15": {"doc_len": 74771, "attn_time": 32382.140042935374, "mlp_time": 17113.723754882812, "allgather_time": 0, "allreduce_time": 706.152038171347}, "16": {"doc_len": 66335, "attn_time": 25423.864330595512, "mlp_time": 15182.876586914062, "allgather_time": 0, "allreduce_time": 709.6454163461838}, "17": {"doc_len": 19831, "attn_time": 2365.184477415967, "mlp_time": 4538.9556884765625, "allgather_time": 0, "allreduce_time": 648.552826817597}, "18": {"doc_len": 15296, "attn_time": 1433.281249322433, "mlp_time": 3500.9765625, "allgather_time": 0, "allreduce_time": 630.0}, "19": {"doc_len": 31167, "attn_time": 5691.408569340125, "mlp_time": 7133.5601806640625, "allgather_time": 0, "allreduce_time": 694.6902806686116}, "20": {"doc_len": 7769, "attn_time": 400.6319395691988, "mlp_time": 1778.1829833984375, "allgather_time": 0, "allreduce_time": 632.9732649986724}, "21": {"doc_len": 6741, "attn_time": 312.3824814792043, "mlp_time": 1542.8924560546875, "allgather_time": 0, "allreduce_time": 641.002378172729}, "22": {"doc_len": 8646, "attn_time": 486.901752359458, "mlp_time": 1978.912353515625, "allgather_time": 0, "allreduce_time": 630.0}, "23": {"doc_len": 57831, "attn_time": 19357.834401720425, "mlp_time": 13236.465454101562, "allgather_time": 0, "allreduce_time": 708.185050039066}, "24": {"doc_len": 39755, "attn_time": 9204.125080854983, "mlp_time": 9099.197387695312, "allgather_time": 0, "allreduce_time": 702.7742398668917}, "25": {"doc_len": 34611, "attn_time": 6992.171417460123, "mlp_time": 7921.8292236328125, "allgather_time": 0, "allreduce_time": 700.7842834252929}, "26": {"doc_len": 61200, "attn_time": 21658.870066801574, "mlp_time": 14007.568359375, "allgather_time": 0, "allreduce_time": 709.0061159670872}, "27": {"doc_len": 18523, "attn_time": 2071.623325401003, "mlp_time": 4239.5782470703125, "allgather_time": 0, "allreduce_time": 641.8610248286714}, "28": {"doc_len": 35075, "attn_time": 7179.33943354777, "mlp_time": 8028.0303955078125, "allgather_time": 0, "allreduce_time": 700.9752885825412}, "29": {"doc_len": 8666, "attn_time": 489.03548185631183, "mlp_time": 1983.489990234375, "allgather_time": 0, "allreduce_time": 630.0}, "30": {"doc_len": 6624, "attn_time": 302.9399389201254, "mlp_time": 1516.11328125, "allgather_time": 0, "allreduce_time": 641.9998797975837}, "31": {"doc_len": 33237, "attn_time": 6452.3110530313625, "mlp_time": 7607.3455810546875, "allgather_time": 0, "allreduce_time": 700.2036044230861}, "32": {"doc_len": 16523, "attn_time": 1659.3322604208663, "mlp_time": 3781.8145751953125, "allgather_time": 0, "allreduce_time": 630.8095262582397}, "33": {"doc_len": 34119, "attn_time": 6796.3871762706, "mlp_time": 7809.2193603515625, "allgather_time": 0, "allreduce_time": 700.578992567181}, "34": {"doc_len": 66136, "attn_time": 25269.972113246207, "mlp_time": 15137.3291015625, "allgather_time": 0, "allreduce_time": 709.7333119028882}, "35": {"doc_len": 33889, "attn_time": 6705.807821190014, "mlp_time": 7756.5765380859375, "allgather_time": 0, "allreduce_time": 700.4820266205178}}}, "attnserver_result": {"batch_total_time": 65042.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 1380.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 8, "mlp_cp": 1}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 2, "dp": 4, "ratio": 0.9179136680633082, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 71839, "worker_latencies_us": [71838, 71839, 71839, 71838], "doc2worker": {"0": 3, "1": 2, "2": 2, "3": 3, "4": 3, "5": 0, "6": 3, "7": 1, "8": 1, "9": 1, "10": 3, "11": 1, "12": 3, "13": 0, "14": 0, "15": 1, "16": 0, "17": 2, "18": 1, "19": 0, "20": 2, "21": 1, "22": 1, "23": 1, "24": 0, "25": 2, "26": 3, "27": 0, "28": 1, "29": 2, "30": 1, "31": 0, "32": 3, "33": 2, "34": 2, "35": 0}, "latency_breakdown": {"max_worker_latency_us": 71839, "worker_latencies_us": [71838, 71839, 71839, 71838], "solver_status": "OPTIMAL", "solved_time_s": 0.8593261241912842, "num_vars": 149, "num_cons": 48}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [5, 13, 14, 16, 19, 24, 27, 31, 35], "total_batch_length": 281688, "total_latency_us": 71838, "mlp_cost_us": 32236.63330078125, "attn_cost_us": 33162.94628905766, "allreduce_cost_us": 6095.752185949555, "allgather_cost_us": 348.22279930114746}, {"worker_id": 1, "assigned_docs": [7, 8, 9, 11, 15, 18, 21, 22, 23, 28, 30], "total_batch_length": 259993, "total_latency_us": 71839, "mlp_cost_us": 29753.83758544922, "attn_cost_us": 34550.61333474175, "allreduce_cost_us": 7217.72009861624, "allgather_cost_us": 321.4034330844879}, {"worker_id": 2, "assigned_docs": [1, 2, 17, 20, 25, 29, 33, 34], "total_batch_length": 263340, "total_latency_us": 71839, "mlp_cost_us": 30136.871337890625, "attn_cost_us": 35951.89816566931, "allreduce_cost_us": 5429.182605500523, "allgather_cost_us": 325.54099559783936}, {"worker_id": 3, "assigned_docs": [0, 3, 4, 6, 10, 12, 26, 32], "total_batch_length": 243555, "total_latency_us": 71838, "mlp_cost_us": 27872.657775878906, "attn_cost_us": 38437.699155109774, "allreduce_cost_us": 5230.900857400888, "allgather_cost_us": 301.08277201652527}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 3, "attn_time_us": 42.73542991514328, "mlp_time_us": 232.65838623046875, "allgather_time_us": 2.513195276260376, "allreduce_time_us": 579.5606088479992, "total_latency_us": 857}, {"doc_id": 1, "doc_len": 32101, "worker_id": 2, "attn_time_us": 3248.700999227743, "mlp_time_us": 3673.6679077148438, "allgather_time_us": 39.68326687812805, "allreduce_time_us": 697.8152297288477, "total_latency_us": 7659}, {"doc_id": 2, "doc_len": 60107, "worker_id": 2, "attn_time_us": 10647.51462664538, "mlp_time_us": 6878.700256347656, "allgather_time_us": 74.30429339408875, "allreduce_time_us": 708.7446960600437, "total_latency_us": 18309}, {"doc_id": 3, "doc_len": 16438, "worker_id": 3, "attn_time_us": 942.3484414989467, "mlp_time_us": 1881.1798095703125, "allgather_time_us": 20.320661067962646, "allreduce_time_us": 630.3151814837149, "total_latency_us": 3474}, {"doc_id": 4, "doc_len": 17552, "worker_id": 3, "attn_time_us": 1063.8283914706483, "mlp_time_us": 2008.6669921875, "allgather_time_us": 21.69778823852539, "allreduce_time_us": 636.6290557689522, "total_latency_us": 3730}, {"doc_id": 5, "doc_len": 17650, "worker_id": 0, "attn_time_us": 1074.8381180744955, "mlp_time_us": 2019.8822021484375, "allgather_time_us": 21.818935871124268, "allreduce_time_us": 637.1680852633538, "total_latency_us": 3753}, {"doc_id": 6, "doc_len": 7168, "worker_id": 3, "attn_time_us": 230.53365659200563, "mlp_time_us": 820.3125, "allgather_time_us": 8.861083984374998, "allreduce_time_us": 637.5155344372663, "total_latency_us": 1697}, {"doc_id": 7, "doc_len": 7125, "worker_id": 1, "attn_time_us": 228.40296089864867, "mlp_time_us": 815.3915405273438, "allgather_time_us": 8.807927370071411, "allreduce_time_us": 637.8562888315172, "total_latency_us": 1690}, {"doc_id": 8, "doc_len": 19562, "worker_id": 1, "attn_time_us": 1299.9986696532656, "mlp_time_us": 2238.6932373046875, "allgather_time_us": 24.182550907135006, "allreduce_time_us": 647.2078430632266, "total_latency_us": 4210}, {"doc_id": 9, "doc_len": 9323, "worker_id": 1, "attn_time_us": 354.1000887344782, "mlp_time_us": 1066.9326782226562, "allgather_time_us": 11.525095701217651, "allreduce_time_us": 630.0, "total_latency_us": 2062}, {"doc_id": 10, "doc_len": 41353, "worker_id": 3, "attn_time_us": 5243.5799037379375, "mlp_time_us": 4732.475280761719, "allgather_time_us": 51.12059235572815, "allreduce_time_us": 703.3412397316583, "total_latency_us": 10730}, {"doc_id": 11, "doc_len": 18999, "worker_id": 1, "attn_time_us": 1231.6597662029246, "mlp_time_us": 2174.2630004882812, "allgather_time_us": 23.486570119857785, "allreduce_time_us": 644.3413319582293, "total_latency_us": 4073}, {"doc_id": 12, "doc_len": 81288, "worker_id": 3, "attn_time_us": 18946.089705375914, "mlp_time_us": 9302.67333984375, "allgather_time_us": 100.4882526397705, "allreduce_time_us": 703.7235949059694, "total_latency_us": 29052}, {"doc_id": 13, "doc_len": 26799, "worker_id": 0, "attn_time_us": 2326.669315702681, "mlp_time_us": 3066.9021606445312, "allgather_time_us": 33.12893271446228, "allreduce_time_us": 678.9275079322385, "total_latency_us": 6105}, {"doc_id": 14, "doc_len": 14333, "worker_id": 0, "attn_time_us": 743.6416829443158, "mlp_time_us": 1640.2816772460938, "allgather_time_us": 17.718459367752075, "allreduce_time_us": 630.0, "total_latency_us": 3031}, {"doc_id": 15, "doc_len": 74771, "worker_id": 1, "attn_time_us": 16144.24516776669, "mlp_time_us": 8556.861877441406, "allgather_time_us": 92.43193507194518, "allreduce_time_us": 706.152038171347, "total_latency_us": 25499}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 12836.76619960152, "mlp_time_us": 7591.438293457031, "allgather_time_us": 82.00334906578064, "allreduce_time_us": 709.6454163461838, "total_latency_us": 21219}, {"doc_id": 17, "doc_len": 19831, "worker_id": 2, "attn_time_us": 1333.2482307661235, "mlp_time_us": 2269.4778442382812, "allgather_time_us": 24.515088796615597, "allreduce_time_us": 648.552826817597, "total_latency_us": 4275}, {"doc_id": 18, "doc_len": 15296, "worker_id": 1, "attn_time_us": 831.9267132202209, "mlp_time_us": 1750.48828125, "allgather_time_us": 18.908920288085938, "allreduce_time_us": 630.0, "total_latency_us": 3231}, {"doc_id": 19, "doc_len": 31167, "worker_id": 0, "attn_time_us": 3076.073904291472, "mlp_time_us": 3566.7800903320312, "allgather_time_us": 38.528655767440796, "allreduce_time_us": 694.6902806686116, "total_latency_us": 7376}, {"doc_id": 20, "doc_len": 7769, "worker_id": 2, "attn_time_us": 261.0333577133657, "mlp_time_us": 889.0914916992188, "allgather_time_us": 9.604040384292603, "allreduce_time_us": 632.9732649986724, "total_latency_us": 1792}, {"doc_id": 21, "doc_len": 6741, "worker_id": 1, "attn_time_us": 209.68686366743617, "mlp_time_us": 771.4462280273438, "allgather_time_us": 8.333226442337036, "allreduce_time_us": 641.002378172729, "total_latency_us": 1630}, {"doc_id": 22, "doc_len": 8646, "worker_id": 1, "attn_time_us": 310.91508035047195, "mlp_time_us": 989.4561767578125, "allgather_time_us": 10.688188076019285, "allreduce_time_us": 630.0, "total_latency_us": 1941}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 9896.838956819414, "mlp_time_us": 6618.232727050781, "allgather_time_us": 71.49070143699646, "allreduce_time_us": 708.185050039066, "total_latency_us": 17294}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 4866.441615723358, "mlp_time_us": 4549.598693847656, "allgather_time_us": 49.14514422416687, "allreduce_time_us": 702.7742398668917, "total_latency_us": 10167}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264, "mlp_time_us": 3960.9146118164062, "allgather_time_us": 42.786129713058465, "allreduce_time_us": 700.7842834252929, "total_latency_us": 8447}, {"doc_id": 26, "doc_len": 61200, "worker_id": 3, "attn_time_us": 11017.204699170845, "mlp_time_us": 7003.7841796875, "allgather_time_us": 75.65546035766602, "allreduce_time_us": 709.0061159670872, "total_latency_us": 18805}, {"doc_id": 27, "doc_len": 18523, "worker_id": 0, "attn_time_us": 1175.2058725498914, "mlp_time_us": 2119.7891235351562, "allgather_time_us": 22.898138761520382, "allreduce_time_us": 641.8610248286714, "total_latency_us": 3959}, {"doc_id": 28, "doc_len": 35075, "worker_id": 1, "attn_time_us": 3838.7420594599516, "mlp_time_us": 4014.0151977539062, "allgather_time_us": 43.359726667404175, "allreduce_time_us": 700.9752885825412, "total_latency_us": 8597}, {"doc_id": 29, "doc_len": 8666, "worker_id": 2, "attn_time_us": 312.15691356399446, "mlp_time_us": 991.7449951171875, "allgather_time_us": 10.71291208267212, "allreduce_time_us": 630.0, "total_latency_us": 1944}, {"doc_id": 30, "doc_len": 6624, "worker_id": 1, "attn_time_us": 204.09700796824586, "mlp_time_us": 758.056640625, "allgather_time_us": 8.188591003417967, "allreduce_time_us": 641.9998797975837, "total_latency_us": 1612}, {"doc_id": 31, "doc_len": 33237, "worker_id": 0, "attn_time_us": 3466.6896220314493, "mlp_time_us": 3803.6727905273438, "allgather_time_us": 41.08759045600891, "allreduce_time_us": 700.2036044230861, "total_latency_us": 8011}, {"doc_id": 32, "doc_len": 16523, "worker_id": 3, "attn_time_us": 951.3789273483325, "mlp_time_us": 1890.9072875976562, "allgather_time_us": 20.42573809623718, "allreduce_time_us": 630.8095262582397, "total_latency_us": 3493}, {"doc_id": 33, "doc_len": 34119, "worker_id": 2, "attn_time_us": 3642.9923703419004, "mlp_time_us": 3904.6096801757812, "allgather_time_us": 42.1779191493988, "allreduce_time_us": 700.578992567181, "total_latency_us": 8290}, {"doc_id": 34, "doc_len": 66136, "worker_id": 2, "attn_time_us": 12763.121764257538, "mlp_time_us": 7568.66455078125, "allgather_time_us": 81.75734519958496, "allreduce_time_us": 709.7333119028882, "total_latency_us": 21123}, {"doc_id": 35, "doc_len": 33889, "worker_id": 0, "attn_time_us": 3596.6199581384835, "mlp_time_us": 3878.2882690429688, "allgather_time_us": 41.893593072891235, "allreduce_time_us": 700.4820266205178, "total_latency_us": 8217}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 42.73542991514328, "mlp_time": 232.65838623046875, "allgather_time": 2.513195276260376, "allreduce_time": 579.5606088479992}, "1": {"doc_len": 32101, "attn_time": 3248.700999227743, "mlp_time": 3673.6679077148438, "allgather_time": 39.68326687812805, "allreduce_time": 697.8152297288477}, "2": {"doc_len": 60107, "attn_time": 10647.51462664538, "mlp_time": 6878.700256347656, "allgather_time": 74.30429339408875, "allreduce_time": 708.7446960600437}, "3": {"doc_len": 16438, "attn_time": 942.3484414989467, "mlp_time": 1881.1798095703125, "allgather_time": 20.320661067962646, "allreduce_time": 630.3151814837149}, "4": {"doc_len": 17552, "attn_time": 1063.8283914706483, "mlp_time": 2008.6669921875, "allgather_time": 21.69778823852539, "allreduce_time": 636.6290557689522}, "5": {"doc_len": 17650, "attn_time": 1074.8381180744955, "mlp_time": 2019.8822021484375, "allgather_time": 21.818935871124268, "allreduce_time": 637.1680852633538}, "6": {"doc_len": 7168, "attn_time": 230.53365659200563, "mlp_time": 820.3125, "allgather_time": 8.861083984374998, "allreduce_time": 637.5155344372663}, "7": {"doc_len": 7125, "attn_time": 228.40296089864867, "mlp_time": 815.3915405273438, "allgather_time": 8.807927370071411, "allreduce_time": 637.8562888315172}, "8": {"doc_len": 19562, "attn_time": 1299.9986696532656, "mlp_time": 2238.6932373046875, "allgather_time": 24.182550907135006, "allreduce_time": 647.2078430632266}, "9": {"doc_len": 9323, "attn_time": 354.1000887344782, "mlp_time": 1066.9326782226562, "allgather_time": 11.525095701217651, "allreduce_time": 630.0}, "10": {"doc_len": 41353, "attn_time": 5243.5799037379375, "mlp_time": 4732.475280761719, "allgather_time": 51.12059235572815, "allreduce_time": 703.3412397316583}, "11": {"doc_len": 18999, "attn_time": 1231.6597662029246, "mlp_time": 2174.2630004882812, "allgather_time": 23.486570119857785, "allreduce_time": 644.3413319582293}, "12": {"doc_len": 81288, "attn_time": 18946.089705375914, "mlp_time": 9302.67333984375, "allgather_time": 100.4882526397705, "allreduce_time": 703.7235949059694}, "13": {"doc_len": 26799, "attn_time": 2326.669315702681, "mlp_time": 3066.9021606445312, "allgather_time": 33.12893271446228, "allreduce_time": 678.9275079322385}, "14": {"doc_len": 14333, "attn_time": 743.6416829443158, "mlp_time": 1640.2816772460938, "allgather_time": 17.718459367752075, "allreduce_time": 630.0}, "15": {"doc_len": 74771, "attn_time": 16144.24516776669, "mlp_time": 8556.861877441406, "allgather_time": 92.43193507194518, "allreduce_time": 706.152038171347}, "16": {"doc_len": 66335, "attn_time": 12836.76619960152, "mlp_time": 7591.438293457031, "allgather_time": 82.00334906578064, "allreduce_time": 709.6454163461838}, "17": {"doc_len": 19831, "attn_time": 1333.2482307661235, "mlp_time": 2269.4778442382812, "allgather_time": 24.515088796615597, "allreduce_time": 648.552826817597}, "18": {"doc_len": 15296, "attn_time": 831.9267132202209, "mlp_time": 1750.48828125, "allgather_time": 18.908920288085938, "allreduce_time": 630.0}, "19": {"doc_len": 31167, "attn_time": 3076.073904291472, "mlp_time": 3566.7800903320312, "allgather_time": 38.528655767440796, "allreduce_time": 694.6902806686116}, "20": {"doc_len": 7769, "attn_time": 261.0333577133657, "mlp_time": 889.0914916992188, "allgather_time": 9.604040384292603, "allreduce_time": 632.9732649986724}, "21": {"doc_len": 6741, "attn_time": 209.68686366743617, "mlp_time": 771.4462280273438, "allgather_time": 8.333226442337036, "allreduce_time": 641.002378172729}, "22": {"doc_len": 8646, "attn_time": 310.91508035047195, "mlp_time": 989.4561767578125, "allgather_time": 10.688188076019285, "allreduce_time": 630.0}, "23": {"doc_len": 57831, "attn_time": 9896.838956819414, "mlp_time": 6618.232727050781, "allgather_time": 71.49070143699646, "allreduce_time": 708.185050039066}, "24": {"doc_len": 39755, "attn_time": 4866.441615723358, "mlp_time": 4549.598693847656, "allgather_time": 49.14514422416687, "allreduce_time": 702.7742398668917}, "25": {"doc_len": 34611, "attn_time": 3743.129903153264, "mlp_time": 3960.9146118164062, "allgather_time": 42.786129713058465, "allreduce_time": 700.7842834252929}, "26": {"doc_len": 61200, "attn_time": 11017.204699170845, "mlp_time": 7003.7841796875, "allgather_time": 75.65546035766602, "allreduce_time": 709.0061159670872}, "27": {"doc_len": 18523, "attn_time": 1175.2058725498914, "mlp_time": 2119.7891235351562, "allgather_time": 22.898138761520382, "allreduce_time": 641.8610248286714}, "28": {"doc_len": 35075, "attn_time": 3838.7420594599516, "mlp_time": 4014.0151977539062, "allgather_time": 43.359726667404175, "allreduce_time": 700.9752885825412}, "29": {"doc_len": 8666, "attn_time": 312.15691356399446, "mlp_time": 991.7449951171875, "allgather_time": 10.71291208267212, "allreduce_time": 630.0}, "30": {"doc_len": 6624, "attn_time": 204.09700796824586, "mlp_time": 758.056640625, "allgather_time": 8.188591003417967, "allreduce_time": 641.9998797975837}, "31": {"doc_len": 33237, "attn_time": 3466.6896220314493, "mlp_time": 3803.6727905273438, "allgather_time": 41.08759045600891, "allreduce_time": 700.2036044230861}, "32": {"doc_len": 16523, "attn_time": 951.3789273483325, "mlp_time": 1890.9072875976562, "allgather_time": 20.42573809623718, "allreduce_time": 630.8095262582397}, "33": {"doc_len": 34119, "attn_time": 3642.9923703419004, "mlp_time": 3904.6096801757812, "allgather_time": 42.1779191493988, "allreduce_time": 700.578992567181}, "34": {"doc_len": 66136, "attn_time": 12763.121764257538, "mlp_time": 7568.66455078125, "allgather_time": 81.75734519958496, "allreduce_time": 709.7333119028882}, "35": {"doc_len": 33889, "attn_time": 3596.6199581384835, "mlp_time": 3878.2882690429688, "allgather_time": 41.893593072891235, "allreduce_time": 700.4820266205178}}}, "attnserver_result": {"batch_total_time": 65942.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 2280.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 8, "mlp_cp": 2}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 4, "dp": 2, "ratio": 0.8398288738315446, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 80876, "worker_latencies_us": [80876, 80876], "doc2worker": {"0": 1, "1": 0, "2": 0, "3": 0, "4": 1, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 1, "11": 0, "12": 0, "13": 0, "14": 1, "15": 0, "16": 0, "17": 0, "18": 0, "19": 1, "20": 1, "21": 1, "22": 1, "23": 1, "24": 1, "25": 1, "26": 1, "27": 1, "28": 0, "29": 1, "30": 1, "31": 1, "32": 1, "33": 1, "34": 1, "35": 1}, "latency_breakdown": {"max_worker_latency_us": 80876, "worker_latencies_us": [80876, 80876], "solver_status": "OPTIMAL", "solved_time_s": 0.039153337478637695, "num_vars": 75, "num_cons": 42}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [1, 2, 3, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 18, 28], "total_batch_length": 507868, "total_latency_us": 80876, "mlp_cost_us": 29060.440063476562, "attn_cost_us": 40473.93157480323, "allreduce_cost_us": 10648.940863582076, "allgather_cost_us": 699.8722648620605}, {"worker_id": 1, "assigned_docs": [0, 4, 10, 14, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35], "total_batch_length": 540708, "total_latency_us": 80876, "mlp_cost_us": 30939.559936523438, "attn_cost_us": 35875.69693550498, "allreduce_cost_us": 13324.614883885128, "allgather_cost_us": 745.1277351379395}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 1, "attn_time_us": 35.86209557743724, "mlp_time_us": 116.32919311523438, "allgather_time_us": 2.8015947341918945, "allreduce_time_us": 579.5606088479992, "total_latency_us": 734}, {"doc_id": 1, "doc_len": 32101, "worker_id": 0, "attn_time_us": 1748.1643283487695, "mlp_time_us": 1836.8339538574219, "allgather_time_us": 44.23708438873291, "allreduce_time_us": 697.8152297288477, "total_latency_us": 4327}, {"doc_id": 2, "doc_len": 60107, "worker_id": 0, "attn_time_us": 5700.165727592738, "mlp_time_us": 3439.350128173828, "allgather_time_us": 82.83101558685303, "allreduce_time_us": 708.7446960600437, "total_latency_us": 9931}, {"doc_id": 3, "doc_len": 16438, "worker_id": 0, "attn_time_us": 525.1999166276205, "mlp_time_us": 940.5899047851562, "allgather_time_us": 22.65254020690918, "allreduce_time_us": 630.3151814837149, "total_latency_us": 2118}, {"doc_id": 4, "doc_len": 17552, "worker_id": 1, "attn_time_us": 590.8694641020561, "mlp_time_us": 1004.33349609375, "allgather_time_us": 24.187698364257812, "allreduce_time_us": 636.6290557689522, "total_latency_us": 2256}, {"doc_id": 5, "doc_len": 17650, "worker_id": 0, "attn_time_us": 596.8102067870669, "mlp_time_us": 1009.9411010742188, "allgather_time_us": 24.3227481842041, "allreduce_time_us": 637.1680852633538, "total_latency_us": 2268}, {"doc_id": 6, "doc_len": 7168, "worker_id": 0, "attn_time_us": 139.59764116864247, "mlp_time_us": 410.15625, "allgather_time_us": 9.8779296875, "allreduce_time_us": 637.5155344372663, "total_latency_us": 1197}, {"doc_id": 7, "doc_len": 7125, "worker_id": 0, "attn_time_us": 138.4594009163187, "mlp_time_us": 407.6957702636719, "allgather_time_us": 9.818673133850098, "allreduce_time_us": 637.8562888315172, "total_latency_us": 1193}, {"doc_id": 8, "doc_len": 19562, "worker_id": 0, "attn_time_us": 717.9496583077778, "mlp_time_us": 1119.3466186523438, "allgather_time_us": 26.957597732543945, "allreduce_time_us": 647.2078430632266, "total_latency_us": 2511}, {"doc_id": 9, "doc_len": 9323, "worker_id": 0, "attn_time_us": 206.99071879447467, "mlp_time_us": 533.4663391113281, "allgather_time_us": 12.847647666931152, "allreduce_time_us": 630.0, "total_latency_us": 1383}, {"doc_id": 10, "doc_len": 41353, "worker_id": 1, "attn_time_us": 2814.2011760238724, "mlp_time_us": 2366.2376403808594, "allgather_time_us": 56.98688983917236, "allreduce_time_us": 703.3412397316583, "total_latency_us": 5940}, {"doc_id": 11, "doc_len": 18999, "worker_id": 0, "attn_time_us": 681.2504775311392, "mlp_time_us": 1087.1315002441406, "allgather_time_us": 26.181750297546387, "allreduce_time_us": 644.3413319582293, "total_latency_us": 2438}, {"doc_id": 12, "doc_len": 81288, "worker_id": 0, "attn_time_us": 10039.37370553312, "mlp_time_us": 4651.336669921875, "allgather_time_us": 112.01969146728516, "allreduce_time_us": 703.7235949059694, "total_latency_us": 15506}, {"doc_id": 13, "doc_len": 26799, "worker_id": 0, "attn_time_us": 1263.9151059557248, "mlp_time_us": 1533.4510803222656, "allgather_time_us": 36.93061351776123, "allreduce_time_us": 678.9275079322385, "total_latency_us": 3513}, {"doc_id": 14, "doc_len": 14333, "worker_id": 1, "attn_time_us": 419.2247516953619, "mlp_time_us": 820.1408386230469, "allgather_time_us": 19.75172519683838, "allreduce_time_us": 630.0, "total_latency_us": 1889}, {"doc_id": 15, "doc_len": 74771, "worker_id": 0, "attn_time_us": 8586.862233015363, "mlp_time_us": 4278.430938720703, "allgather_time_us": 103.03887844085693, "allreduce_time_us": 706.152038171347, "total_latency_us": 13674}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 6864.469384978604, "mlp_time_us": 3795.7191467285156, "allgather_time_us": 91.41356945037842, "allreduce_time_us": 709.6454163461838, "total_latency_us": 11461}, {"doc_id": 17, "doc_len": 19831, "worker_id": 0, "attn_time_us": 735.7852941605564, "mlp_time_us": 1134.7389221191406, "allgather_time_us": 27.32829570770264, "allreduce_time_us": 648.552826817597, "total_latency_us": 2546}, {"doc_id": 18, "doc_len": 15296, "worker_id": 0, "attn_time_us": 466.431822355287, "mlp_time_us": 875.244140625, "allgather_time_us": 21.07879638671875, "allreduce_time_us": 630.0, "total_latency_us": 1992}, {"doc_id": 19, "doc_len": 31167, "worker_id": 1, "attn_time_us": 1657.8363304026043, "mlp_time_us": 1783.3900451660156, "allgather_time_us": 42.94997692108154, "allreduce_time_us": 694.6902806686116, "total_latency_us": 4178}, {"doc_id": 20, "doc_len": 7769, "worker_id": 1, "attn_time_us": 155.76043720796568, "mlp_time_us": 444.5457458496094, "allgather_time_us": 10.706143379211426, "allreduce_time_us": 632.9732649986724, "total_latency_us": 1243}, {"doc_id": 21, "doc_len": 6741, "worker_id": 1, "attn_time_us": 128.40553464146097, "mlp_time_us": 385.7231140136719, "allgather_time_us": 9.289498329162598, "allreduce_time_us": 641.002378172729, "total_latency_us": 1164}, {"doc_id": 22, "doc_len": 8646, "worker_id": 1, "attn_time_us": 182.90515192234093, "mlp_time_us": 494.72808837890625, "allgather_time_us": 11.914701461791994, "allreduce_time_us": 630.0, "total_latency_us": 1319}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 5299.660415889217, "mlp_time_us": 3309.1163635253906, "allgather_time_us": 79.69455242156982, "allreduce_time_us": 708.185050039066, "total_latency_us": 9396}, {"doc_id": 24, "doc_len": 39755, "worker_id": 1, "attn_time_us": 2612.4826786068734, "mlp_time_us": 2274.799346923828, "allgather_time_us": 54.784750938415534, "allreduce_time_us": 702.7742398668917, "total_latency_us": 5644}, {"doc_id": 25, "doc_len": 34611, "worker_id": 1, "attn_time_us": 2011.314209655294, "mlp_time_us": 1980.4573059082031, "allgather_time_us": 47.696013450622566, "allreduce_time_us": 700.7842834252929, "total_latency_us": 4740}, {"doc_id": 26, "doc_len": 61200, "worker_id": 1, "attn_time_us": 5897.367992208707, "mlp_time_us": 3501.89208984375, "allgather_time_us": 84.33723449707031, "allreduce_time_us": 709.0061159670872, "total_latency_us": 10192}, {"doc_id": 27, "doc_len": 18523, "worker_id": 1, "attn_time_us": 650.8902958090013, "mlp_time_us": 1059.8945617675781, "allgather_time_us": 25.52579402923584, "allreduce_time_us": 641.8610248286714, "total_latency_us": 2378}, {"doc_id": 28, "doc_len": 35075, "worker_id": 0, "attn_time_us": 2062.505952730024, "mlp_time_us": 2007.0075988769531, "allgather_time_us": 48.33543300628662, "allreduce_time_us": 700.9752885825412, "total_latency_us": 4818}, {"doc_id": 29, "doc_len": 8666, "worker_id": 1, "attn_time_us": 183.59994206467442, "mlp_time_us": 495.87249755859375, "allgather_time_us": 11.942262649536133, "allreduce_time_us": 630.0, "total_latency_us": 1321}, {"doc_id": 30, "doc_len": 6624, "worker_id": 1, "attn_time_us": 125.38255801467757, "mlp_time_us": 379.0283203125, "allgather_time_us": 9.128265380859375, "allreduce_time_us": 641.9998797975837, "total_latency_us": 1155}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 1863.2787503596692, "mlp_time_us": 1901.8363952636719, "allgather_time_us": 45.802559852600105, "allreduce_time_us": 700.2036044230861, "total_latency_us": 4511}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 530.0895148206614, "mlp_time_us": 945.4536437988281, "allgather_time_us": 22.769675254821777, "allreduce_time_us": 630.8095262582397, "total_latency_us": 2129}, {"doc_id": 33, "doc_len": 34119, "worker_id": 1, "attn_time_us": 1957.6945717605022, "mlp_time_us": 1952.3048400878906, "allgather_time_us": 47.0180082321167, "allreduce_time_us": 700.578992567181, "total_latency_us": 4657}, {"doc_id": 34, "doc_len": 66136, "worker_id": 1, "attn_time_us": 6826.008819814697, "mlp_time_us": 3784.332275390625, "allgather_time_us": 91.13933563232422, "allreduce_time_us": 709.7333119028882, "total_latency_us": 11411}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 1932.862244927903, "mlp_time_us": 1939.1441345214844, "allgather_time_us": 46.70105457305908, "allreduce_time_us": 700.4820266205178, "total_latency_us": 4619}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 35.86209557743724, "mlp_time": 116.32919311523438, "allgather_time": 2.8015947341918945, "allreduce_time": 579.5606088479992}, "1": {"doc_len": 32101, "attn_time": 1748.1643283487695, "mlp_time": 1836.8339538574219, "allgather_time": 44.23708438873291, "allreduce_time": 697.8152297288477}, "2": {"doc_len": 60107, "attn_time": 5700.165727592738, "mlp_time": 3439.350128173828, "allgather_time": 82.83101558685303, "allreduce_time": 708.7446960600437}, "3": {"doc_len": 16438, "attn_time": 525.1999166276205, "mlp_time": 940.5899047851562, "allgather_time": 22.65254020690918, "allreduce_time": 630.3151814837149}, "4": {"doc_len": 17552, "attn_time": 590.8694641020561, "mlp_time": 1004.33349609375, "allgather_time": 24.187698364257812, "allreduce_time": 636.6290557689522}, "5": {"doc_len": 17650, "attn_time": 596.8102067870669, "mlp_time": 1009.9411010742188, "allgather_time": 24.3227481842041, "allreduce_time": 637.1680852633538}, "6": {"doc_len": 7168, "attn_time": 139.59764116864247, "mlp_time": 410.15625, "allgather_time": 9.8779296875, "allreduce_time": 637.5155344372663}, "7": {"doc_len": 7125, "attn_time": 138.4594009163187, "mlp_time": 407.6957702636719, "allgather_time": 9.818673133850098, "allreduce_time": 637.8562888315172}, "8": {"doc_len": 19562, "attn_time": 717.9496583077778, "mlp_time": 1119.3466186523438, "allgather_time": 26.957597732543945, "allreduce_time": 647.2078430632266}, "9": {"doc_len": 9323, "attn_time": 206.99071879447467, "mlp_time": 533.4663391113281, "allgather_time": 12.847647666931152, "allreduce_time": 630.0}, "10": {"doc_len": 41353, "attn_time": 2814.2011760238724, "mlp_time": 2366.2376403808594, "allgather_time": 56.98688983917236, "allreduce_time": 703.3412397316583}, "11": {"doc_len": 18999, "attn_time": 681.2504775311392, "mlp_time": 1087.1315002441406, "allgather_time": 26.181750297546387, "allreduce_time": 644.3413319582293}, "12": {"doc_len": 81288, "attn_time": 10039.37370553312, "mlp_time": 4651.336669921875, "allgather_time": 112.01969146728516, "allreduce_time": 703.7235949059694}, "13": {"doc_len": 26799, "attn_time": 1263.9151059557248, "mlp_time": 1533.4510803222656, "allgather_time": 36.93061351776123, "allreduce_time": 678.9275079322385}, "14": {"doc_len": 14333, "attn_time": 419.2247516953619, "mlp_time": 820.1408386230469, "allgather_time": 19.75172519683838, "allreduce_time": 630.0}, "15": {"doc_len": 74771, "attn_time": 8586.862233015363, "mlp_time": 4278.430938720703, "allgather_time": 103.03887844085693, "allreduce_time": 706.152038171347}, "16": {"doc_len": 66335, "attn_time": 6864.469384978604, "mlp_time": 3795.7191467285156, "allgather_time": 91.41356945037842, "allreduce_time": 709.6454163461838}, "17": {"doc_len": 19831, "attn_time": 735.7852941605564, "mlp_time": 1134.7389221191406, "allgather_time": 27.32829570770264, "allreduce_time": 648.552826817597}, "18": {"doc_len": 15296, "attn_time": 466.431822355287, "mlp_time": 875.244140625, "allgather_time": 21.07879638671875, "allreduce_time": 630.0}, "19": {"doc_len": 31167, "attn_time": 1657.8363304026043, "mlp_time": 1783.3900451660156, "allgather_time": 42.94997692108154, "allreduce_time": 694.6902806686116}, "20": {"doc_len": 7769, "attn_time": 155.76043720796568, "mlp_time": 444.5457458496094, "allgather_time": 10.706143379211426, "allreduce_time": 632.9732649986724}, "21": {"doc_len": 6741, "attn_time": 128.40553464146097, "mlp_time": 385.7231140136719, "allgather_time": 9.289498329162598, "allreduce_time": 641.002378172729}, "22": {"doc_len": 8646, "attn_time": 182.90515192234093, "mlp_time": 494.72808837890625, "allgather_time": 11.914701461791994, "allreduce_time": 630.0}, "23": {"doc_len": 57831, "attn_time": 5299.660415889217, "mlp_time": 3309.1163635253906, "allgather_time": 79.69455242156982, "allreduce_time": 708.185050039066}, "24": {"doc_len": 39755, "attn_time": 2612.4826786068734, "mlp_time": 2274.799346923828, "allgather_time": 54.784750938415534, "allreduce_time": 702.7742398668917}, "25": {"doc_len": 34611, "attn_time": 2011.314209655294, "mlp_time": 1980.4573059082031, "allgather_time": 47.696013450622566, "allreduce_time": 700.7842834252929}, "26": {"doc_len": 61200, "attn_time": 5897.367992208707, "mlp_time": 3501.89208984375, "allgather_time": 84.33723449707031, "allreduce_time": 709.0061159670872}, "27": {"doc_len": 18523, "attn_time": 650.8902958090013, "mlp_time": 1059.8945617675781, "allgather_time": 25.52579402923584, "allreduce_time": 641.8610248286714}, "28": {"doc_len": 35075, "attn_time": 2062.505952730024, "mlp_time": 2007.0075988769531, "allgather_time": 48.33543300628662, "allreduce_time": 700.9752885825412}, "29": {"doc_len": 8666, "attn_time": 183.59994206467442, "mlp_time": 495.87249755859375, "allgather_time": 11.942262649536133, "allreduce_time": 630.0}, "30": {"doc_len": 6624, "attn_time": 125.38255801467757, "mlp_time": 379.0283203125, "allgather_time": 9.128265380859375, "allreduce_time": 641.9998797975837}, "31": {"doc_len": 33237, "attn_time": 1863.2787503596692, "mlp_time": 1901.8363952636719, "allgather_time": 45.802559852600105, "allreduce_time": 700.2036044230861}, "32": {"doc_len": 16523, "attn_time": 530.0895148206614, "mlp_time": 945.4536437988281, "allgather_time": 22.769675254821777, "allreduce_time": 630.8095262582397}, "33": {"doc_len": 34119, "attn_time": 1957.6945717605022, "mlp_time": 1952.3048400878906, "allgather_time": 47.0180082321167, "allreduce_time": 700.578992567181}, "34": {"doc_len": 66136, "attn_time": 6826.008819814697, "mlp_time": 3784.332275390625, "allgather_time": 91.13933563232422, "allreduce_time": 709.7333119028882}, "35": {"doc_len": 33889, "attn_time": 1932.862244927903, "mlp_time": 1939.1441345214844, "allgather_time": 46.70105457305908, "allreduce_time": 700.4820266205178}}}, "attnserver_result": {"batch_total_time": 67922.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 4260.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 8, "mlp_cp": 4}}
{"idx": 1, "input_batch": [2033, 32101, 60107, 16438, 17552, 17650, 7168, 7125, 19562, 9323, 41353, 18999, 81288, 26799, 14333, 74771, 66335, 19831, 15296, 31167, 7769, 6741, 8646, 57831, 39755, 34611, 61200, 18523, 35075, 8666, 6624, 33237, 16523, 34119, 66136, 33889], "run_name": "gaussian_means_8K_16K_32K_64K_ctx_1024K_gpu64_attnwkrs8", "tp": 8, "cp": 8, "dp": 1, "ratio": 0.7494158391053993, "num_total_devices": 64, "max_num_workers_attnserver": 8, "wlb_result": {"max_worker_latency_us": 95864, "worker_latencies_us": [95864], "doc2worker": {"0": 0, "1": 0, "2": 0, "3": 0, "4": 0, "5": 0, "6": 0, "7": 0, "8": 0, "9": 0, "10": 0, "11": 0, "12": 0, "13": 0, "14": 0, "15": 0, "16": 0, "17": 0, "18": 0, "19": 0, "20": 0, "21": 0, "22": 0, "23": 0, "24": 0, "25": 0, "26": 0, "27": 0, "28": 0, "29": 0, "30": 0, "31": 0, "32": 0, "33": 0, "34": 0, "35": 0}, "latency_breakdown": {"max_worker_latency_us": 95864, "worker_latencies_us": [95864], "solver_status": "OPTIMAL", "solved_time_s": 0.006776571273803711, "num_vars": 38, "num_cons": 39}, "worker_assignments": [{"worker_id": 0, "assigned_docs": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "total_batch_length": 1048576, "total_latency_us": 95864, "mlp_cost_us": 30000.0, "attn_cost_us": 40292.84660838704, "allreduce_cost_us": 23973.5557474672, "allgather_cost_us": 1616.875}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 0, "attn_time_us": 33.03138809207868, "mlp_time_us": 58.16459655761719, "allgather_time_us": 3.1348294019699097, "allreduce_time_us": 579.5606088479992, "total_latency_us": 673}, {"doc_id": 1, "doc_len": 32101, "worker_id": 0, "attn_time_us": 972.609823544511, "mlp_time_us": 918.4169769287109, "allgather_time_us": 49.49884831905365, "allreduce_time_us": 697.8152297288477, "total_latency_us": 2638}, {"doc_id": 2, "doc_len": 60107, "worker_id": 0, "attn_time_us": 2903.1009971171366, "mlp_time_us": 1719.675064086914, "allgather_time_us": 92.68332064151764, "allreduce_time_us": 708.7446960600437, "total_latency_us": 5424}, {"doc_id": 3, "doc_len": 16438, "worker_id": 0, "attn_time_us": 318.2471307844112, "mlp_time_us": 470.2949523925781, "allgather_time_us": 25.346938371658325, "allreduce_time_us": 630.3151814837149, "total_latency_us": 1444}, {"doc_id": 4, "doc_len": 17552, "worker_id": 0, "attn_time_us": 355.05712764151156, "mlp_time_us": 502.166748046875, "allgather_time_us": 27.064695358276367, "allreduce_time_us": 636.6290557689522, "total_latency_us": 1520}, {"doc_id": 5, "doc_len": 17650, "worker_id": 0, "attn_time_us": 358.37229774827387, "mlp_time_us": 504.9705505371094, "allgather_time_us": 27.215808629989624, "allreduce_time_us": 637.1680852633538, "total_latency_us": 1527}, {"doc_id": 6, "doc_len": 7168, "worker_id": 0, "attn_time_us": 99.14055775262023, "mlp_time_us": 205.078125, "allgather_time_us": 11.0528564453125, "allreduce_time_us": 637.5155344372663, "total_latency_us": 952}, {"doc_id": 7, "doc_len": 7125, "worker_id": 0, "attn_time_us": 98.49005132687797, "mlp_time_us": 203.84788513183594, "allgather_time_us": 10.986551642417908, "allreduce_time_us": 637.8562888315172, "total_latency_us": 951}, {"doc_id": 8, "doc_len": 19562, "worker_id": 0, "attn_time_us": 425.49395690209946, "mlp_time_us": 559.6733093261719, "allgather_time_us": 30.16405940055847, "allreduce_time_us": 647.2078430632266, "total_latency_us": 1662}, {"doc_id": 9, "doc_len": 9323, "worker_id": 0, "attn_time_us": 138.65037308151014, "mlp_time_us": 266.73316955566406, "allgather_time_us": 14.375806450843811, "allreduce_time_us": 630.0, "total_latency_us": 1049}, {"doc_id": 10, "doc_len": 41353, "worker_id": 0, "attn_time_us": 1511.080611478617, "mlp_time_us": 1183.1188201904297, "allgather_time_us": 63.765174746513374, "allreduce_time_us": 703.3412397316583, "total_latency_us": 3461}, {"doc_id": 11, "doc_len": 18999, "worker_id": 0, "attn_time_us": 405.2511446109365, "mlp_time_us": 543.5657501220703, "allgather_time_us": 29.295929074287415, "allreduce_time_us": 644.3413319582293, "total_latency_us": 1622}, {"doc_id": 12, "doc_len": 81288, "worker_id": 0, "attn_time_us": 5049.184802848978, "mlp_time_us": 2325.6683349609375, "allgather_time_us": 125.34383296966553, "allreduce_time_us": 703.7235949059694, "total_latency_us": 8203}, {"doc_id": 13, "doc_len": 26799, "worker_id": 0, "attn_time_us": 719.5757572623809, "mlp_time_us": 766.7255401611328, "allgather_time_us": 41.32331192493439, "allreduce_time_us": 678.9275079322385, "total_latency_us": 2206}, {"doc_id": 14, "doc_len": 14333, "worker_id": 0, "attn_time_us": 260.2264342230897, "mlp_time_us": 410.07041931152344, "allgather_time_us": 22.101086974143982, "allreduce_time_us": 630.0, "total_latency_us": 1322}, {"doc_id": 15, "doc_len": 74771, "worker_id": 0, "attn_time_us": 4319.246269067294, "mlp_time_us": 2139.2154693603516, "allgather_time_us": 115.29480040073395, "allreduce_time_us": 706.152038171347, "total_latency_us": 7279}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 3453.541767725707, "mlp_time_us": 1897.8595733642578, "allgather_time_us": 102.28672325611115, "allreduce_time_us": 709.6454163461838, "total_latency_us": 6163}, {"doc_id": 17, "doc_len": 19831, "worker_id": 0, "attn_time_us": 435.3051321368498, "mlp_time_us": 567.3694610595703, "allgather_time_us": 30.578849911689762, "allreduce_time_us": 648.552826817597, "total_latency_us": 1681}, {"doc_id": 18, "doc_len": 15296, "worker_id": 0, "attn_time_us": 286.21555918271116, "mlp_time_us": 437.6220703125, "allgather_time_us": 23.58600616455078, "allreduce_time_us": 630.0, "total_latency_us": 1377}, {"doc_id": 19, "doc_len": 31167, "worker_id": 0, "attn_time_us": 925.8360184142006, "mlp_time_us": 891.6950225830078, "allgather_time_us": 48.05864632129669, "allreduce_time_us": 694.6902806686116, "total_latency_us": 2560}, {"doc_id": 20, "doc_len": 7769, "worker_id": 0, "attn_time_us": 108.27009004847658, "mlp_time_us": 222.2728729248047, "allgather_time_us": 11.979581713676453, "allreduce_time_us": 632.9732649986724, "total_latency_us": 975}, {"doc_id": 21, "doc_len": 6741, "worker_id": 0, "attn_time_us": 92.69749418959927, "mlp_time_us": 192.86155700683594, "allgather_time_us": 10.394434332847595, "allreduce_time_us": 641.002378172729, "total_latency_us": 936}, {"doc_id": 22, "doc_len": 8646, "worker_id": 0, "attn_time_us": 124.16297469373538, "mlp_time_us": 247.36404418945312, "allgather_time_us": 13.33189129829407, "allreduce_time_us": 630.0, "total_latency_us": 1014}, {"doc_id": 23, "doc_len": 57831, "worker_id": 0, "attn_time_us": 2713.8906824867345, "mlp_time_us": 1654.5581817626953, "allgather_time_us": 89.17379200458527, "allreduce_time_us": 708.185050039066, "total_latency_us": 5165}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 1410.6041578650593, "mlp_time_us": 1137.399673461914, "allgather_time_us": 61.301103234291084, "allreduce_time_us": 702.7742398668917, "total_latency_us": 3312}, {"doc_id": 25, "doc_len": 34611, "worker_id": 0, "attn_time_us": 1107.4848211475505, "mlp_time_us": 990.2286529541016, "allgather_time_us": 53.36919844150544, "allreduce_time_us": 700.7842834252929, "total_latency_us": 2851}, {"doc_id": 26, "doc_len": 61200, "worker_id": 0, "attn_time_us": 2995.895297469628, "mlp_time_us": 1750.946044921875, "allgather_time_us": 94.36869621276855, "allreduce_time_us": 709.0061159670872, "total_latency_us": 5550}, {"doc_id": 27, "doc_len": 18523, "worker_id": 0, "attn_time_us": 388.44637913509473, "mlp_time_us": 529.9472808837891, "allgather_time_us": 28.56195032596588, "allreduce_time_us": 641.8610248286714, "total_latency_us": 1588}, {"doc_id": 28, "doc_len": 35075, "worker_id": 0, "attn_time_us": 1133.5366530513606, "mlp_time_us": 1003.5037994384766, "allgather_time_us": 54.08467352390289, "allreduce_time_us": 700.9752885825412, "total_latency_us": 2892}, {"doc_id": 29, "doc_len": 8666, "worker_id": 0, "attn_time_us": 124.5836556185858, "mlp_time_us": 247.93624877929688, "allgather_time_us": 13.362730741500854, "allreduce_time_us": 630.0, "total_latency_us": 1015}, {"doc_id": 30, "doc_len": 6624, "worker_id": 0, "attn_time_us": 90.93865767099423, "mlp_time_us": 189.51416015625, "allgather_time_us": 10.21402359008789, "allreduce_time_us": 641.9998797975837, "total_latency_us": 932}, {"doc_id": 31, "doc_len": 33237, "worker_id": 0, "attn_time_us": 1031.86378952087, "mlp_time_us": 950.9181976318359, "allgather_time_us": 51.250528693199165, "allreduce_time_us": 700.2036044230861, "total_latency_us": 2734}, {"doc_id": 32, "doc_len": 16523, "worker_id": 0, "attn_time_us": 320.9987149909135, "mlp_time_us": 472.72682189941406, "allgather_time_us": 25.47800600528717, "allreduce_time_us": 630.8095262582397, "total_latency_us": 1450}, {"doc_id": 33, "doc_len": 34119, "worker_id": 0, "attn_time_us": 1080.1440871724317, "mlp_time_us": 976.1524200439453, "allgather_time_us": 52.61054813861847, "allreduce_time_us": 700.578992567181, "total_latency_us": 2809}, {"doc_id": 34, "doc_len": 66136, "worker_id": 0, "attn_time_us": 3434.2088285344403, "mlp_time_us": 1892.1661376953125, "allgather_time_us": 101.97987079620361, "allreduce_time_us": 709.7333119028882, "total_latency_us": 6138}, {"doc_id": 35, "doc_len": 33889, "worker_id": 0, "attn_time_us": 1067.4631238497657, "mlp_time_us": 969.5720672607422, "allgather_time_us": 52.25589454174042, "allreduce_time_us": 700.4820266205178, "total_latency_us": 2789}], "document_costs": {"0": {"doc_len": 2033, "attn_time": 33.03138809207868, "mlp_time": 58.16459655761719, "allgather_time": 3.1348294019699097, "allreduce_time": 579.5606088479992}, "1": {"doc_len": 32101, "attn_time": 972.609823544511, "mlp_time": 918.4169769287109, "allgather_time": 49.49884831905365, "allreduce_time": 697.8152297288477}, "2": {"doc_len": 60107, "attn_time": 2903.1009971171366, "mlp_time": 1719.675064086914, "allgather_time": 92.68332064151764, "allreduce_time": 708.7446960600437}, "3": {"doc_len": 16438, "attn_time": 318.2471307844112, "mlp_time": 470.2949523925781, "allgather_time": 25.346938371658325, "allreduce_time": 630.3151814837149}, "4": {"doc_len": 17552, "attn_time": 355.05712764151156, "mlp_time": 502.166748046875, "allgather_time": 27.064695358276367, "allreduce_time": 636.6290557689522}, "5": {"doc_len": 17650, "attn_time": 358.37229774827387, "mlp_time": 504.9705505371094, "allgather_time": 27.215808629989624, "allreduce_time": 637.1680852633538}, "6": {"doc_len": 7168, "attn_time": 99.14055775262023, "mlp_time": 205.078125, "allgather_time": 11.0528564453125, "allreduce_time": 637.5155344372663}, "7": {"doc_len": 7125, "attn_time": 98.49005132687797, "mlp_time": 203.84788513183594, "allgather_time": 10.986551642417908, "allreduce_time": 637.8562888315172}, "8": {"doc_len": 19562, "attn_time": 425.49395690209946, "mlp_time": 559.6733093261719, "allgather_time": 30.16405940055847, "allreduce_time": 647.2078430632266}, "9": {"doc_len": 9323, "attn_time": 138.65037308151014, "mlp_time": 266.73316955566406, "allgather_time": 14.375806450843811, "allreduce_time": 630.0}, "10": {"doc_len": 41353, "attn_time": 1511.080611478617, "mlp_time": 1183.1188201904297, "allgather_time": 63.765174746513374, "allreduce_time": 703.3412397316583}, "11": {"doc_len": 18999, "attn_time": 405.2511446109365, "mlp_time": 543.5657501220703, "allgather_time": 29.295929074287415, "allreduce_time": 644.3413319582293}, "12": {"doc_len": 81288, "attn_time": 5049.184802848978, "mlp_time": 2325.6683349609375, "allgather_time": 125.34383296966553, "allreduce_time": 703.7235949059694}, "13": {"doc_len": 26799, "attn_time": 719.5757572623809, "mlp_time": 766.7255401611328, "allgather_time": 41.32331192493439, "allreduce_time": 678.9275079322385}, "14": {"doc_len": 14333, "attn_time": 260.2264342230897, "mlp_time": 410.07041931152344, "allgather_time": 22.101086974143982, "allreduce_time": 630.0}, "15": {"doc_len": 74771, "attn_time": 4319.246269067294, "mlp_time": 2139.2154693603516, "allgather_time": 115.29480040073395, "allreduce_time": 706.152038171347}, "16": {"doc_len": 66335, "attn_time": 3453.541767725707, "mlp_time": 1897.8595733642578, "allgather_time": 102.28672325611115, "allreduce_time": 709.6454163461838}, "17": {"doc_len": 19831, "attn_time": 435.3051321368498, "mlp_time": 567.3694610595703, "allgather_time": 30.578849911689762, "allreduce_time": 648.552826817597}, "18": {"doc_len": 15296, "attn_time": 286.21555918271116, "mlp_time": 437.6220703125, "allgather_time": 23.58600616455078, "allreduce_time": 630.0}, "19": {"doc_len": 31167, "attn_time": 925.8360184142006, "mlp_time": 891.6950225830078, "allgather_time": 48.05864632129669, "allreduce_time": 694.6902806686116}, "20": {"doc_len": 7769, "attn_time": 108.27009004847658, "mlp_time": 222.2728729248047, "allgather_time": 11.979581713676453, "allreduce_time": 632.9732649986724}, "21": {"doc_len": 6741, "attn_time": 92.69749418959927, "mlp_time": 192.86155700683594, "allgather_time": 10.394434332847595, "allreduce_time": 641.002378172729}, "22": {"doc_len": 8646, "attn_time": 124.16297469373538, "mlp_time": 247.36404418945312, "allgather_time": 13.33189129829407, "allreduce_time": 630.0}, "23": {"doc_len": 57831, "attn_time": 2713.8906824867345, "mlp_time": 1654.5581817626953, "allgather_time": 89.17379200458527, "allreduce_time": 708.185050039066}, "24": {"doc_len": 39755, "attn_time": 1410.6041578650593, "mlp_time": 1137.399673461914, "allgather_time": 61.301103234291084, "allreduce_time": 702.7742398668917}, "25": {"doc_len": 34611, "attn_time": 1107.4848211475505, "mlp_time": 990.2286529541016, "allgather_time": 53.36919844150544, "allreduce_time": 700.7842834252929}, "26": {"doc_len": 61200, "attn_time": 2995.895297469628, "mlp_time": 1750.946044921875, "allgather_time": 94.36869621276855, "allreduce_time": 709.0061159670872}, "27": {"doc_len": 18523, "attn_time": 388.44637913509473, "mlp_time": 529.9472808837891, "allgather_time": 28.56195032596588, "allreduce_time": 641.8610248286714}, "28": {"doc_len": 35075, "attn_time": 1133.5366530513606, "mlp_time": 1003.5037994384766, "allgather_time": 54.08467352390289, "allreduce_time": 700.9752885825412}, "29": {"doc_len": 8666, "attn_time": 124.5836556185858, "mlp_time": 247.93624877929688, "allgather_time": 13.362730741500854, "allreduce_time": 630.0}, "30": {"doc_len": 6624, "attn_time": 90.93865767099423, "mlp_time": 189.51416015625, "allgather_time": 10.21402359008789, "allreduce_time": 641.9998797975837}, "31": {"doc_len": 33237, "attn_time": 1031.86378952087, "mlp_time": 950.9181976318359, "allgather_time": 51.250528693199165, "allreduce_time": 700.2036044230861}, "32": {"doc_len": 16523, "attn_time": 320.9987149909135, "mlp_time": 472.72682189941406, "allgather_time": 25.47800600528717, "allreduce_time": 630.8095262582397}, "33": {"doc_len": 34119, "attn_time": 1080.1440871724317, "mlp_time": 976.1524200439453, "allgather_time": 52.61054813861847, "allreduce_time": 700.578992567181}, "34": {"doc_len": 66136, "attn_time": 3434.2088285344403, "mlp_time": 1892.1661376953125, "allgather_time": 101.97987079620361, "allreduce_time": 709.7333119028882}, "35": {"doc_len": 33889, "attn_time": 1067.4631238497657, "mlp_time": 969.5720672607422, "allgather_time": 52.25589454174042, "allreduce_time": 700.4820266205178}}}, "attnserver_result": {"batch_total_time": 71842.0, "batch_attn_time": 33662, "batch_mlp_time": 30000.0, "batch_allreduce_time": 8180.0, "solver_status": "FEASIBLE", "solved_time_s": 360.1612477302551, "num_vars": 889, "num_cons": 925, "worker_plans": [{"worker_id": 0, "tp": 4, "cp": 2, "latency_us": 33663}, {"worker_id": 1, "tp": 4, "cp": 2, "latency_us": 33692}, {"worker_id": 2, "tp": 8, "cp": 2, "latency_us": 33706}, {"worker_id": 3, "tp": 4, "cp": 2, "latency_us": 33666}, {"worker_id": 4, "tp": 4, "cp": 2, "latency_us": 33662}, {"worker_id": 5, "tp": 4, "cp": 2, "latency_us": 33693}, {"worker_id": 6, "tp": 4, "cp": 1, "latency_us": 33665}, {"worker_id": 7, "tp": 4, "cp": 1, "latency_us": 33669}], "doc_assignments": [{"doc_id": 0, "doc_len": 2033, "worker_id": 7, "attn_time_us": 74.89683671797832}, {"doc_id": 1, "doc_len": 32101, "worker_id": 6, "attn_time_us": 11641.77106617797}, {"doc_id": 2, "doc_len": 60107, "worker_id": 5, "attn_time_us": 20291.289848898985}, {"doc_id": 3, "doc_len": 16438, "worker_id": 7, "attn_time_us": 3118.738747447154}, {"doc_id": 4, "doc_len": 17552, "worker_id": 7, "attn_time_us": 3548.3234934425295}, {"doc_id": 5, "doc_len": 17650, "worker_id": 7, "attn_time_us": 3587.4185193169214}, {"doc_id": 6, "doc_len": 7168, "worker_id": 6, "attn_time_us": 640.9407394587936}, {"doc_id": 7, "doc_len": 7125, "worker_id": 3, "attn_time_us": 413.4748019047083}, {"doc_id": 8, "doc_len": 19562, "worker_id": 6, "attn_time_us": 4392.280807743863}, {"doc_id": 9, "doc_len": 9323, "worker_id": 6, "attn_time_us": 1046.5865107690865}, {"doc_id": 10, "doc_len": 41353, "worker_id": 7, "attn_time_us": 19301.83863738121}, {"doc_id": 11, "doc_len": 18999, "worker_id": 3, "attn_time_us": 2289.0924612727576}, {"doc_id": 12, "doc_len": 81288, "worker_id": 2, "attn_time_us": 18946.089705375914}, {"doc_id": 13, "doc_len": 26799, "worker_id": 6, "attn_time_us": 8160.697575107546}, {"doc_id": 14, "doc_len": 14333, "worker_id": 7, "attn_time_us": 2395.2485067132698}, {"doc_id": 15, "doc_len": 74771, "worker_id": 3, "attn_time_us": 30964.76667866259}, {"doc_id": 16, "doc_len": 66335, "worker_id": 0, "attn_time_us": 24568.208511425775}, {"doc_id": 17, "doc_len": 19831, "worker_id": 4, "attn_time_us": 2477.2379903256806}, {"doc_id": 18, "doc_len": 15296, "worker_id": 6, "attn_time_us": 2714.671454696122}, {"doc_id": 19, "doc_len": 31167, "worker_id": 5, "attn_time_us": 5699.427983123611}, {"doc_id": 20, "doc_len": 7769, "worker_id": 7, "attn_time_us": 741.3577249995108}, {"doc_id": 21, "doc_len": 6741, "worker_id": 6, "attn_time_us": 573.5879048034607}, {"doc_id": 22, "doc_len": 8646, "worker_id": 7, "attn_time_us": 905.20311871462}, {"doc_id": 23, "doc_len": 57831, "worker_id": 1, "attn_time_us": 18826.57526833159}, {"doc_id": 24, "doc_len": 39755, "worker_id": 0, "attn_time_us": 9095.973319396755}, {"doc_id": 25, "doc_len": 34611, "worker_id": 2, "attn_time_us": 3743.129903153264}, {"doc_id": 26, "doc_len": 61200, "worker_id": 2, "attn_time_us": 11017.204699170845}, {"doc_id": 27, "doc_len": 18523, "worker_id": 6, "attn_time_us": 3944.97735826725}, {"doc_id": 28, "doc_len": 35075, "worker_id": 5, "attn_time_us": 7133.035858432675}, {"doc_id": 29, "doc_len": 8666, "worker_id": 5, "attn_time_us": 570.0274744180244}, {"doc_id": 30, "doc_len": 6624, "worker_id": 6, "attn_time_us": 555.7177344277227}, {"doc_id": 31, "doc_len": 33237, "worker_id": 1, "attn_time_us": 6425.451280164909}, {"doc_id": 32, "doc_len": 16523, "worker_id": 1, "attn_time_us": 1769.7160175262527}, {"doc_id": 33, "doc_len": 34119, "worker_id": 4, "attn_time_us": 6760.528215829564}, {"doc_id": 34, "doc_len": 66136, "worker_id": 4, "attn_time_us": 24425.944997787417}, {"doc_id": 35, "doc_len": 33889, "worker_id": 1, "attn_time_us": 6672.354125562756}], "mlp_tp": 8, "mlp_cp": 8}}
