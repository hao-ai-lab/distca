











# --------------------------------------
#    Reproduce Stuck Experiment
# --------------------------------------
#    n  bs  mb    t       mode  cp  pp tp     comment        env_var
    # 32   1   16   524288     d2    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=2,EXPERIMENT__STUCK=1'  # ðŸ”´ This will stuck at L18. See `24_101245.d2-n32-t524288-b1-mb16-cp32tp8pp1-codellama_CodeLlama-34b-hf`

    # 64   8    8   131072     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    # 64   16   1   131072     d2    64   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   16   1   524288     d2    64   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'



# --------------------------------------
#      Formal Experiment (2025/09/24)
# --------------------------------------

# Small testing to ensure gradient checkpointing is working
#   n  bs  mb    t       mode  cp  pp tp     comment        env_var
    1   1  1   8192     d2    1  1   8  'd2-pretrain'     'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    1   1  1   8192     d2    1  1   8  'd2-pretrain'     'EXPERIMENT_ADD_SELECTIVE_CKPT=0,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

# Memory Sweeping
# ---------------- 16 nodes ----------------
#   n  bs  mb    t       mode  cp  pp tp     comment        env_var
    16   1  1   131072     d2    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 
    16   1  1   131072     wlbllm    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 

    16   2  1   131072     d2    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 
    16   2  1   131072     wlbllm    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 

    16   4  1   131072     d2    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 
    16   4  1   131072     wlbllm    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 

    16   8  1   131072     d2    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 
    16   8  1   131072     wlbllm    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM,COMMENT="WLBLLM-cp16pp1bs8 will OOM becuase of the global kv tensor overhead."' 

    16  16  1   131072     d2    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    16  16  1   131072     wlbllm    16  1   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    16   1  16   131072     d2     8  2   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 
    16   1  16   131072     wlbllm     8  2   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 

    16   1  16   131072     d2     4  4   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 
    16   1  16   131072     wlbllm     4  4   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 

    
    16   1  16   131072     d2     2  8   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM,COMMENT="Why does d2 OOM? Becuase we set buffer-size = 4GB?"' 
    16   1  16   131072     wlbllm     2  8   8  'd2-pretrain' 'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=1,EXPERIMENT__STATUS=PASS' 


#   n   bs   mb     t       mode   cp   pp  tp     comment        env_var
    16   4    8   131072     d2    16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    16   4    8   131072     wlbllm    16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    16   2    8   131072     d2     8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    16   2    8   131072     wlbllm     8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    16   2    8   131072     d2     4   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    16   2    8   131072     wlbllm     4   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    16   1   16   262144     d2    16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    16   1   16   262144     wlbllm    16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    16   1   16   262144     d2     8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    16   1   16   262144     wlbllm     8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    


# ---------------- 32 nodes ----------------
#   n   bs   mb     t       mode   cp   pp  tp     comment        env_var
    32   8    8   131072     d2    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    32   8    8   131072     wlbllm    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    32   4    8   131072     d2    16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    32   4    8   131072     wlbllm    16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    32   2    8   131072     d2     8   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    32   2    8   131072     wlbllm     8   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    32   2   16   262144     d2    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    32   2   16   262144     wlbllm    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    32   1   16   262144     d2    16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    32   1   16   262144     wlbllm    16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    32   1   16   524288     d2    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=6,EXPERIMENT__STATUS=FAIL,EXPERIMENT__STUCK=1'
    32   1   16   524288     wlbllm    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    32   1   16   524288     d2    8   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    32   1   16   524288     wlbllm    8   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    32   1   16   524288     wlbllm    4   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    32  16   1   524288     d2    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=2,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=4'  # 


# ---------------- 64 nodes ----------------
#   n   bs   mb     t       mode   cp   pp  tp     comment        env_var
    64   8    8   131072     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    64   8    8   131072     wlbllm    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    64   4   16   131072     d2    16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    64   4   16   131072     wlbllm    16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    64   32   1   262144     d2    64   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL'
    64   32   1   262144     wlbllm    64   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    64   32   1   262144     wlbllm    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    64   32   1   262144     wlbllm    16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    64   1   16   262144     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    64   1   16   262144     wlbllm    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    64   2   8    262144     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    64   2   8    262144     wlbllm    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    64   2   16   262144     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    64   2   16   262144     wlbllm    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'

    64   1  16   524288     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL'
    # 64   1  16   524288     wlbllm    32  2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   2  8   524288     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   2  8   524288     wlbllm    32  2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   1  16   524288     d2    16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   1  16   524288     wlbllm    16  4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   1  8   524288     d2    16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   1  8   524288     wlbllm    16  4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   2  4   524288     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   2  4   524288     wlbllm    32  2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   1   16   524288     d2    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   1   16   524288     wlbllm    32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   1   16   524288     d2    16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'


# --------------------- 512k ---------------------
    #   n   bs   mb     t       mode    cp   pp  tp     comment        env_var
    16   1    8   524288     d2         16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    16   1    8   524288     wlbllm      4   2   8   'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    16   1    8   524288     wlbllm      8   1   8   'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=PASS'
    16   1    8   524288     wlbllm      8   2   8   'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    
    
    # 16   4    1   524288     d2         16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 16   1    4   524288     d2         8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 16   4    1   524288     wlbllm     16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 16   1    4   524288     wlbllm     8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 16   1    4   524288     wlbllm     4   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'


    16   1    8   524288     wlbllm     16   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    16   1    8   524288     d2          8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    16   1    8   524288     wlbllm      8   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'


    # 64   1    16   524288     d2         16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=MAYBE_STUCK'
    # 64   1    16   524288     wlbllm     16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   1    8   524288     d2         16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    64   8    1   524288     d2         64   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=4,MIN_TOLERANCE_FACTOR=0.2,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    # 64   2    4   524288     d2         32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=4,MIN_TOLERANCE_FACTOR=0.2,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    # 64   1    8   524288     d2         16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=4,MIN_TOLERANCE_FACTOR=0.2,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=MAYBE_STUCK,COMMENT="Maybe stuck at PP."'

    64   2    2   524288     d2         32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=4,MIN_TOLERANCE_FACTOR=0.2,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=MAYBE_STUCK,COMMENT="Maybe stuck at PP."'
    # 64   1    8   524288     d2         32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=4,MIN_TOLERANCE_FACTOR=0.2'
    # 64   1    8   524288     wlbllm     16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'

    # 64   2    8   524288     d2         32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   2    8   524288     wlbllm     32   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'


    # 32   1    8   524288     d2         16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 32   1    8   524288     wlbllm     16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'


    # 64   4    8   524288     d2         16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'
    # 64   4    8   524288     wlbllm     16   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0'



# --------------------- 512k 32 node ---------------------
#    n  bs  mb    t       mode  cp  pp tp     comment        env_var
    # 32   1   16   524288     d2    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=6,EXPERIMENT__STATUS=FAIL,EXPERIMENT__STUCK=1'
    # 32   1   16   524288     wlbllm    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    # 32   1   16   524288     d2    8   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    # 32   1   16   524288     wlbllm    8   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'
    # 32   1   16   524288     wlbllm    4   4   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM'

    # 32  16   1   524288     d2    32   1   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=2,EXPERIMENT__STATUS=FAIL,EXPERIMENT__FAIL_REASON=OOM,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=4'  # 


#    n  bs  mb    t       mode  cp  pp tp     comment        env_var
    32   1   4   524288     wlbllm      16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1'
    32   1   4   524288     d2          16   2   8  'd2-pretrain'  'EXPERIMENT_ADD_SELECTIVE_CKPT=1,ENABLE_NSYS=0,EXPERIMENT_NVSHMEM_BUFFER_SIZE_GB=3,MIN_TOLERANCE_FACTOR=0.2'
